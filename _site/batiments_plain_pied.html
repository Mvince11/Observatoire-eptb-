<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Carte Intercative ‚Äì Observatoire de la vuln√©rabilit√© aux inondations Vienne - Clain</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e55257969e79e1b23715b75ca28f8bbd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de r√©sultats",
    "search-matching-documents-text": "documents trouv√©s",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>


<!-- <script src="assets/inject-logos.js"></script> -->

<script src="assets/sidebar-toggle.js"></script>

<!-- <script src="assets/toggle.js"></script> --> 



<script>

document.addEventListener('DOMContentLoaded', function () {

  // Try common Quarto IDs; fall back to your custom one if used

  const collapse =

    document.getElementById('quarto-navbar-collapse') ||

    document.getElementById('navbarCollapse');



  const toggler = document.querySelector('.navbar-toggler');



  if (!collapse || !toggler) return; // nothing to do



  // Create offcanvas container

  const offcanvas = document.createElement('div');

  offcanvas.className = 'offcanvas offcanvas-start site-offcanvas';

  offcanvas.id = 'site-offcanvas';

  offcanvas.setAttribute('tabindex', '-1');



  // Header with image/logo and close button

  const header = document.createElement('div');

  header.className = 'offcanvas-header';



  const img = document.createElement('img');

  img.src = 'Images/logo_porteurs_projet_anc.png';

  img.alt = 'Logo';

  img.style.maxHeight = '64px';



  const closeBtn = document.createElement('button');

  closeBtn.type = 'button';

  closeBtn.className = 'btn-close';

  closeBtn.setAttribute('data-bs-dismiss', 'offcanvas');



  header.appendChild(img);

  header.appendChild(closeBtn);



  // Body: move existing navbar items here

  const body = document.createElement('div');

  body.className = 'offcanvas-body';



  // Preserve current collapse content

  while (collapse.firstChild) {

    body.appendChild(collapse.firstChild);

  }



  offcanvas.appendChild(header);

  offcanvas.appendChild(body);



  // Insert offcanvas next to navbar

  const navbar = document.querySelector('nav.navbar');

  (navbar?.parentNode || document.body).appendChild(offcanvas);



  // Hide original collapse (we moved its children)

  collapse.classList.add('d-none');



  // Retarget the burger to offcanvas

  toggler.setAttribute('data-bs-toggle', 'offcanvas');

  toggler.setAttribute('data-bs-target', '#site-offcanvas');

  

  // üëâ Ajoute le texte "Menu" √† c√¥t√© du burger

  const menuText = document.createElement('span');

  menuText.className = 'menu-text';

  menuText.textContent = 'Menu';

  toggler.appendChild(menuText);

  

});

</script>
<script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="site_libs/core-js-2.5.3/shim.min.js"></script>

<script src="site_libs/react-18.2.0/react.min.js"></script>

<script src="site_libs/react-18.2.0/react-dom.min.js"></script>

<script src="site_libs/reactwidget-2.0.0/react-tools.js"></script>

<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="site_libs/reactable-0.4.4/reactable.css" rel="stylesheet">

<script src="site_libs/reactable-binding-0.4.4/reactable.js"></script>

<script src="js/maplibre.js"></script>
<link href="js/maplibre.css" rel="stylesheet">
<script src="js/jquery_3.5.min.js" type="text/javascript"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

<link rel="stylesheet" href="js/photon-geocoder-autocomplete.min.css" type="text/css">
<script src="js/photon-geocoder-autocomplete.min.js" type="text/javascript"></script>
<script src="js/offcanvas.js" type="text/javascript"></script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-xxl " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./Images/logo_porteurs_projet_transparent.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Observatoire de la vuln√©rabilit√© aux inondations Vienne - Clain</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Basculer la navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Accueil</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mieux_comprendre.qmd"> 
<span class="menu-text">Mieux comprendre les inondations</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-objectif-n¬∞1-augmenter-la-s√©curit√©-des-populations" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Objectif n¬∞1: Augmenter la s√©curit√© des populations</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-objectif-n¬∞1-augmenter-la-s√©curit√©-des-populations">    
        <li>
    <a class="dropdown-item" href="./batiments_plain_pied.html">
 <span class="dropdown-text">B√¢timents plain-pied</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./etablissements_sensibles.qmd">
 <span class="dropdown-text">Etablissements sensibles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./enjeux_susceptibles_dysfonctionner.qmd">
 <span class="dropdown-text">Etablissements utiles √† la gestion de crise</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./campings.qmd">
 <span class="dropdown-text">Campings</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./routes.qmd">
 <span class="dropdown-text">Routes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./pcs.qmd">
 <span class="dropdown-text">Plan communal de sauvegarde (PCS)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dicrim.qmd">
 <span class="dropdown-text">Document d‚Äôinformation communal sur les risques majeurs (DICRIM)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-objectif-n¬∞2-stabiliserr√©duire-le-co√ªt-des-dommages" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Objectif n¬∞2: Stabiliser/r√©duire le co√ªt des dommages</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-objectif-n¬∞2-stabiliserr√©duire-le-co√ªt-des-dommages">    
        <li>
    <a class="dropdown-item" href="./dommages_habitations.qmd">
 <span class="dropdown-text">Dommages aux habitations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dommages_entreprises.qmd">
 <span class="dropdown-text">Dommages aux entreprises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dommages_cultures.qmd">
 <span class="dropdown-text">Dommages aux cultures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./monuments.qmd">
 <span class="dropdown-text">Patrimoines et monuments historiques</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./espaces_naturels.qmd">
 <span class="dropdown-text">Espaces naturels</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./installations_polluantes.qmd">
 <span class="dropdown-text">Installations polluantes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./eau_potable.qmd">
 <span class="dropdown-text">Station d‚Äôalimentation en eau potable</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./reseaux.qmd">
 <span class="dropdown-text">R√©seaux</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./voies_ferrees.qmd">
 <span class="dropdown-text">Voies ferr√©es</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./reseaux_bus.qmd">
 <span class="dropdown-text">R√©seau de bus</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-objectif-n¬∞3-raccourcir-le-d√©lai-de-retour-√†-la-normale" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Objectif n¬∞3: Raccourcir le d√©lai de retour √† la normale</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-objectif-n¬∞3-raccourcir-le-d√©lai-de-retour-√†-la-normale">    
        <li>
    <a class="dropdown-item" href="./habitants_zones_inondables.qmd">
 <span class="dropdown-text">Nombre et proportion d‚Äôhabitants en zone inondable</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./surfaces_habitations.qmd">
 <span class="dropdown-text">Surface des habitations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./retour_normale_logements.qmd">
 <span class="dropdown-text">Logements</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./employes.qmd">
 <span class="dropdown-text">Employ√©s</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./surface_agricole.qmd">
 <span class="dropdown-text">Surface agricole</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./reseau_routier.qmd">
 <span class="dropdown-text">Routes inond√©es</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-propos" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">√Ç propos</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-propos">    
        <li>
    <a class="dropdown-item" href="https://www.eptb-vienne.fr" target="_blank">
 <span class="dropdown-text">EPTB-vienne.fr</span></a>
  </li>  
    </ul>
  </li>
</ul>
              <div class="quarto-navbar-tools">
    <a href="https://fr.linkedin.com/company/eptb-vienne" title="LinkedIn" class="quarto-navigation-tool px-1" aria-label="LinkedIn"><i class="bi bi-linkedin"></i></a>
    <a href="https://eptb-vienne.fr/contact" title="Nous contacter" class="quarto-navigation-tool px-1" aria-label="Nous contacter"><i class="bi bi-envelope"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-layout-custom page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
<!-- main -->

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Carte Intercative</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="nav-menu-objectif-n¬∞1"></div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="35" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 34;"><span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>bbox_sru <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/bb.json"</span>)<span class="op">.</span><span class="fu">json</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<style>
/* Conteneur global */
.collapse-box {
  margin: 20px 0;
  border-radius: 12px;
  overflow: hidden;
  background: #ffffff;
  border: 1px solid #e5e5e5;
  box-shadow: 0 4px 12px rgba(0,0,0,0.06);
}

/* En-t√™te cliquable */
.collapse-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #fafafa;
  padding: 18px 22px;
  cursor: pointer;
  font-family: avenir;
  font-size: 1.15em;
  font-weight: 600;
  color: #333;
  transition: background 0.25s ease;
}

.collapse-header span:first-child {
  padding-left: 44px; 
  opacity: 0.7;
}



.collapse-header:hover {
  background: #f0f0f0;
}

/* Fl√®che SVG moderne */
.collapse-arrow {
  width: 18px;
  height: 18px;
  transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  opacity: 0.7;
}

.collapse-header.active .collapse-arrow {
  transform: rotate(90deg);
  opacity: 1;
}

/* Contenu d√©pliant */
.collapse-content {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.45s ease, padding 0.3s ease;
  background: #ffffff;
  padding: 0 0;
}

.collapse-content.open {
  padding: 20px 0 30px 0;
}
</style>

<div class="collapse-box">

  <h1 style="color:orangered; font-size:1.5rem; margin: 20px; font-family:avenir; opacity: 0.7;">
    Nombre de personnes occupant des b√¢timents de plain-pied fortement inondables
  </h1>

  <!-- TITRE CLIQUABLE -->
  <div class="collapse-header">
    <span>Plus d'informations concernant cet indicateur</span>

    <!-- Fl√®che SVG moderne -->
    <svg class="collapse-arrow" viewbox="0 0 24 24">
      <path d="M8 5l8 7-8 7" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
    </svg>
  </div>

  <!-- CONTENU D√âPLIANT -->
  <div class="collapse-content">

    <div style="
      margin-left:10vw; 
      margin-right:10vw; 
      margin-top:20px; 
      border:1px solid #ddd; 
      border-radius:10px; 
      padding:30px; 
      background-color:white;
    ">

      <div style="display:flex; justify-content:space-between; align-items:flex-start; gap:40px;">

        <!-- COLONNE GAUCHE -->
        <div style="flex:1;">

          <p style="font-size:1.1em; font-family:avenir;">
            Le niveau des eaux peut monter relativement vite pour pi√©ger des personnes dans des locaux ne disposant pas d‚Äôun acc√®s vers un √©tage refuge.
          </p>

          <a href="https://fiches.eptb-vienne.fr/ind_12a.pdf" target="_blank" style="display:block; margin-bottom:14px; text-align:left; font-size:1.05em;">
            <i class="fa fa-exclamation-circle"></i> T√©l√©charger la fiche indicateur et la carte
          </a>

        </div>

        <!-- COLONNE DROITE -->
        <div style="flex:0 0 35%;">

          <p style="
              padding:12px; 
              border:1px solid #ddd; 
              border-radius:12px; 
              background:#f7f7f7; 
              font-size:1.05em; 
              text-align:center;
            ">
            La zone inondable correspond √† l'al√©a centennal construit √† partir des donn√©es disponibles et notamment r√©glementaires mais en aucun cas             ne se substitue aux documents r√©glementaires en vigueur.
          </p>

        </div>

      </div>

    </div>

  </div>
</div>

<script>
document.querySelectorAll(".collapse-header").forEach(header => {
  header.addEventListener("click", () => {
    const content = header.nextElementSibling;

    header.classList.toggle("active");

    if (content.style.maxHeight) {
      // fermeture
      content.style.maxHeight = null;
      content.classList.remove("open");
    } else {
      // ouverture fluide
      content.style.maxHeight = content.scrollHeight + 40 + "px";
      content.classList.add("open");
    }
  });
});

new ResizeObserver(() => {
  if (content.classList.contains("open")) {
    content.style.maxHeight = content.scrollHeight + 40 + "px";
  }
}).observe(content);

</script>
<div class="tabset">
  <!-- Boutons -->
  <div class="tab-buttons">
    <button class="tab-btn active" data-tab="tab1">Cartographie</button>
    <button class="tab-btn" data-tab="tab4">Donn√©es de la commune</button> 
    <button class="tab-btn" data-tab="tab5">Tableau de donn√©es</button>
    <button class="tab-btn" data-tab="tab6">Graphiques</button>
    <button class="tab-btn" data-tab="tab2">Informations relatives √† l'indicateur</button>
    <button class="tab-btn" data-tab="tab3">B√¢timents en 3D : Mode d'emploi</button>
  </div>
  
    <!-- Contenu --> 
    <div class="tab-content">
      <div id="tab1" class="tab active" style="margin-top:-40px;">
        <p style="margin-left:10vw; margin-right:10vw;">
      
</p><div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="223" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 222;"><span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>bassin_vienne <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/bassin_vienne.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>departement <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/departement.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a>region <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/region.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>epci <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/epci.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a>perimetre <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/perimetre.json"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>slgri <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/slgri.json"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a>tri <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/tri.json"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a>zone_inondable <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/zone_inondable.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a><span class="co">//indicateurs = FileAttachment("layers/indicateurs.json").json();</span></span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>cours_d_eau <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/cours_d_eau.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a>indicateursGeojson <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/indicateurs.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a>batiments <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/batiments_hauteur.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-11" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell" data-padding="0px" data-expandable="false" data-fill="true">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="242" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 241;"><span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a>map <span class="op">=</span> {</span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> container <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="map-container" id="map" style="height: 600px; width: 90%; margin-left: 5vw;"&gt;&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yield</span> container<span class="op">;</span></span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a>  <span class="op">&lt;!--</span> <span class="kw">const</span> sourcePlanIGN <span class="op">=</span> { <span class="op">--&gt;</span></span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a>  <span class="op">&lt;!--</span>   <span class="dt">style</span><span class="op">:</span> <span class="st">'normal'</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a>  <span class="op">&lt;!--</span>   <span class="dt">format</span><span class="op">:</span> <span class="st">'image/png'</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-249"><a href="#cb3-249" aria-hidden="true" tabindex="-1"></a>  <span class="op">&lt;!--</span>   <span class="dt">layer</span><span class="op">:</span> <span class="st">'GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2'</span> <span class="op">--&gt;</span></span>
<span id="cb3-250"><a href="#cb3-250" aria-hidden="true" tabindex="-1"></a>  <span class="op">&lt;!--</span> }<span class="op">;</span> <span class="op">--&gt;</span></span>
<span id="cb3-251"><a href="#cb3-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-252"><a href="#cb3-252" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sourceOrtho <span class="op">=</span> {</span>
<span id="cb3-253"><a href="#cb3-253" aria-hidden="true" tabindex="-1"></a>    <span class="dt">style</span><span class="op">:</span> <span class="st">'normal'</span><span class="op">,</span></span>
<span id="cb3-254"><a href="#cb3-254" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> <span class="st">'image/jpeg'</span><span class="op">,</span></span>
<span id="cb3-255"><a href="#cb3-255" aria-hidden="true" tabindex="-1"></a>    <span class="dt">layer</span><span class="op">:</span> <span class="st">'HR.ORTHOIMAGERY.ORTHOPHOTOS'</span></span>
<span id="cb3-256"><a href="#cb3-256" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb3-257"><a href="#cb3-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-258"><a href="#cb3-258" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> map <span class="op">=</span> <span class="kw">new</span> maplibregl<span class="op">.</span><span class="fu">Map</span>({</span>
<span id="cb3-259"><a href="#cb3-259" aria-hidden="true" tabindex="-1"></a>    <span class="dt">container</span><span class="op">:</span> container<span class="op">,</span></span>
<span id="cb3-260"><a href="#cb3-260" aria-hidden="true" tabindex="-1"></a>    <span class="dt">style</span><span class="op">:</span> <span class="st">'https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json'</span><span class="op">,</span></span>
<span id="cb3-261"><a href="#cb3-261" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span> <span class="dt">center</span><span class="op">:</span> [<span class="op">-</span><span class="fl">0.04</span><span class="op">,</span> <span class="fl">46.3051</span>]<span class="op">,</span>  <span class="op">--&gt;</span></span>
<span id="cb3-262"><a href="#cb3-262" aria-hidden="true" tabindex="-1"></a>    <span class="dt">zoom</span><span class="op">:</span> <span class="dv">11</span></span>
<span id="cb3-263"><a href="#cb3-263" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb3-264"><a href="#cb3-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-265"><a href="#cb3-265" aria-hidden="true" tabindex="-1"></a>  map<span class="op">.</span><span class="fu">addControl</span>(<span class="kw">new</span> maplibregl<span class="op">.</span><span class="fu">FullscreenControl</span>()<span class="op">,</span> <span class="st">'top-right'</span>)<span class="op">;</span></span>
<span id="cb3-266"><a href="#cb3-266" aria-hidden="true" tabindex="-1"></a>  map<span class="op">.</span><span class="fu">addControl</span>(<span class="kw">new</span> maplibregl<span class="op">.</span><span class="fu">NavigationControl</span>({ <span class="dt">visualizePitch</span><span class="op">:</span> <span class="kw">true</span> })<span class="op">,</span> <span class="st">'top-left'</span>)<span class="op">;</span></span>
<span id="cb3-267"><a href="#cb3-267" aria-hidden="true" tabindex="-1"></a>  map<span class="op">.</span><span class="fu">addControl</span>(<span class="kw">new</span> maplibregl<span class="op">.</span><span class="fu">ScaleControl</span>({ <span class="dt">maxWidth</span><span class="op">:</span> <span class="dv">80</span><span class="op">,</span> <span class="dt">unit</span><span class="op">:</span> <span class="st">'metric'</span> }))<span class="op">;</span></span>
<span id="cb3-268"><a href="#cb3-268" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-269"><a href="#cb3-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> toggleStyle <span class="op">=</span> (useOrtho) <span class="kw">=&gt;</span> {</span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (useOrtho) {</span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a>      map<span class="op">.</span><span class="fu">setLayoutProperty</span>(<span class="st">'orthoIGN'</span><span class="op">,</span> <span class="st">'visibility'</span><span class="op">,</span> <span class="st">'visible'</span>)<span class="op">;</span></span>
<span id="cb3-273"><a href="#cb3-273" aria-hidden="true" tabindex="-1"></a>      map<span class="op">.</span><span class="fu">setLayoutProperty</span>(<span class="st">'OSM'</span><span class="op">,</span> <span class="st">'visibility'</span><span class="op">,</span> <span class="st">'none'</span>)<span class="op">;</span></span>
<span id="cb3-274"><a href="#cb3-274" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb3-275"><a href="#cb3-275" aria-hidden="true" tabindex="-1"></a>      map<span class="op">.</span><span class="fu">setLayoutProperty</span>(<span class="st">'orthoIGN'</span><span class="op">,</span> <span class="st">'visibility'</span><span class="op">,</span> <span class="st">'none'</span>)<span class="op">;</span></span>
<span id="cb3-276"><a href="#cb3-276" aria-hidden="true" tabindex="-1"></a>      map<span class="op">.</span><span class="fu">setLayoutProperty</span>(<span class="st">'OSM'</span><span class="op">,</span> <span class="st">'visibility'</span><span class="op">,</span> <span class="st">'visible'</span>)<span class="op">;</span></span>
<span id="cb3-277"><a href="#cb3-277" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-278"><a href="#cb3-278" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb3-279"><a href="#cb3-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-280"><a href="#cb3-280" aria-hidden="true" tabindex="-1"></a>  map<span class="op">.</span><span class="fu">on</span>(<span class="st">'load'</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb3-281"><a href="#cb3-281" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">fitBounds</span>(</span>
<span id="cb3-282"><a href="#cb3-282" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb3-283"><a href="#cb3-283" aria-hidden="true" tabindex="-1"></a>      [<span class="op">-</span><span class="fl">0.04</span><span class="op">,</span> <span class="fl">46.3051</span>]<span class="op">,</span>   <span class="co">// Sud-Ouest</span></span>
<span id="cb3-284"><a href="#cb3-284" aria-hidden="true" tabindex="-1"></a>      [<span class="fl">0.7741</span><span class="op">,</span> <span class="fl">46.8565</span>]   <span class="co">// Nord-Est</span></span>
<span id="cb3-285"><a href="#cb3-285" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb3-286"><a href="#cb3-286" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-287"><a href="#cb3-287" aria-hidden="true" tabindex="-1"></a>      <span class="dt">padding</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span></span>
<span id="cb3-288"><a href="#cb3-288" aria-hidden="true" tabindex="-1"></a>      <span class="dt">linear</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb3-289"><a href="#cb3-289" aria-hidden="true" tabindex="-1"></a>      <span class="dt">duration</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb3-290"><a href="#cb3-290" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-291"><a href="#cb3-291" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb3-292"><a href="#cb3-292" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Ajout des fonds raster IGN</span></span>
<span id="cb3-293"><a href="#cb3-293" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span> map<span class="op">.</span><span class="fu">addSource</span>(<span class="st">'raster-planign'</span><span class="op">,</span> { <span class="op">--&gt;</span></span>
<span id="cb3-294"><a href="#cb3-294" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">type</span><span class="op">:</span> <span class="st">'raster'</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-295"><a href="#cb3-295" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">tiles</span><span class="op">:</span> [ <span class="op">--&gt;</span></span>
<span id="cb3-296"><a href="#cb3-296" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>     <span class="vs">`https://data.geopf.fr/wmts?SERVICE=WMTS&amp;style=</span><span class="sc">${</span>sourcePlanIGN<span class="op">.</span><span class="at">style</span><span class="sc">}</span><span class="vs">&amp;VERSION=1.0.0&amp;REQUEST=GetTile&amp;format=</span><span class="sc">${</span>sourcePlanIGN<span class="op">.</span><span class="at">format</span><span class="sc">}</span><span class="vs">&amp;layer=</span><span class="sc">${</span>sourcePlanIGN<span class="op">.</span><span class="at">layer</span><span class="sc">}</span><span class="vs">&amp;tilematrixset=PM&amp;TileMatrix={z}&amp;TileCol={x}&amp;TileRow={y}`</span> <span class="op">--&gt;</span></span>
<span id="cb3-297"><a href="#cb3-297" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   ]<span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-298"><a href="#cb3-298" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">tileSize</span><span class="op">:</span> <span class="dv">256</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-299"><a href="#cb3-299" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">attribution</span><span class="op">:</span> <span class="st">'¬© &lt;a href="https://www.ign.fr/"&gt;IGN&lt;/a&gt;'</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-300"><a href="#cb3-300" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">minzoom</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-301"><a href="#cb3-301" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">maxzoom</span><span class="op">:</span> <span class="dv">22</span> <span class="op">--&gt;</span></span>
<span id="cb3-302"><a href="#cb3-302" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span> })<span class="op">;</span> <span class="op">--&gt;</span></span>
<span id="cb3-303"><a href="#cb3-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-304"><a href="#cb3-304" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">addSource</span>(<span class="st">'raster-ortho'</span><span class="op">,</span> {</span>
<span id="cb3-305"><a href="#cb3-305" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">'raster'</span><span class="op">,</span></span>
<span id="cb3-306"><a href="#cb3-306" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tiles</span><span class="op">:</span> [</span>
<span id="cb3-307"><a href="#cb3-307" aria-hidden="true" tabindex="-1"></a>        <span class="vs">`https://data.geopf.fr/wmts?SERVICE=WMTS&amp;style=</span><span class="sc">${</span>sourceOrtho<span class="op">.</span><span class="at">style</span><span class="sc">}</span><span class="vs">&amp;VERSION=1.0.0&amp;REQUEST=GetTile&amp;format=</span><span class="sc">${</span>sourceOrtho<span class="op">.</span><span class="at">format</span><span class="sc">}</span><span class="vs">&amp;layer=</span><span class="sc">${</span>sourceOrtho<span class="op">.</span><span class="at">layer</span><span class="sc">}</span><span class="vs">&amp;tilematrixset=PM&amp;TileMatrix={z}&amp;TileCol={x}&amp;TileRow={y}`</span></span>
<span id="cb3-308"><a href="#cb3-308" aria-hidden="true" tabindex="-1"></a>      ]<span class="op">,</span></span>
<span id="cb3-309"><a href="#cb3-309" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tileSize</span><span class="op">:</span> <span class="dv">256</span><span class="op">,</span></span>
<span id="cb3-310"><a href="#cb3-310" aria-hidden="true" tabindex="-1"></a>      <span class="dt">attribution</span><span class="op">:</span> <span class="st">'¬© &lt;a href="https://www.ign.fr/"&gt;IGN&lt;/a&gt;'</span><span class="op">,</span></span>
<span id="cb3-311"><a href="#cb3-311" aria-hidden="true" tabindex="-1"></a>      <span class="dt">minzoom</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-312"><a href="#cb3-312" aria-hidden="true" tabindex="-1"></a>      <span class="dt">maxzoom</span><span class="op">:</span> <span class="dv">22</span></span>
<span id="cb3-313"><a href="#cb3-313" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-314"><a href="#cb3-314" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-315"><a href="#cb3-315" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">addSource</span>(<span class="st">'raster-osm'</span><span class="op">,</span> {</span>
<span id="cb3-316"><a href="#cb3-316" aria-hidden="true" tabindex="-1"></a>  <span class="dt">type</span><span class="op">:</span> <span class="st">'raster'</span><span class="op">,</span></span>
<span id="cb3-317"><a href="#cb3-317" aria-hidden="true" tabindex="-1"></a>  <span class="dt">tiles</span><span class="op">:</span> [</span>
<span id="cb3-318"><a href="#cb3-318" aria-hidden="true" tabindex="-1"></a>    <span class="st">'https://tile.openstreetmap.org/{z}/{x}/{y}.png'</span></span>
<span id="cb3-319"><a href="#cb3-319" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb3-320"><a href="#cb3-320" aria-hidden="true" tabindex="-1"></a>  <span class="dt">tileSize</span><span class="op">:</span> <span class="dv">256</span><span class="op">,</span></span>
<span id="cb3-321"><a href="#cb3-321" aria-hidden="true" tabindex="-1"></a>  <span class="dt">attribution</span><span class="op">:</span></span>
<span id="cb3-322"><a href="#cb3-322" aria-hidden="true" tabindex="-1"></a>    <span class="st">'¬© &lt;a href="https://www.openstreetmap.org/copyright"&gt;OpenStreetMap&lt;/a&gt; contributors'</span><span class="op">,</span></span>
<span id="cb3-323"><a href="#cb3-323" aria-hidden="true" tabindex="-1"></a>  <span class="dt">minzoom</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-324"><a href="#cb3-324" aria-hidden="true" tabindex="-1"></a>  <span class="dt">maxzoom</span><span class="op">:</span> <span class="dv">19</span></span>
<span id="cb3-325"><a href="#cb3-325" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-326"><a href="#cb3-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-327"><a href="#cb3-327" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span> map<span class="op">.</span><span class="fu">addLayer</span>({ <span class="op">--&gt;</span></span>
<span id="cb3-328"><a href="#cb3-328" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">id</span><span class="op">:</span> <span class="st">'planIGN'</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-329"><a href="#cb3-329" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">type</span><span class="op">:</span> <span class="st">'raster'</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-330"><a href="#cb3-330" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">source</span><span class="op">:</span> <span class="st">'raster-planign'</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-331"><a href="#cb3-331" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">layout</span><span class="op">:</span> { <span class="dt">visibility</span><span class="op">:</span> <span class="st">'visible'</span> } <span class="op">--&gt;</span></span>
<span id="cb3-332"><a href="#cb3-332" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span> })<span class="op">;</span> <span class="op">--&gt;</span></span>
<span id="cb3-333"><a href="#cb3-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-334"><a href="#cb3-334" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">addLayer</span>({</span>
<span id="cb3-335"><a href="#cb3-335" aria-hidden="true" tabindex="-1"></a>      <span class="dt">id</span><span class="op">:</span> <span class="st">'orthoIGN'</span><span class="op">,</span></span>
<span id="cb3-336"><a href="#cb3-336" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">'raster'</span><span class="op">,</span></span>
<span id="cb3-337"><a href="#cb3-337" aria-hidden="true" tabindex="-1"></a>      <span class="dt">source</span><span class="op">:</span> <span class="st">'raster-ortho'</span><span class="op">,</span></span>
<span id="cb3-338"><a href="#cb3-338" aria-hidden="true" tabindex="-1"></a>      <span class="dt">layout</span><span class="op">:</span> { <span class="dt">visibility</span><span class="op">:</span> <span class="st">'none'</span> }</span>
<span id="cb3-339"><a href="#cb3-339" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-340"><a href="#cb3-340" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-341"><a href="#cb3-341" aria-hidden="true" tabindex="-1"></a>     map<span class="op">.</span><span class="fu">addLayer</span>({</span>
<span id="cb3-342"><a href="#cb3-342" aria-hidden="true" tabindex="-1"></a>      <span class="dt">id</span><span class="op">:</span> <span class="st">'OSM'</span><span class="op">,</span></span>
<span id="cb3-343"><a href="#cb3-343" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">'raster'</span><span class="op">,</span></span>
<span id="cb3-344"><a href="#cb3-344" aria-hidden="true" tabindex="-1"></a>      <span class="dt">source</span><span class="op">:</span> <span class="st">'raster-osm'</span><span class="op">,</span></span>
<span id="cb3-345"><a href="#cb3-345" aria-hidden="true" tabindex="-1"></a>      <span class="dt">layout</span><span class="op">:</span> { <span class="dt">visibility</span><span class="op">:</span> <span class="st">'visible'</span> } <span class="co">// tu peux le laisser cach√© au d√©part si tu veux le basculer ensuite</span></span>
<span id="cb3-346"><a href="#cb3-346" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-347"><a href="#cb3-347" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-348"><a href="#cb3-348" aria-hidden="true" tabindex="-1"></a>    <span class="co">//fetch('layers/indicateurs.geojson')</span></span>
<span id="cb3-349"><a href="#cb3-349" aria-hidden="true" tabindex="-1"></a>     <span class="co">//.then(response =&gt; response.json())</span></span>
<span id="cb3-350"><a href="#cb3-350" aria-hidden="true" tabindex="-1"></a>     <span class="co">//.then(indicateursGeojson =&gt; { </span></span>
<span id="cb3-351"><a href="#cb3-351" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb3-352"><a href="#cb3-352" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-353"><a href="#cb3-353" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> layersData <span class="op">=</span> [</span>
<span id="cb3-354"><a href="#cb3-354" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">data</span><span class="op">:</span> bassin_vienne<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'line'</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'bassinvienneLayer'</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">'green'</span><span class="op">,</span> <span class="dt">layout</span><span class="op">:</span> {<span class="dt">visibility</span><span class="op">:</span><span class="st">'none'</span>}}<span class="op">,</span></span>
<span id="cb3-355"><a href="#cb3-355" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">data</span><span class="op">:</span> region<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'line'</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'regionLayer'</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">'red'</span><span class="op">,</span> <span class="dt">layout</span><span class="op">:</span> {<span class="dt">visibility</span><span class="op">:</span><span class="st">'none'</span>} }<span class="op">,</span></span>
<span id="cb3-356"><a href="#cb3-356" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">data</span><span class="op">:</span> departement<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'line'</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'departementLayer'</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">'#a772b9'</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span>  <span class="dt">layout</span><span class="op">:</span>{<span class="dt">visibility</span><span class="op">:</span><span class="st">'none'</span>}}<span class="op">,</span></span>
<span id="cb3-357"><a href="#cb3-357" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">data</span><span class="op">:</span> epci<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'line'</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'epciLayer'</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">'#567ae3'</span><span class="op">,</span> <span class="dt">layout</span><span class="op">:</span> {<span class="dt">visibility</span><span class="op">:</span><span class="st">'none'</span>} }<span class="op">,</span></span>
<span id="cb3-358"><a href="#cb3-358" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">data</span><span class="op">:</span> indicateursGeojson<span class="op">,</span> <span class="co">// GeoJSON contenant une propri√©t√© 's12a' --&gt;</span></span>
<span id="cb3-359"><a href="#cb3-359" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">'fill'</span><span class="op">,</span></span>
<span id="cb3-360"><a href="#cb3-360" aria-hidden="true" tabindex="-1"></a>        <span class="dt">id</span><span class="op">:</span> <span class="st">'indicateurs12aLayer'</span><span class="op">,</span></span>
<span id="cb3-361"><a href="#cb3-361" aria-hidden="true" tabindex="-1"></a>        <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb3-362"><a href="#cb3-362" aria-hidden="true" tabindex="-1"></a>        <span class="dt">width</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb3-363"><a href="#cb3-363" aria-hidden="true" tabindex="-1"></a>        <span class="dt">dynamicColor</span><span class="op">:</span> { </span>
<span id="cb3-364"><a href="#cb3-364" aria-hidden="true" tabindex="-1"></a>        <span class="dt">property</span><span class="op">:</span> <span class="st">'s12a'</span><span class="op">,</span></span>
<span id="cb3-365"><a href="#cb3-365" aria-hidden="true" tabindex="-1"></a>        <span class="dt">mapping</span><span class="op">:</span> { </span>
<span id="cb3-366"><a href="#cb3-366" aria-hidden="true" tabindex="-1"></a>           <span class="co">//'-1': '#f1eeed',</span></span>
<span id="cb3-367"><a href="#cb3-367" aria-hidden="true" tabindex="-1"></a>           <span class="co">//'0': '#ffffff', </span></span>
<span id="cb3-368"><a href="#cb3-368" aria-hidden="true" tabindex="-1"></a>           <span class="st">'10'</span><span class="op">:</span> <span class="st">'#ffffff'</span><span class="op">,</span></span>
<span id="cb3-369"><a href="#cb3-369" aria-hidden="true" tabindex="-1"></a>           <span class="st">'50'</span><span class="op">:</span> <span class="st">'#ffaaaa'</span><span class="op">,</span> </span>
<span id="cb3-370"><a href="#cb3-370" aria-hidden="true" tabindex="-1"></a>           <span class="st">'100'</span><span class="op">:</span> <span class="st">'#ff5555'</span></span>
<span id="cb3-371"><a href="#cb3-371" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span> </span>
<span id="cb3-372"><a href="#cb3-372" aria-hidden="true" tabindex="-1"></a>         <span class="cf">default</span><span class="op">:</span> <span class="st">'#d9d9d9'</span></span>
<span id="cb3-373"><a href="#cb3-373" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-374"><a href="#cb3-374" aria-hidden="true" tabindex="-1"></a>        <span class="op">,</span> <span class="dt">layout</span><span class="op">:</span> {<span class="dt">visibility</span><span class="op">:</span><span class="st">'visible'</span>}</span>
<span id="cb3-375"><a href="#cb3-375" aria-hidden="true" tabindex="-1"></a>         }<span class="op">,</span></span>
<span id="cb3-376"><a href="#cb3-376" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">data</span><span class="op">:</span> zone_inondable<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'fill'</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'zoneinondableLayer'</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">'#b4c3ef'</span> <span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> </span>
<span id="cb3-377"><a href="#cb3-377" aria-hidden="true" tabindex="-1"></a>      <span class="dt">layout</span><span class="op">:</span> {<span class="dt">visibility</span><span class="op">:</span><span class="st">'visible'</span>} }<span class="op">,</span></span>
<span id="cb3-378"><a href="#cb3-378" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">data</span><span class="op">:</span> cours_d_eau<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'line'</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'coursdeauLayer'</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">'#b4c3ef'</span> <span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> </span>
<span id="cb3-379"><a href="#cb3-379" aria-hidden="true" tabindex="-1"></a>      <span class="dt">layout</span><span class="op">:</span> {<span class="dt">visibility</span><span class="op">:</span><span class="st">'visible'</span>} }<span class="op">,</span></span>
<span id="cb3-380"><a href="#cb3-380" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">data</span><span class="op">:</span> batiments<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'fill-extrusion'</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'batimentsLayer'</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span><span class="dv">2</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">colorByType</span><span class="op">:</span> <span class="st">'ff_dteloctxt'</span><span class="op">,</span> <span class="dt">heightProperty</span><span class="op">:</span> <span class="st">'hauteur'</span><span class="op">,</span><span class="dt">layout</span><span class="op">:</span> {<span class="dt">visibility</span><span class="op">:</span><span class="st">'none'</span>}}</span>
<span id="cb3-381"><a href="#cb3-381" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-382"><a href="#cb3-382" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">;</span></span>
<span id="cb3-383"><a href="#cb3-383" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-384"><a href="#cb3-384" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Cr√©er le conteneur</span></span>
<span id="cb3-385"><a href="#cb3-385" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> legend <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb3-386"><a href="#cb3-386" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">id</span> <span class="op">=</span> <span class="st">'legend'</span><span class="op">;</span></span>
<span id="cb3-387"><a href="#cb3-387" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">position</span> <span class="op">=</span> <span class="st">'absolute'</span><span class="op">;</span></span>
<span id="cb3-388"><a href="#cb3-388" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">top</span> <span class="op">=</span> <span class="st">'82%'</span><span class="op">;</span></span>
<span id="cb3-389"><a href="#cb3-389" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">right</span> <span class="op">=</span> <span class="st">'10px'</span><span class="op">;</span></span>
<span id="cb3-390"><a href="#cb3-390" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">transform</span> <span class="op">=</span> <span class="st">'translateY(-50%)'</span><span class="op">;</span></span>
<span id="cb3-391"><a href="#cb3-391" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">background</span> <span class="op">=</span> <span class="st">'white'</span><span class="op">;</span></span>
<span id="cb3-392"><a href="#cb3-392" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">padding</span> <span class="op">=</span> <span class="st">'10px'</span><span class="op">;</span></span>
<span id="cb3-393"><a href="#cb3-393" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">fontSize</span> <span class="op">=</span> <span class="st">'12px'</span><span class="op">;</span></span>
<span id="cb3-394"><a href="#cb3-394" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">borderRadius</span> <span class="op">=</span> <span class="st">'4px'</span><span class="op">;</span></span>
<span id="cb3-395"><a href="#cb3-395" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">boxShadow</span> <span class="op">=</span> <span class="st">'0 1px 4px rgba(0,0,0,0.3)'</span><span class="op">;</span></span>
<span id="cb3-396"><a href="#cb3-396" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">zIndex</span> <span class="op">=</span> <span class="st">'1'</span><span class="op">;</span> <span class="co">// pour passer au-dessus de la carte</span></span>
<span id="cb3-397"><a href="#cb3-397" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-398"><a href="#cb3-398" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Contenu de la l√©gende</span></span>
<span id="cb3-399"><a href="#cb3-399" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb3-400"><a href="#cb3-400" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;strong&gt;Population en zone &lt;br&gt;fortement inondable&lt;/strong&gt;&lt;br&gt;</span></span>
<span id="cb3-401"><a href="#cb3-401" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#d9d9d9;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; 0&lt;/div&gt;</span></span>
<span id="cb3-402"><a href="#cb3-402" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#ffffff;width:12px;height:12px;display:inline-block;margin-right:5px;border:1px solid #ccc;"&gt;&lt;/span&gt; &lt; 10 &lt;/div&gt;</span></span>
<span id="cb3-403"><a href="#cb3-403" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#ffaaaa;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; 10-50 &lt;/div&gt;</span></span>
<span id="cb3-404"><a href="#cb3-404" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#ff5555;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; 50-100 &lt;/div&gt;</span></span>
<span id="cb3-405"><a href="#cb3-405" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#ff0000;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; &gt; 100 &lt;/div&gt;</span></span>
<span id="cb3-406"><a href="#cb3-406" aria-hidden="true" tabindex="-1"></a><span class="vs">        `</span><span class="op">;</span></span>
<span id="cb3-407"><a href="#cb3-407" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-408"><a href="#cb3-408" aria-hidden="true" tabindex="-1"></a>        <span class="co">// L‚Äôajouter √† la carte (le container MapLibre)</span></span>
<span id="cb3-409"><a href="#cb3-409" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">getContainer</span>()<span class="op">.</span><span class="fu">appendChild</span>(legend)<span class="op">;</span></span>
<span id="cb3-410"><a href="#cb3-410" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-411"><a href="#cb3-411" aria-hidden="true" tabindex="-1"></a>        <span class="co">//afin de lier la l√©gende √† l'indicateur</span></span>
<span id="cb3-412"><a href="#cb3-412" aria-hidden="true" tabindex="-1"></a>        <span class="kw">function</span> <span class="fu">updateLegendVisibility</span>() {</span>
<span id="cb3-413"><a href="#cb3-413" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> visibility <span class="op">=</span> map<span class="op">.</span><span class="fu">getLayoutProperty</span>(<span class="st">'indicateurs12aLayer'</span><span class="op">,</span> <span class="st">'visibility'</span>)<span class="op">;</span></span>
<span id="cb3-414"><a href="#cb3-414" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (visibility <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb3-415"><a href="#cb3-415" aria-hidden="true" tabindex="-1"></a>          legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'none'</span><span class="op">;</span></span>
<span id="cb3-416"><a href="#cb3-416" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb3-417"><a href="#cb3-417" aria-hidden="true" tabindex="-1"></a>          legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'block'</span><span class="op">;</span></span>
<span id="cb3-418"><a href="#cb3-418" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-419"><a href="#cb3-419" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-420"><a href="#cb3-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-421"><a href="#cb3-421" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">on</span>(<span class="st">'idle'</span><span class="op">,</span> updateLegendVisibility)<span class="op">;</span></span>
<span id="cb3-422"><a href="#cb3-422" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-423"><a href="#cb3-423" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Cr√©er le conteneur de l√©gende des b√¢timents</span></span>
<span id="cb3-424"><a href="#cb3-424" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batimentLegend <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb3-425"><a href="#cb3-425" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">id</span> <span class="op">=</span> <span class="st">'batiment-legend'</span><span class="op">;</span></span>
<span id="cb3-426"><a href="#cb3-426" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">position</span> <span class="op">=</span> <span class="st">'absolute'</span><span class="op">;</span></span>
<span id="cb3-427"><a href="#cb3-427" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">top</span> <span class="op">=</span> <span class="st">'81%'</span><span class="op">;</span></span>
<span id="cb3-428"><a href="#cb3-428" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">left</span> <span class="op">=</span> <span class="st">'10px'</span><span class="op">;</span></span>
<span id="cb3-429"><a href="#cb3-429" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">transform</span> <span class="op">=</span> <span class="st">'translateY(-50%)'</span><span class="op">;</span></span>
<span id="cb3-430"><a href="#cb3-430" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">background</span> <span class="op">=</span> <span class="st">'white'</span><span class="op">;</span></span>
<span id="cb3-431"><a href="#cb3-431" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">padding</span> <span class="op">=</span> <span class="st">'10px'</span><span class="op">;</span></span>
<span id="cb3-432"><a href="#cb3-432" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">fontSize</span> <span class="op">=</span> <span class="st">'12px'</span><span class="op">;</span></span>
<span id="cb3-433"><a href="#cb3-433" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">borderRadius</span> <span class="op">=</span> <span class="st">'4px'</span><span class="op">;</span></span>
<span id="cb3-434"><a href="#cb3-434" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">boxShadow</span> <span class="op">=</span> <span class="st">'0 1px 4px rgba(0,0,0,0.3)'</span><span class="op">;</span></span>
<span id="cb3-435"><a href="#cb3-435" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">zIndex</span> <span class="op">=</span> <span class="st">'1'</span><span class="op">;</span></span>
<span id="cb3-436"><a href="#cb3-436" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-437"><a href="#cb3-437" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Contenu de la l√©gende</span></span>
<span id="cb3-438"><a href="#cb3-438" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb3-439"><a href="#cb3-439" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;strong&gt;Type de b√¢timent&lt;/strong&gt;&lt;br&gt;</span></span>
<span id="cb3-440"><a href="#cb3-440" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#1f77b4;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; Activit√©&lt;/div&gt;</span></span>
<span id="cb3-441"><a href="#cb3-441" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#2ca02c;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; Appartement&lt;/div&gt;</span></span>
<span id="cb3-442"><a href="#cb3-442" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#d9d9d9;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; Aucun local&lt;/div&gt;</span></span>
<span id="cb3-443"><a href="#cb3-443" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#9467bd;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; D√©pendance&lt;/div&gt;</span></span>
<span id="cb3-444"><a href="#cb3-444" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#ff7f0e;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; Maison&lt;/div&gt;</span></span>
<span id="cb3-445"><a href="#cb3-445" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#e377c2;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; Mixte&lt;/div&gt;</span></span>
<span id="cb3-446"><a href="#cb3-446" aria-hidden="true" tabindex="-1"></a><span class="vs">        `</span><span class="op">;</span></span>
<span id="cb3-447"><a href="#cb3-447" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-448"><a href="#cb3-448" aria-hidden="true" tabindex="-1"></a>        <span class="co">// L‚Äôajouter √† la carte</span></span>
<span id="cb3-449"><a href="#cb3-449" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">getContainer</span>()<span class="op">.</span><span class="fu">appendChild</span>(batimentLegend)<span class="op">;</span></span>
<span id="cb3-450"><a href="#cb3-450" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'none'</span><span class="op">;</span> <span class="co">// Permet de supprimer l'affichage de la l√©gende au chargement de la page</span></span>
<span id="cb3-451"><a href="#cb3-451" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-452"><a href="#cb3-452" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Lier la visibilit√© √† la couche b√¢timent</span></span>
<span id="cb3-453"><a href="#cb3-453" aria-hidden="true" tabindex="-1"></a>        <span class="kw">function</span> <span class="fu">updateBatimentLegendVisibility</span>() {</span>
<span id="cb3-454"><a href="#cb3-454" aria-hidden="true" tabindex="-1"></a>          <span class="kw">const</span> visibility <span class="op">=</span> map<span class="op">.</span><span class="fu">getLayoutProperty</span>(<span class="st">'batimentsLayer'</span><span class="op">,</span> <span class="st">'visibility'</span>)<span class="op">;</span></span>
<span id="cb3-455"><a href="#cb3-455" aria-hidden="true" tabindex="-1"></a>          <span class="co">//batimentLegend.style.display = (visibility === 'none') ? 'none' : 'block';</span></span>
<span id="cb3-456"><a href="#cb3-456" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (visibility <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb3-457"><a href="#cb3-457" aria-hidden="true" tabindex="-1"></a>          batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'none'</span><span class="op">;</span></span>
<span id="cb3-458"><a href="#cb3-458" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb3-459"><a href="#cb3-459" aria-hidden="true" tabindex="-1"></a>          batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'block'</span><span class="op">;</span></span>
<span id="cb3-460"><a href="#cb3-460" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-461"><a href="#cb3-461" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-462"><a href="#cb3-462" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-463"><a href="#cb3-463" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">on</span>(<span class="st">'idle'</span><span class="op">,</span> updateBatimentLegendVisibility)<span class="op">;</span></span>
<span id="cb3-464"><a href="#cb3-464" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb3-465"><a href="#cb3-465" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Ajout des couches vectorielles</span></span>
<span id="cb3-466"><a href="#cb3-466" aria-hidden="true" tabindex="-1"></a>      layersData<span class="op">.</span><span class="fu">forEach</span>(layer <span class="kw">=&gt;</span> {</span>
<span id="cb3-467"><a href="#cb3-467" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">addSource</span>(layer<span class="op">.</span><span class="at">id</span><span class="op">,</span> {</span>
<span id="cb3-468"><a href="#cb3-468" aria-hidden="true" tabindex="-1"></a>          <span class="dt">type</span><span class="op">:</span> <span class="st">'geojson'</span><span class="op">,</span></span>
<span id="cb3-469"><a href="#cb3-469" aria-hidden="true" tabindex="-1"></a>          <span class="dt">data</span><span class="op">:</span> layer<span class="op">.</span><span class="at">data</span></span>
<span id="cb3-470"><a href="#cb3-470" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb3-471"><a href="#cb3-471" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-472"><a href="#cb3-472" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> layerConfig <span class="op">=</span> {</span>
<span id="cb3-473"><a href="#cb3-473" aria-hidden="true" tabindex="-1"></a>          <span class="dt">id</span><span class="op">:</span> layer<span class="op">.</span><span class="at">id</span><span class="op">,</span></span>
<span id="cb3-474"><a href="#cb3-474" aria-hidden="true" tabindex="-1"></a>          <span class="dt">type</span><span class="op">:</span> layer<span class="op">.</span><span class="at">type</span><span class="op">,</span></span>
<span id="cb3-475"><a href="#cb3-475" aria-hidden="true" tabindex="-1"></a>          <span class="dt">source</span><span class="op">:</span> layer<span class="op">.</span><span class="at">id</span><span class="op">,</span></span>
<span id="cb3-476"><a href="#cb3-476" aria-hidden="true" tabindex="-1"></a>          <span class="dt">paint</span><span class="op">:</span> {}<span class="op">,</span></span>
<span id="cb3-477"><a href="#cb3-477" aria-hidden="true" tabindex="-1"></a>          <span class="dt">layout</span><span class="op">:</span> layer<span class="op">.</span><span class="at">layout</span></span>
<span id="cb3-478"><a href="#cb3-478" aria-hidden="true" tabindex="-1"></a>        }<span class="op">;</span></span>
<span id="cb3-479"><a href="#cb3-479" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-480"><a href="#cb3-480" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (layer<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">'fill'</span>) {</span>
<span id="cb3-481"><a href="#cb3-481" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (layer<span class="op">.</span><span class="at">dynamicColor</span>) {</span>
<span id="cb3-482"><a href="#cb3-482" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> prop <span class="op">=</span> [<span class="st">'get'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">dynamicColor</span><span class="op">.</span><span class="at">property</span>]<span class="op">;</span></span>
<span id="cb3-483"><a href="#cb3-483" aria-hidden="true" tabindex="-1"></a>            layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-color'</span>] <span class="op">=</span> [</span>
<span id="cb3-484"><a href="#cb3-484" aria-hidden="true" tabindex="-1"></a>              <span class="st">'case'</span><span class="op">,</span></span>
<span id="cb3-485"><a href="#cb3-485" aria-hidden="true" tabindex="-1"></a>              [<span class="st">'!'</span><span class="op">,</span> [<span class="st">'has'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">dynamicColor</span><span class="op">.</span><span class="at">property</span>]]<span class="op">,</span> <span class="st">'#d9d9d9'</span><span class="op">,</span>                       <span class="co">// Propri√©t√© absente</span></span>
<span id="cb3-486"><a href="#cb3-486" aria-hidden="true" tabindex="-1"></a>              [<span class="st">'any'</span><span class="op">,</span> [<span class="st">'=='</span><span class="op">,</span> [<span class="st">'get'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">dynamicColor</span><span class="op">.</span><span class="at">property</span>]<span class="op">,</span> <span class="kw">null</span>]<span class="op">,</span> [<span class="st">'=='</span><span class="op">,</span> [<span class="st">'get'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">dynamicColor</span><span class="op">.</span><span class="at">property</span>]<span class="op">,</span> <span class="dv">0</span>]]<span class="op">,</span> <span class="st">'#d9d9d9'</span><span class="op">,</span> <span class="co">// null ou 0</span></span>
<span id="cb3-487"><a href="#cb3-487" aria-hidden="true" tabindex="-1"></a>              [<span class="st">'&lt;'</span><span class="op">,</span> [<span class="st">'get'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">dynamicColor</span><span class="op">.</span><span class="at">property</span>]<span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> <span class="st">'#ffffff'</span><span class="op">,</span></span>
<span id="cb3-488"><a href="#cb3-488" aria-hidden="true" tabindex="-1"></a>              [<span class="st">'&lt;'</span><span class="op">,</span> [<span class="st">'get'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">dynamicColor</span><span class="op">.</span><span class="at">property</span>]<span class="op">,</span> <span class="dv">50</span>]<span class="op">,</span> <span class="st">'#ffaaaa'</span><span class="op">,</span></span>
<span id="cb3-489"><a href="#cb3-489" aria-hidden="true" tabindex="-1"></a>              [<span class="st">'&lt;'</span><span class="op">,</span> [<span class="st">'get'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">dynamicColor</span><span class="op">.</span><span class="at">property</span>]<span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> <span class="st">'#ff5555'</span><span class="op">,</span></span>
<span id="cb3-490"><a href="#cb3-490" aria-hidden="true" tabindex="-1"></a>              [<span class="st">'&gt;='</span><span class="op">,</span> [<span class="st">'get'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">dynamicColor</span><span class="op">.</span><span class="at">property</span>]<span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> <span class="st">'#ff0000'</span><span class="op">,</span></span>
<span id="cb3-491"><a href="#cb3-491" aria-hidden="true" tabindex="-1"></a>              <span class="st">'#d9d9d9'</span> <span class="co">// fallback</span></span>
<span id="cb3-492"><a href="#cb3-492" aria-hidden="true" tabindex="-1"></a>            ]<span class="op">;</span></span>
<span id="cb3-493"><a href="#cb3-493" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb3-494"><a href="#cb3-494" aria-hidden="true" tabindex="-1"></a>            layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-color'</span>] <span class="op">=</span> layer<span class="op">.</span><span class="at">color</span> <span class="op">||</span> <span class="st">'#000000'</span><span class="op">;</span></span>
<span id="cb3-495"><a href="#cb3-495" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb3-496"><a href="#cb3-496" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-497"><a href="#cb3-497" aria-hidden="true" tabindex="-1"></a>          layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-opacity'</span>] <span class="op">=</span> layer<span class="op">.</span><span class="at">opacity</span> <span class="op">||</span> <span class="fl">0.4</span><span class="op">;</span></span>
<span id="cb3-498"><a href="#cb3-498" aria-hidden="true" tabindex="-1"></a>          layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-outline-color'</span>] <span class="op">=</span> <span class="st">'#000000'</span><span class="op">;</span></span>
<span id="cb3-499"><a href="#cb3-499" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-500"><a href="#cb3-500" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (layer<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">'line'</span>) {</span>
<span id="cb3-501"><a href="#cb3-501" aria-hidden="true" tabindex="-1"></a>          layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'line-color'</span>] <span class="op">=</span> layer<span class="op">.</span><span class="at">color</span> <span class="op">||</span> <span class="st">'#000000'</span><span class="op">;</span></span>
<span id="cb3-502"><a href="#cb3-502" aria-hidden="true" tabindex="-1"></a>          layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'line-width'</span>] <span class="op">=</span> layer<span class="op">.</span><span class="at">width</span> <span class="op">||</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-503"><a href="#cb3-503" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (layer<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">'fill-extrusion'</span>) {</span>
<span id="cb3-504"><a href="#cb3-504" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (layer<span class="op">.</span><span class="at">colorByType</span> <span class="op">===</span> <span class="st">'ff_dteloctxt'</span>) {</span>
<span id="cb3-505"><a href="#cb3-505" aria-hidden="true" tabindex="-1"></a>            layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-extrusion-color'</span>] <span class="op">=</span> [</span>
<span id="cb3-506"><a href="#cb3-506" aria-hidden="true" tabindex="-1"></a>              <span class="st">'match'</span><span class="op">,</span></span>
<span id="cb3-507"><a href="#cb3-507" aria-hidden="true" tabindex="-1"></a>              [<span class="st">'get'</span><span class="op">,</span> <span class="st">'ff_dteloctxt'</span>]<span class="op">,</span></span>
<span id="cb3-508"><a href="#cb3-508" aria-hidden="true" tabindex="-1"></a>              <span class="st">'ACTIVITE'</span><span class="op">,</span> <span class="st">'#1f77b4'</span><span class="op">,</span></span>
<span id="cb3-509"><a href="#cb3-509" aria-hidden="true" tabindex="-1"></a>              <span class="st">'APPARTEMENT'</span><span class="op">,</span> <span class="st">'#2ca02c'</span><span class="op">,</span></span>
<span id="cb3-510"><a href="#cb3-510" aria-hidden="true" tabindex="-1"></a>              <span class="st">'AUCUN LOCAL'</span><span class="op">,</span> <span class="st">'#d9d9d9'</span><span class="op">,</span></span>
<span id="cb3-511"><a href="#cb3-511" aria-hidden="true" tabindex="-1"></a>              <span class="st">'DEPENDANCE'</span><span class="op">,</span> <span class="st">'#9467bd'</span><span class="op">,</span></span>
<span id="cb3-512"><a href="#cb3-512" aria-hidden="true" tabindex="-1"></a>              <span class="st">'MAISON'</span><span class="op">,</span> <span class="st">'#ff7f0e'</span><span class="op">,</span></span>
<span id="cb3-513"><a href="#cb3-513" aria-hidden="true" tabindex="-1"></a>              <span class="st">'MIXTE'</span><span class="op">,</span> <span class="st">'#e377c2'</span><span class="op">,</span></span>
<span id="cb3-514"><a href="#cb3-514" aria-hidden="true" tabindex="-1"></a>              <span class="st">'#000000'</span> <span class="co">// fallback</span></span>
<span id="cb3-515"><a href="#cb3-515" aria-hidden="true" tabindex="-1"></a>            ]<span class="op">;</span></span>
<span id="cb3-516"><a href="#cb3-516" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb3-517"><a href="#cb3-517" aria-hidden="true" tabindex="-1"></a>            layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-extrusion-color'</span>] <span class="op">=</span> layer<span class="op">.</span><span class="at">color</span> <span class="op">||</span> <span class="st">'#000000'</span><span class="op">;</span></span>
<span id="cb3-518"><a href="#cb3-518" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb3-519"><a href="#cb3-519" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-520"><a href="#cb3-520" aria-hidden="true" tabindex="-1"></a>          layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-extrusion-height'</span>] <span class="op">=</span> [<span class="st">'get'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">heightProperty</span> <span class="op">||</span> <span class="st">'hauteur'</span>]<span class="op">;</span></span>
<span id="cb3-521"><a href="#cb3-521" aria-hidden="true" tabindex="-1"></a>          layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-extrusion-base'</span>] <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-522"><a href="#cb3-522" aria-hidden="true" tabindex="-1"></a>          layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-extrusion-opacity'</span>] <span class="op">=</span> layer<span class="op">.</span><span class="at">opacity</span> <span class="op">||</span> <span class="fl">0.9</span><span class="op">;</span></span>
<span id="cb3-523"><a href="#cb3-523" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-524"><a href="#cb3-524" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-525"><a href="#cb3-525" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">addLayer</span>(layerConfig)<span class="op">;</span></span>
<span id="cb3-526"><a href="#cb3-526" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-527"><a href="#cb3-527" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">addLayer</span>({</span>
<span id="cb3-528"><a href="#cb3-528" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">id</span><span class="op">:</span> <span class="st">'indicateurs12aLabels'</span><span class="op">,</span></span>
<span id="cb3-529"><a href="#cb3-529" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">type</span><span class="op">:</span> <span class="st">'symbol'</span><span class="op">,</span></span>
<span id="cb3-530"><a href="#cb3-530" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">source</span><span class="op">:</span> <span class="st">'indicateurs12aLayer'</span><span class="op">,</span> <span class="co">// le m√™me id que ta source GeoJSON</span></span>
<span id="cb3-531"><a href="#cb3-531" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">layout</span><span class="op">:</span> {</span>
<span id="cb3-532"><a href="#cb3-532" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-field'</span><span class="op">:</span> [<span class="st">'get'</span><span class="op">,</span> <span class="st">'nom'</span>]<span class="op">,</span></span>
<span id="cb3-533"><a href="#cb3-533" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-size'</span><span class="op">:</span> <span class="dv">11</span><span class="op">,</span></span>
<span id="cb3-534"><a href="#cb3-534" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-font'</span><span class="op">:</span> [<span class="st">'Open Sans Bold'</span><span class="op">,</span> <span class="st">'Arial Unicode MS Bold'</span>]<span class="op">,</span></span>
<span id="cb3-535"><a href="#cb3-535" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-offset'</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="fl">0.6</span>]<span class="op">,</span></span>
<span id="cb3-536"><a href="#cb3-536" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-anchor'</span><span class="op">:</span> <span class="st">'top'</span></span>
<span id="cb3-537"><a href="#cb3-537" aria-hidden="true" tabindex="-1"></a>                  }<span class="op">,</span></span>
<span id="cb3-538"><a href="#cb3-538" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">paint</span><span class="op">:</span> {</span>
<span id="cb3-539"><a href="#cb3-539" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-color'</span><span class="op">:</span> <span class="st">'#000000'</span><span class="op">,</span></span>
<span id="cb3-540"><a href="#cb3-540" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-halo-color'</span><span class="op">:</span> <span class="st">'#ffffff'</span><span class="op">,</span></span>
<span id="cb3-541"><a href="#cb3-541" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-halo-width'</span><span class="op">:</span> <span class="dv">1</span></span>
<span id="cb3-542"><a href="#cb3-542" aria-hidden="true" tabindex="-1"></a>                  }</span>
<span id="cb3-543"><a href="#cb3-543" aria-hidden="true" tabindex="-1"></a>                })<span class="op">;</span></span>
<span id="cb3-544"><a href="#cb3-544" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-545"><a href="#cb3-545" aria-hidden="true" tabindex="-1"></a>                map<span class="op">.</span><span class="fu">addLayer</span>({</span>
<span id="cb3-546"><a href="#cb3-546" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">id</span><span class="op">:</span> <span class="st">'indicateurs12aLabels'</span><span class="op">,</span></span>
<span id="cb3-547"><a href="#cb3-547" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">type</span><span class="op">:</span> <span class="st">'symbol'</span><span class="op">,</span></span>
<span id="cb3-548"><a href="#cb3-548" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">source</span><span class="op">:</span> <span class="st">'indicateurs12aLayer'</span><span class="op">,</span> <span class="co">// le m√™me id que ta source GeoJSON</span></span>
<span id="cb3-549"><a href="#cb3-549" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">layout</span><span class="op">:</span> {</span>
<span id="cb3-550"><a href="#cb3-550" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-field'</span><span class="op">:</span> [<span class="st">'get'</span><span class="op">,</span> <span class="st">'nom'</span>]<span class="op">,</span></span>
<span id="cb3-551"><a href="#cb3-551" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-size'</span><span class="op">:</span> <span class="dv">11</span><span class="op">,</span></span>
<span id="cb3-552"><a href="#cb3-552" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-font'</span><span class="op">:</span> [<span class="st">'Open Sans Bold'</span><span class="op">,</span> <span class="st">'Arial Unicode MS Bold'</span>]<span class="op">,</span></span>
<span id="cb3-553"><a href="#cb3-553" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-offset'</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="fl">0.6</span>]<span class="op">,</span></span>
<span id="cb3-554"><a href="#cb3-554" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-anchor'</span><span class="op">:</span> <span class="st">'top'</span></span>
<span id="cb3-555"><a href="#cb3-555" aria-hidden="true" tabindex="-1"></a>                  }<span class="op">,</span></span>
<span id="cb3-556"><a href="#cb3-556" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">paint</span><span class="op">:</span> {</span>
<span id="cb3-557"><a href="#cb3-557" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-color'</span><span class="op">:</span> <span class="st">'#000000'</span><span class="op">,</span></span>
<span id="cb3-558"><a href="#cb3-558" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-halo-color'</span><span class="op">:</span> <span class="st">'#ffffff'</span><span class="op">,</span></span>
<span id="cb3-559"><a href="#cb3-559" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-halo-width'</span><span class="op">:</span> <span class="dv">1</span></span>
<span id="cb3-560"><a href="#cb3-560" aria-hidden="true" tabindex="-1"></a>                  }</span>
<span id="cb3-561"><a href="#cb3-561" aria-hidden="true" tabindex="-1"></a>                })<span class="op">;</span></span>
<span id="cb3-562"><a href="#cb3-562" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-563"><a href="#cb3-563" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">addLayer</span>({</span>
<span id="cb3-564"><a href="#cb3-564" aria-hidden="true" tabindex="-1"></a>                 <span class="dt">id</span><span class="op">:</span> <span class="st">'indicateurs12a-hover'</span><span class="op">,</span></span>
<span id="cb3-565"><a href="#cb3-565" aria-hidden="true" tabindex="-1"></a>                 <span class="dt">type</span><span class="op">:</span> <span class="st">'line'</span><span class="op">,</span></span>
<span id="cb3-566"><a href="#cb3-566" aria-hidden="true" tabindex="-1"></a>                 <span class="dt">source</span><span class="op">:</span> <span class="st">'indicateurs12aLayer'</span><span class="op">,</span> <span class="co">// m√™me source</span></span>
<span id="cb3-567"><a href="#cb3-567" aria-hidden="true" tabindex="-1"></a>                 <span class="dt">paint</span><span class="op">:</span> {</span>
<span id="cb3-568"><a href="#cb3-568" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'line-color'</span><span class="op">:</span> <span class="st">'#000'</span><span class="op">,</span></span>
<span id="cb3-569"><a href="#cb3-569" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'line-width'</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb3-570"><a href="#cb3-570" aria-hidden="true" tabindex="-1"></a>                  }<span class="op">,</span></span>
<span id="cb3-571"><a href="#cb3-571" aria-hidden="true" tabindex="-1"></a>                 <span class="dt">filter</span><span class="op">:</span> [<span class="st">'=='</span><span class="op">,</span> <span class="st">'nom'</span><span class="op">,</span> <span class="st">''</span>] <span class="co">// vide au d√©but</span></span>
<span id="cb3-572"><a href="#cb3-572" aria-hidden="true" tabindex="-1"></a>                  })<span class="op">;</span></span>
<span id="cb3-573"><a href="#cb3-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-574"><a href="#cb3-574" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-575"><a href="#cb3-575" aria-hidden="true" tabindex="-1"></a>      map<span class="op">.</span><span class="fu">on</span>(<span class="st">'click'</span><span class="op">,</span> <span class="st">'indicateurs12aLayer'</span><span class="op">,</span> (e) <span class="kw">=&gt;</span> {</span>
<span id="cb3-576"><a href="#cb3-576" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> feature <span class="op">=</span> e<span class="op">.</span><span class="at">features</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb3-577"><a href="#cb3-577" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> image<span class="op">=</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">image</span><span class="op">;</span></span>
<span id="cb3-578"><a href="#cb3-578" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> nom <span class="op">=</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nom</span> <span class="op">||</span> <span class="st">'Non disponible'</span><span class="op">;</span></span>
<span id="cb3-579"><a href="#cb3-579" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-580"><a href="#cb3-580" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> population <span class="op">=</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">population</span></span>
<span id="cb3-581"><a href="#cb3-581" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">population</span><span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>) <span class="op">+</span> <span class="st">' habitants'</span></span>
<span id="cb3-582"><a href="#cb3-582" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> <span class="st">'Non disponible'</span><span class="op">;</span></span>
<span id="cb3-583"><a href="#cb3-583" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-584"><a href="#cb3-584" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> s12aValue <span class="op">=</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">s12a</span> <span class="op">||</span> <span class="st">'0'</span><span class="op">;</span></span>
<span id="cb3-585"><a href="#cb3-585" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> dommages <span class="op">=</span> (<span class="bu">Number</span>(s12aValue) <span class="op">||</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-586"><a href="#cb3-586" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batimentsValue <span class="op">=</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_batiments</span><span class="op">;</span></span>
<span id="cb3-587"><a href="#cb3-587" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batiments <span class="op">=</span> <span class="op">!</span><span class="pp">isNaN</span>(<span class="pp">parseFloat</span>(batimentsValue))</span>
<span id="cb3-588"><a href="#cb3-588" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="pp">parseInt</span>(batimentsValue)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)</span>
<span id="cb3-589"><a href="#cb3-589" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="st">'Non disponible'</span><span class="op">;</span></span>
<span id="cb3-590"><a href="#cb3-590" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batindif <span class="op">=</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_indif</span><span class="op">?.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-591"><a href="#cb3-591" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batsportifValue <span class="op">=</span> <span class="pp">parseFloat</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_sportif</span>)<span class="op">;</span></span>
<span id="cb3-592"><a href="#cb3-592" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batsportif <span class="op">=</span> (<span class="op">!</span><span class="pp">isNaN</span>(batsportifValue) <span class="op">?</span> batsportifValue <span class="op">:</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-593"><a href="#cb3-593" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batagricolefValue <span class="op">=</span> <span class="pp">parseFloat</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_agricole</span>)<span class="op">;</span></span>
<span id="cb3-594"><a href="#cb3-594" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batagricole <span class="op">=</span> (<span class="op">!</span><span class="pp">isNaN</span>(batagricolefValue) <span class="op">?</span> batagricolefValue <span class="op">:</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-595"><a href="#cb3-595" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batresidentielValue <span class="op">=</span> <span class="pp">parseFloat</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_residentiel</span>)<span class="op">;</span></span>
<span id="cb3-596"><a href="#cb3-596" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batresidentiel <span class="op">=</span> (<span class="op">!</span><span class="pp">isNaN</span>(batresidentielValue) <span class="op">?</span> batresidentielValue <span class="op">:</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-597"><a href="#cb3-597" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batannexeValue <span class="op">=</span> <span class="pp">parseFloat</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_annexe</span>)<span class="op">;</span></span>
<span id="cb3-598"><a href="#cb3-598" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batannexe <span class="op">=</span> (<span class="op">!</span><span class="pp">isNaN</span>(batannexeValue) <span class="op">?</span> batannexeValue <span class="op">:</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-599"><a href="#cb3-599" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batreligieuxValue <span class="op">=</span> <span class="pp">parseFloat</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_religieux</span>)<span class="op">;</span></span>
<span id="cb3-600"><a href="#cb3-600" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batreligieux <span class="op">=</span> (<span class="op">!</span><span class="pp">isNaN</span>(batreligieuxValue) <span class="op">?</span> batreligieuxValue <span class="op">:</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-601"><a href="#cb3-601" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batindustrielValue <span class="op">=</span> <span class="pp">parseFloat</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_industriel</span>)<span class="op">;</span></span>
<span id="cb3-602"><a href="#cb3-602" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batindustriel <span class="op">=</span> (<span class="op">!</span><span class="pp">isNaN</span>(batindustrielValue) <span class="op">?</span> batindustrielValue <span class="op">:</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-603"><a href="#cb3-603" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batcommercialValue <span class="op">=</span> <span class="pp">parseFloat</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_commercial</span>)<span class="op">;</span></span>
<span id="cb3-604"><a href="#cb3-604" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batcommercial <span class="op">=</span> (<span class="op">!</span><span class="pp">isNaN</span>(batcommercialValue) <span class="op">?</span> batcommercialValue <span class="op">:</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-605"><a href="#cb3-605" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-606"><a href="#cb3-606" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> popupContent <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb3-607"><a href="#cb3-607" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;style&gt;</span></span>
<span id="cb3-608"><a href="#cb3-608" aria-hidden="true" tabindex="-1"></a><span class="vs">          .maplibregl-popup-content {</span></span>
<span id="cb3-609"><a href="#cb3-609" aria-hidden="true" tabindex="-1"></a><span class="vs">            padding: 4px !important;</span></span>
<span id="cb3-610"><a href="#cb3-610" aria-hidden="true" tabindex="-1"></a><span class="vs">            border: 1px solid;</span></span>
<span id="cb3-611"><a href="#cb3-611" aria-hidden="true" tabindex="-1"></a><span class="vs">            border-radius: 8px;</span></span>
<span id="cb3-612"><a href="#cb3-612" aria-hidden="true" tabindex="-1"></a><span class="vs">            width: 270px;</span></span>
<span id="cb3-613"><a href="#cb3-613" aria-hidden="true" tabindex="-1"></a><span class="vs">            box-shadow: rgba(101, 147, 220, 0.2) 0px 4px 8px 0px;</span></span>
<span id="cb3-614"><a href="#cb3-614" aria-hidden="true" tabindex="-1"></a><span class="vs">            border-color: rgba(101, 147, 220, 0.5);</span></span>
<span id="cb3-615"><a href="#cb3-615" aria-hidden="true" tabindex="-1"></a><span class="vs">          }</span></span>
<span id="cb3-616"><a href="#cb3-616" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;/style&gt;</span></span>
<span id="cb3-617"><a href="#cb3-617" aria-hidden="true" tabindex="-1"></a><span class="vs">           &lt;div style="font-family: sans-serif; font-size: 13px; margin:10px;"&gt;</span></span>
<span id="cb3-618"><a href="#cb3-618" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div style="background-color: #d1ee9c; border: 1px solid; border-radius:8px; margin-bottom:16px; padding:10px;"&gt;&lt;strong&gt;</span></span>
<span id="cb3-619"><a href="#cb3-619" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;center&gt;</span><span class="sc">${</span>nom<span class="sc">}</span><span class="vs">&lt;/center&gt;</span></span>
<span id="cb3-620"><a href="#cb3-620" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;/strong&gt;&lt;/div&gt;</span></span>
<span id="cb3-621"><a href="#cb3-621" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;p style="text-align:center !important"&gt;&lt;strong&gt;- Population :&lt;/strong&gt; </span><span class="sc">${</span>population<span class="sc">}</span><span class="vs">&lt;/p&gt;</span></span>
<span id="cb3-622"><a href="#cb3-622" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;p style="text-align:center !important"&gt;&lt;strong&gt;- Nombre de personnes en zone fortement inondable :&lt;/strong&gt; </span><span class="sc">${</span>dommages<span class="sc">}</span><span class="vs">&lt;/p&gt;</span></span>
<span id="cb3-623"><a href="#cb3-623" aria-hidden="true" tabindex="-1"></a><span class="vs">        `</span><span class="op">;</span></span>
<span id="cb3-624"><a href="#cb3-624" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-625"><a href="#cb3-625" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span> maplibregl<span class="op">.</span><span class="fu">Popup</span>({<span class="dt">closeButton</span><span class="op">:</span> <span class="kw">false</span>})</span>
<span id="cb3-626"><a href="#cb3-626" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">setLngLat</span>(e<span class="op">.</span><span class="at">lngLat</span>)</span>
<span id="cb3-627"><a href="#cb3-627" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">setHTML</span>(popupContent)</span>
<span id="cb3-628"><a href="#cb3-628" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb3-629"><a href="#cb3-629" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb3-630"><a href="#cb3-630" aria-hidden="true" tabindex="-1"></a>          <span class="co">// Mettre √† jour le conteneur HTML avec les informations sp√©cifiques du marqueur </span></span>
<span id="cb3-631"><a href="#cb3-631" aria-hidden="true" tabindex="-1"></a>         <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">'donnees'</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb3-632"><a href="#cb3-632" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div style="text-align:center; font-family:sans-serif; font-size:16px;"&gt;</span></span>
<span id="cb3-633"><a href="#cb3-633" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;img src="</span><span class="sc">${</span>image<span class="sc">}</span><span class="vs">" style="width:300px; margin-bottom:10px;"&gt;&lt;br&gt;</span></span>
<span id="cb3-634"><a href="#cb3-634" aria-hidden="true" tabindex="-1"></a><span class="vs">            </span></span>
<span id="cb3-635"><a href="#cb3-635" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;strong style="font-size:1.1em;"&gt;&lt;i class="bi bi-geo-alt-fill"&gt;&lt;/i&gt; Commune :&lt;/strong&gt; </span><span class="sc">${</span>nom<span class="sc">}</span><span class="vs">&lt;br&gt;</span></span>
<span id="cb3-636"><a href="#cb3-636" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;strong style="font-size:1.1em;"&gt;&lt;i class="bi bi-people-fill"&gt;&lt;/i&gt; Nombre d'habitants :&lt;/strong&gt; </span><span class="sc">${</span>population<span class="sc">}</span><span class="vs">&lt;br&gt;</span></span>
<span id="cb3-637"><a href="#cb3-637" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;strong style="font-size:1.1em;"&gt;&lt;i class="bi bi-house-fill"&gt;&lt;/i&gt; Nombre de b√¢timents :&lt;/strong&gt; </span><span class="sc">${</span>batiments<span class="sc">}</span><span class="vs">&lt;br&gt;</span></span>
<span id="cb3-638"><a href="#cb3-638" aria-hidden="true" tabindex="-1"></a><span class="vs">            </span></span>
<span id="cb3-639"><a href="#cb3-639" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;div style="margin-top:10px;"&gt;&lt;strong&gt;Dont :&lt;/strong&gt;&lt;/div&gt;</span></span>
<span id="cb3-640"><a href="#cb3-640" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;ul style="list-style:none; padding:0;"&gt;</span></span>
<span id="cb3-641"><a href="#cb3-641" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batindif<span class="sc">}</span><span class="vs"> &lt;strong&gt;b√¢timents indiff√©renci√©s&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-642"><a href="#cb3-642" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batsportif<span class="sc">}</span><span class="vs"> &lt;strong&gt;b√¢timents sportifs&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-643"><a href="#cb3-643" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batagricole<span class="sc">}</span><span class="vs"> &lt;strong&gt;b√¢timents agricoles&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-644"><a href="#cb3-644" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batresidentiel<span class="sc">}</span><span class="vs"> &lt;strong&gt;b√¢timents r√©sidentiels&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-645"><a href="#cb3-645" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batannexe<span class="sc">}</span><span class="vs"> &lt;strong&gt;b√¢timents annexes&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-646"><a href="#cb3-646" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batreligieux<span class="sc">}</span><span class="vs"> &lt;strong&gt;b√¢timents religieux&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-647"><a href="#cb3-647" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batindustriel<span class="sc">}</span><span class="vs"> &lt;strong&gt;b√¢timents industriels&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-648"><a href="#cb3-648" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batcommercial<span class="sc">}</span><span class="vs"> &lt;strong&gt;b√¢timents commerciaux&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-649"><a href="#cb3-649" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;/ul&gt;</span></span>
<span id="cb3-650"><a href="#cb3-650" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span></span>
<span id="cb3-651"><a href="#cb3-651" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;div style="margin-top:10px;"&gt;</span></span>
<span id="cb3-652"><a href="#cb3-652" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;strong style="font-size:1.1em;"&gt;&lt;i class="bi bi-droplet-half"&gt;&lt;/i&gt; Nombre de personnes en zone fortement inondable :&lt;/strong&gt; </span><span class="sc">${</span>dommages<span class="sc">}</span></span>
<span id="cb3-653"><a href="#cb3-653" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;/div&gt;</span></span>
<span id="cb3-654"><a href="#cb3-654" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;/div&gt;</span></span>
<span id="cb3-655"><a href="#cb3-655" aria-hidden="true" tabindex="-1"></a><span class="vs">         `</span><span class="op">;</span></span>
<span id="cb3-656"><a href="#cb3-656" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb3-657"><a href="#cb3-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-658"><a href="#cb3-658" aria-hidden="true" tabindex="-1"></a>      map<span class="op">.</span><span class="fu">on</span>(<span class="st">'mousemove'</span><span class="op">,</span> <span class="st">'indicateurs12aLayer'</span><span class="op">,</span> (e) <span class="kw">=&gt;</span> {</span>
<span id="cb3-659"><a href="#cb3-659" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (e<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-660"><a href="#cb3-660" aria-hidden="true" tabindex="-1"></a>          <span class="kw">const</span> nomCommune <span class="op">=</span> e<span class="op">.</span><span class="at">features</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nom</span><span class="op">;</span></span>
<span id="cb3-661"><a href="#cb3-661" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-662"><a href="#cb3-662" aria-hidden="true" tabindex="-1"></a>          map<span class="op">.</span><span class="fu">setFilter</span>(<span class="st">'indicateurs12a-hover'</span><span class="op">,</span> [<span class="st">'=='</span><span class="op">,</span> <span class="st">'nom'</span><span class="op">,</span> nomCommune])<span class="op">;</span></span>
<span id="cb3-663"><a href="#cb3-663" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-664"><a href="#cb3-664" aria-hidden="true" tabindex="-1"></a>          map<span class="op">.</span><span class="fu">getCanvas</span>()<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">cursor</span> <span class="op">=</span> <span class="st">'pointer'</span><span class="op">;</span></span>
<span id="cb3-665"><a href="#cb3-665" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-666"><a href="#cb3-666" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb3-667"><a href="#cb3-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-668"><a href="#cb3-668" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">on</span>(<span class="st">'mouseleave'</span><span class="op">,</span> <span class="st">'indicateurs12aLayer'</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb3-669"><a href="#cb3-669" aria-hidden="true" tabindex="-1"></a>          map<span class="op">.</span><span class="fu">setFilter</span>(<span class="st">'indicateurs12a-hover'</span><span class="op">,</span> [<span class="st">'=='</span><span class="op">,</span> <span class="st">'nom'</span><span class="op">,</span> <span class="st">''</span>])<span class="op">;</span></span>
<span id="cb3-670"><a href="#cb3-670" aria-hidden="true" tabindex="-1"></a>          map<span class="op">.</span><span class="fu">getCanvas</span>()<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">cursor</span> <span class="op">=</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb3-671"><a href="#cb3-671" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb3-672"><a href="#cb3-672" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb3-673"><a href="#cb3-673" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-674"><a href="#cb3-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-675"><a href="#cb3-675" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Interface de contr√¥le des couches</span></span>
<span id="cb3-676"><a href="#cb3-676" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> mapLayersDiv <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb3-677"><a href="#cb3-677" aria-hidden="true" tabindex="-1"></a>    mapLayersDiv<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">add</span>(<span class="st">'mapLayers'</span>)<span class="op">;</span></span>
<span id="cb3-678"><a href="#cb3-678" aria-hidden="true" tabindex="-1"></a>    mapLayersDiv<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">position</span> <span class="op">=</span> <span class="st">'absolute'</span><span class="op">;</span></span>
<span id="cb3-679"><a href="#cb3-679" aria-hidden="true" tabindex="-1"></a>    mapLayersDiv<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">zIndex</span> <span class="op">=</span> <span class="st">'1000'</span><span class="op">;</span></span>
<span id="cb3-680"><a href="#cb3-680" aria-hidden="true" tabindex="-1"></a>    mapLayersDiv<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb3-681"><a href="#cb3-681" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;button id="toggleMapMenuButton" class="btn btn-light aria-label="Afficher les couches" title="Afficher les couches"&gt;</span></span>
<span id="cb3-682"><a href="#cb3-682" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;img src="Images/icons/layers-half.svg" alt="Ic√¥ne SVG" width="25" height="25"&gt;</span></span>
<span id="cb3-683"><a href="#cb3-683" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/button&gt;</span></span>
<span id="cb3-684"><a href="#cb3-684" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;div id="layersList" style="display: none; background: white; padding: 10px; border: 1px solid #ccc;"&gt;&lt;/div&gt;</span></span>
<span id="cb3-685"><a href="#cb3-685" aria-hidden="true" tabindex="-1"></a><span class="vs">    `</span><span class="op">;</span></span>
<span id="cb3-686"><a href="#cb3-686" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">getContainer</span>()<span class="op">.</span><span class="fu">appendChild</span>(mapLayersDiv)<span class="op">;</span></span>
<span id="cb3-687"><a href="#cb3-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-688"><a href="#cb3-688" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> toggleableLayerIds <span class="op">=</span> layersData<span class="op">.</span><span class="fu">map</span>(layer <span class="kw">=&gt;</span> layer<span class="op">.</span><span class="at">id</span>)<span class="op">;</span></span>
<span id="cb3-689"><a href="#cb3-689" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> aliasLayerIds <span class="op">=</span> {</span>
<span id="cb3-690"><a href="#cb3-690" aria-hidden="true" tabindex="-1"></a>      <span class="dt">bassinvienneLayer</span><span class="op">:</span> <span class="st">'Bassin de la Vienne'</span><span class="op">,</span></span>
<span id="cb3-691"><a href="#cb3-691" aria-hidden="true" tabindex="-1"></a>      <span class="dt">regionLayer</span><span class="op">:</span> <span class="st">'R√©gion'</span><span class="op">,</span></span>
<span id="cb3-692"><a href="#cb3-692" aria-hidden="true" tabindex="-1"></a>      <span class="dt">departementLayer</span><span class="op">:</span> <span class="st">'D√©partement'</span><span class="op">,</span></span>
<span id="cb3-693"><a href="#cb3-693" aria-hidden="true" tabindex="-1"></a>      <span class="dt">epciLayer</span><span class="op">:</span> <span class="st">'EPCI'</span><span class="op">,</span></span>
<span id="cb3-694"><a href="#cb3-694" aria-hidden="true" tabindex="-1"></a>      <span class="dt">zoneinondableLayer</span><span class="op">:</span> <span class="st">'Zonage Inondable'</span><span class="op">,</span></span>
<span id="cb3-695"><a href="#cb3-695" aria-hidden="true" tabindex="-1"></a>      <span class="dt">coursdeauLayer</span><span class="op">:</span> <span class="st">"Cours d'eau"</span><span class="op">,</span></span>
<span id="cb3-696"><a href="#cb3-696" aria-hidden="true" tabindex="-1"></a>      <span class="dt">indicateurs12aLayer</span><span class="op">:</span> <span class="st">'B√¢timents de plain-pied'</span><span class="op">,</span></span>
<span id="cb3-697"><a href="#cb3-697" aria-hidden="true" tabindex="-1"></a>      <span class="dt">batimentsLayer</span><span class="op">:</span> <span class="st">"B√¢timents"</span></span>
<span id="cb3-698"><a href="#cb3-698" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb3-699"><a href="#cb3-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-700"><a href="#cb3-700" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">toggleLayerVisibility</span>(id<span class="op">,</span> visible) {</span>
<span id="cb3-701"><a href="#cb3-701" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> visibility <span class="op">=</span> visible <span class="op">?</span> <span class="st">'visible'</span> <span class="op">:</span> <span class="st">'none'</span><span class="op">;</span></span>
<span id="cb3-702"><a href="#cb3-702" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (map<span class="op">.</span><span class="fu">getLayer</span>(id)) {</span>
<span id="cb3-703"><a href="#cb3-703" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">setLayoutProperty</span>(id<span class="op">,</span> <span class="st">'visibility'</span><span class="op">,</span> visibility)<span class="op">;</span></span>
<span id="cb3-704"><a href="#cb3-704" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-705"><a href="#cb3-705" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-706"><a href="#cb3-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-707"><a href="#cb3-707" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> layersListDiv <span class="op">=</span> mapLayersDiv<span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'#layersList'</span>)<span class="op">;</span></span>
<span id="cb3-708"><a href="#cb3-708" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-709"><a href="#cb3-709" aria-hidden="true" tabindex="-1"></a>    toggleableLayerIds<span class="op">.</span><span class="fu">forEach</span>(id <span class="kw">=&gt;</span> {</span>
<span id="cb3-710"><a href="#cb3-710" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> name <span class="op">=</span> aliasLayerIds[id] <span class="op">||</span> id<span class="op">;</span></span>
<span id="cb3-711"><a href="#cb3-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-712"><a href="#cb3-712" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> checkbox <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'input'</span>)<span class="op">;</span></span>
<span id="cb3-713"><a href="#cb3-713" aria-hidden="true" tabindex="-1"></a>      checkbox<span class="op">.</span><span class="at">type</span> <span class="op">=</span> <span class="st">'checkbox'</span><span class="op">;</span></span>
<span id="cb3-714"><a href="#cb3-714" aria-hidden="true" tabindex="-1"></a>      checkbox<span class="op">.</span><span class="at">id</span> <span class="op">=</span> id<span class="op">;</span></span>
<span id="cb3-715"><a href="#cb3-715" aria-hidden="true" tabindex="-1"></a>      checkbox<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">'form-check-input'</span><span class="op">;</span></span>
<span id="cb3-716"><a href="#cb3-716" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-717"><a href="#cb3-717" aria-hidden="true" tabindex="-1"></a>      <span class="co">// ‚úÖ Lire la visibilit√© actuelle directement dans la carte</span></span>
<span id="cb3-718"><a href="#cb3-718" aria-hidden="true" tabindex="-1"></a>      map<span class="op">.</span><span class="fu">once</span>(<span class="st">'idle'</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb3-719"><a href="#cb3-719" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> visibility <span class="op">=</span> map<span class="op">.</span><span class="fu">getLayoutProperty</span>(id<span class="op">,</span> <span class="st">'visibility'</span>)<span class="op">;</span></span>
<span id="cb3-720"><a href="#cb3-720" aria-hidden="true" tabindex="-1"></a>        checkbox<span class="op">.</span><span class="at">checked</span> <span class="op">=</span> visibility <span class="op">===</span> <span class="st">'visible'</span><span class="op">;</span></span>
<span id="cb3-721"><a href="#cb3-721" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb3-722"><a href="#cb3-722" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-723"><a href="#cb3-723" aria-hidden="true" tabindex="-1"></a>      checkbox<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">'change'</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="fu">toggleLayerVisibility</span>(id<span class="op">,</span> checkbox<span class="op">.</span><span class="at">checked</span>))<span class="op">;</span></span>
<span id="cb3-724"><a href="#cb3-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-725"><a href="#cb3-725" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> label <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'label'</span>)<span class="op">;</span></span>
<span id="cb3-726"><a href="#cb3-726" aria-hidden="true" tabindex="-1"></a>      label<span class="op">.</span><span class="at">htmlFor</span> <span class="op">=</span> id<span class="op">;</span></span>
<span id="cb3-727"><a href="#cb3-727" aria-hidden="true" tabindex="-1"></a>      label<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">'form-check-label'</span><span class="op">;</span></span>
<span id="cb3-728"><a href="#cb3-728" aria-hidden="true" tabindex="-1"></a>      label<span class="op">.</span><span class="at">innerText</span> <span class="op">=</span> name<span class="op">;</span></span>
<span id="cb3-729"><a href="#cb3-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-730"><a href="#cb3-730" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> wrapper <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb3-731"><a href="#cb3-731" aria-hidden="true" tabindex="-1"></a>      wrapper<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">'form-check'</span><span class="op">;</span></span>
<span id="cb3-732"><a href="#cb3-732" aria-hidden="true" tabindex="-1"></a>      wrapper<span class="op">.</span><span class="fu">appendChild</span>(checkbox)<span class="op">;</span></span>
<span id="cb3-733"><a href="#cb3-733" aria-hidden="true" tabindex="-1"></a>      wrapper<span class="op">.</span><span class="fu">appendChild</span>(label)<span class="op">;</span></span>
<span id="cb3-734"><a href="#cb3-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-735"><a href="#cb3-735" aria-hidden="true" tabindex="-1"></a>      layersListDiv<span class="op">.</span><span class="fu">appendChild</span>(wrapper)<span class="op">;</span></span>
<span id="cb3-736"><a href="#cb3-736" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-737"><a href="#cb3-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-738"><a href="#cb3-738" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">'toggleMapMenuButton'</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">'click'</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb3-739"><a href="#cb3-739" aria-hidden="true" tabindex="-1"></a>      layersListDiv<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> layersListDiv<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">===</span> <span class="st">'none'</span> <span class="op">?</span> <span class="st">'block'</span> <span class="op">:</span> <span class="st">'none'</span><span class="op">;</span></span>
<span id="cb3-740"><a href="#cb3-740" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-741"><a href="#cb3-741" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb3-742"><a href="#cb3-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-743"><a href="#cb3-743" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Menu bascule fond de plan</span></span>
<span id="cb3-744"><a href="#cb3-744" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> mapMenuDiv <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb3-745"><a href="#cb3-745" aria-hidden="true" tabindex="-1"></a>    mapMenuDiv<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">add</span>(<span class="st">'mapFondDePlan'</span>)<span class="op">;</span></span>
<span id="cb3-746"><a href="#cb3-746" aria-hidden="true" tabindex="-1"></a>    mapMenuDiv<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">position</span> <span class="op">=</span> <span class="st">'absolute'</span><span class="op">;</span></span>
<span id="cb3-747"><a href="#cb3-747" aria-hidden="true" tabindex="-1"></a>    mapMenuDiv<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">zIndex</span> <span class="op">=</span> <span class="st">'1000'</span><span class="op">;</span></span>
<span id="cb3-748"><a href="#cb3-748" aria-hidden="true" tabindex="-1"></a>    mapMenuDiv<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb3-749"><a href="#cb3-749" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;strong&gt;Fond de plan :&lt;/strong&gt;</span></span>
<span id="cb3-750"><a href="#cb3-750" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;div class="form-check form-switch"&gt;</span></span>
<span id="cb3-751"><a href="#cb3-751" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;input class="form-check-input" type="checkbox" role="switch" id="orthoCheckbox"&gt;</span></span>
<span id="cb3-752"><a href="#cb3-752" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;label class="form-check-label" for="orthoCheckbox"&gt;Photos a√©riennes&lt;/label&gt;</span></span>
<span id="cb3-753"><a href="#cb3-753" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/div&gt;</span></span>
<span id="cb3-754"><a href="#cb3-754" aria-hidden="true" tabindex="-1"></a><span class="vs">    `</span><span class="op">;</span></span>
<span id="cb3-755"><a href="#cb3-755" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">getContainer</span>()<span class="op">.</span><span class="fu">appendChild</span>(mapMenuDiv)<span class="op">;</span></span>
<span id="cb3-756"><a href="#cb3-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-757"><a href="#cb3-757" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">'orthoCheckbox'</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">'change'</span><span class="op">,</span> <span class="kw">function</span> (e) {</span>
<span id="cb3-758"><a href="#cb3-758" aria-hidden="true" tabindex="-1"></a>      e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb3-759"><a href="#cb3-759" aria-hidden="true" tabindex="-1"></a>      e<span class="op">.</span><span class="fu">stopPropagation</span>()<span class="op">;</span></span>
<span id="cb3-760"><a href="#cb3-760" aria-hidden="true" tabindex="-1"></a>      <span class="fu">toggleStyle</span>(<span class="kw">this</span><span class="op">.</span><span class="at">checked</span>)<span class="op">;</span></span>
<span id="cb3-761"><a href="#cb3-761" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-762"><a href="#cb3-762" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb3-763"><a href="#cb3-763" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
        <p></p>
      </div>
      <div id="tab2" class="tab">
        <p>
</p><div class="cell" data-padding="5px" data-expandable="false">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="784" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 783;"><span id="cb4-784"><a href="#cb4-784" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`</span></span>
<span id="cb4-785"><a href="#cb4-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-786"><a href="#cb4-786" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;table style="width:90%; border-collapse: collapse; border:1px solid; text-align:center; margin:auto;"&gt;</span></span>
<span id="cb4-787"><a href="#cb4-787" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;colgroup&gt;</span></span>
<span id="cb4-788"><a href="#cb4-788" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb4-789"><a href="#cb4-789" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb4-790"><a href="#cb4-790" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb4-791"><a href="#cb4-791" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb4-792"><a href="#cb4-792" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb4-793"><a href="#cb4-793" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/colgroup&gt;</span></span>
<span id="cb4-794"><a href="#cb4-794" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-795"><a href="#cb4-795" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:bisque; border:1px solid;" colspan="2"&gt;Num√©ro d'indicateur&lt;/th&gt;</span></span>
<span id="cb4-796"><a href="#cb4-796" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="border:1px solid;"&gt;Ind1/2a&lt;/th&gt;</span></span>
<span id="cb4-797"><a href="#cb4-797" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:bisque; border:1px solid;"&gt;Date de mise √† jour&lt;/th&gt;</span></span>
<span id="cb4-798"><a href="#cb4-798" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="border:1px solid;"&gt;31/05/2025&lt;/th&gt;</span></span>
<span id="cb4-799"><a href="#cb4-799" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-800"><a href="#cb4-800" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-801"><a href="#cb4-801" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:bisque; border:1px solid; font-weight: bold;"&gt;Intitul√©&lt;/td&gt;</span></span>
<span id="cb4-802"><a href="#cb4-802" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;Nombre de personnes occupant des b√¢timents (logements et activit√©s) de plain-pied</span></span>
<span id="cb4-803"><a href="#cb4-803" aria-hidden="true" tabindex="-1"></a><span class="vs">        fortement inondables (plus de 1,5 m d‚Äôeau)&lt;/td&gt;</span></span>
<span id="cb4-804"><a href="#cb4-804" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-805"><a href="#cb4-805" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-806"><a href="#cb4-806" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:bisque; border:1px solid; font-weight: bold;"&gt;Objectif de la SNGRI&lt;/td&gt;</span></span>
<span id="cb4-807"><a href="#cb4-807" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;Objectif n¬∞1 : Augmenter la s√©curit√© des populations expos√©es&lt;/td&gt;</span></span>
<span id="cb4-808"><a href="#cb4-808" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-809"><a href="#cb4-809" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-810"><a href="#cb4-810" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:bisque; border:1px solid; font-weight: bold;"&gt;Axe de vuln√©rabilit√©&lt;/td&gt;</span></span>
<span id="cb4-811"><a href="#cb4-811" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;Axe 1/1 La mise en danger des personnes au sein des b√¢timents&lt;/td&gt;</span></span>
<span id="cb4-812"><a href="#cb4-812" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-813"><a href="#cb4-813" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-814"><a href="#cb4-814" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:bisque; border:1px solid; font-weight: bold;"&gt;Source de vuln√©rabilit√©&lt;/td&gt;</span></span>
<span id="cb4-815"><a href="#cb4-815" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;S1/2 Inondation de b√¢timents et risque de rupture des ouvrants dans les zones pouvant</span></span>
<span id="cb4-816"><a href="#cb4-816" aria-hidden="true" tabindex="-1"></a><span class="vs">        comporter une hauteur d‚Äôeau importante&lt;/td&gt;</span></span>
<span id="cb4-817"><a href="#cb4-817" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-818"><a href="#cb4-818" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/table&gt;</span></span>
<span id="cb4-819"><a href="#cb4-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-820"><a href="#cb4-820" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;br&gt;</span></span>
<span id="cb4-821"><a href="#cb4-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-822"><a href="#cb4-822" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;table style="width:90%; border-collapse: collapse; border:1px solid; text-align:center; margin:auto;"&gt;</span></span>
<span id="cb4-823"><a href="#cb4-823" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;colgroup&gt;</span></span>
<span id="cb4-824"><a href="#cb4-824" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb4-825"><a href="#cb4-825" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb4-826"><a href="#cb4-826" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb4-827"><a href="#cb4-827" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb4-828"><a href="#cb4-828" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb4-829"><a href="#cb4-829" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/colgroup&gt;</span></span>
<span id="cb4-830"><a href="#cb4-830" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-831"><a href="#cb4-831" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:bisque; border:1px solid; font-weight: bold;"&gt;Modalit√©s du calcul&lt;/td&gt;</span></span>
<span id="cb4-832"><a href="#cb4-832" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;On s√©lectionne les b√¢timents (habitation ou activit√©) de plain-pied qui intersectent la </span></span>
<span id="cb4-833"><a href="#cb4-833" aria-hidden="true" tabindex="-1"></a><span class="vs">        zone d‚Äôal√©a sup√©rieure √† 1,5 m et on comptabilise le nombre de personnes (habitants ou employ√©s). Le r√©sultat est ensuite </span></span>
<span id="cb4-834"><a href="#cb4-834" aria-hidden="true" tabindex="-1"></a><span class="vs">        agr√©g√© √† la commune.&lt;/td&gt;</span></span>
<span id="cb4-835"><a href="#cb4-835" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-836"><a href="#cb4-836" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-837"><a href="#cb4-837" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:bisque; border:1px solid; font-weight: bold;"&gt;√âchelle de repr√©sentation&lt;/td&gt;</span></span>
<span id="cb4-838"><a href="#cb4-838" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;Communale&lt;/td&gt;</span></span>
<span id="cb4-839"><a href="#cb4-839" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-840"><a href="#cb4-840" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-841"><a href="#cb4-841" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:bisque; border:1px solid; font-weight: bold;"&gt;Points de vigilance&lt;/td&gt;</span></span>
<span id="cb4-842"><a href="#cb4-842" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;Pour les effectifs des employ√©s, les valeurs renseign√©es dans SIREN sont des fourchettes         de valeurs hautes et basses. Ici, le choix de prendre la valeur haute a √©t√© retenu pour √©viter de minimiser le total.</span></span>
<span id="cb4-843"><a href="#cb4-843" aria-hidden="true" tabindex="-1"></a><span class="vs">        Lors de l‚Äôaffectation des personnes au b√¢timent, pour des carreaux √† faible densit√© de personnes, des valeurs d√©cimales ont pu         √™tre attribu√©es aux b√¢timents.&lt;/td&gt;</span></span>
<span id="cb4-844"><a href="#cb4-844" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-845"><a href="#cb4-845" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-846"><a href="#cb4-846" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:bisque; border:1px solid; font-weight: bold;"&gt;Table cible&lt;/td&gt;</span></span>
<span id="cb4-847"><a href="#cb4-847" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;p_obj1_securite_personnes. s12a_pop_plainpied_zi_fort&lt;/td&gt;</span></span>
<span id="cb4-848"><a href="#cb4-848" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-849"><a href="#cb4-849" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-850"><a href="#cb4-850" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-851"><a href="#cb4-851" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:bisque; border:1px solid; font-weight: bold;"&gt;Variables mobilis√©es&lt;/td&gt;</span></span>
<span id="cb4-852"><a href="#cb4-852" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;Zd : hauteur d‚Äôeau &gt; 1.5m,</span></span>
<span id="cb4-853"><a href="#cb4-853" aria-hidden="true" tabindex="-1"></a><span class="vs">        Pop1 : habitants,</span></span>
<span id="cb4-854"><a href="#cb4-854" aria-hidden="true" tabindex="-1"></a><span class="vs">        Pop2 : employ√©s&lt;/td&gt;</span></span>
<span id="cb4-855"><a href="#cb4-855" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-856"><a href="#cb4-856" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-857"><a href="#cb4-857" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-858"><a href="#cb4-858" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:bisque; border:1px solid; font-weight: bold;"&gt;Indicateur commun SLGRI Vienne/Clain&lt;/td&gt;</span></span>
<span id="cb4-859"><a href="#cb4-859" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;non&lt;/td&gt;</span></span>
<span id="cb4-860"><a href="#cb4-860" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-861"><a href="#cb4-861" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-862"><a href="#cb4-862" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/table&gt;</span></span>
<span id="cb4-863"><a href="#cb4-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-864"><a href="#cb4-864" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;br&gt;</span></span>
<span id="cb4-865"><a href="#cb4-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-866"><a href="#cb4-866" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;table style="width:90%; border-collapse: collapse; border:1px solid; text-align:center; margin:auto;"&gt;</span></span>
<span id="cb4-867"><a href="#cb4-867" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;colgroup&gt;</span></span>
<span id="cb4-868"><a href="#cb4-868" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb4-869"><a href="#cb4-869" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb4-870"><a href="#cb4-870" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb4-871"><a href="#cb4-871" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb4-872"><a href="#cb4-872" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb4-873"><a href="#cb4-873" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb4-874"><a href="#cb4-874" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb4-875"><a href="#cb4-875" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb4-876"><a href="#cb4-876" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb4-877"><a href="#cb4-877" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb4-878"><a href="#cb4-878" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/colgroup&gt;</span></span>
<span id="cb4-879"><a href="#cb4-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-880"><a href="#cb4-880" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-881"><a href="#cb4-881" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="10" style="background-color:bisque; border:1px solid; font-weight: bold;"&gt;Donn√©es sources&lt;/td&gt;</span></span>
<span id="cb4-882"><a href="#cb4-882" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-883"><a href="#cb4-883" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-884"><a href="#cb4-884" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:bisque; border:1px solid;" colspan="2"&gt;D√©signation&lt;/th&gt;</span></span>
<span id="cb4-885"><a href="#cb4-885" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:bisque; border:1px solid;"&gt;Mill√©sime&lt;/th&gt;</span></span>
<span id="cb4-886"><a href="#cb4-886" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:bisque; border:1px solid;"&gt;Nationale/locale&lt;/th&gt;</span></span>
<span id="cb4-887"><a href="#cb4-887" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:bisque; border:1px solid;"&gt;Format&lt;/th&gt;</span></span>
<span id="cb4-888"><a href="#cb4-888" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:bisque; border:1px solid;"&gt;Type&lt;/th&gt;</span></span>
<span id="cb4-889"><a href="#cb4-889" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:bisque; border:1px solid;" colspan="2"&gt;Producteur&lt;/th&gt;</span></span>
<span id="cb4-890"><a href="#cb4-890" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:bisque; border:1px solid;" colspan="2"&gt;Nom fichier&lt;/th&gt;</span></span>
<span id="cb4-891"><a href="#cb4-891" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-892"><a href="#cb4-892" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-893"><a href="#cb4-893" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;Hauteur d‚Äôeau &gt;1.5m&lt;/td&gt;</span></span>
<span id="cb4-894"><a href="#cb4-894" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;2019&lt;/td&gt;</span></span>
<span id="cb4-895"><a href="#cb4-895" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Locale&lt;/td&gt;</span></span>
<span id="cb4-896"><a href="#cb4-896" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Shape&lt;/td&gt;</span></span>
<span id="cb4-897"><a href="#cb4-897" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Polygone&lt;/td&gt;</span></span>
<span id="cb4-898"><a href="#cb4-898" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;Cerema&lt;/td&gt;</span></span>
<span id="cb4-899"><a href="#cb4-899" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;zd_sup_1m50.shp&lt;/td&gt;</span></span>
<span id="cb4-900"><a href="#cb4-900" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-901"><a href="#cb4-901" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-902"><a href="#cb4-902" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;B√¢timent BDTOPO&lt;/td&gt;</span></span>
<span id="cb4-903"><a href="#cb4-903" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;2020&lt;/td&gt;</span></span>
<span id="cb4-904"><a href="#cb4-904" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Nationale&lt;/td&gt;</span></span>
<span id="cb4-905"><a href="#cb4-905" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Shape&lt;/td&gt;</span></span>
<span id="cb4-906"><a href="#cb4-906" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Polygone&lt;/td&gt;</span></span>
<span id="cb4-907"><a href="#cb4-907" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;IGN&lt;/td&gt;</span></span>
<span id="cb4-908"><a href="#cb4-908" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;Batiment.shp&lt;/td&gt;</span></span>
<span id="cb4-909"><a href="#cb4-909" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-910"><a href="#cb4-910" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-911"><a href="#cb4-911" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;Population carreau 200m INSEE&lt;/td&gt;</span></span>
<span id="cb4-912"><a href="#cb4-912" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;2015&lt;/td&gt;</span></span>
<span id="cb4-913"><a href="#cb4-913" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Nationale&lt;/td&gt;</span></span>
<span id="cb4-914"><a href="#cb4-914" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Shape&lt;/td&gt;</span></span>
<span id="cb4-915"><a href="#cb4-915" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Polygone&lt;/td&gt;</span></span>
<span id="cb4-916"><a href="#cb4-916" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;INSEE&lt;/td&gt;</span></span>
<span id="cb4-917"><a href="#cb4-917" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;filosofi2015_carreaux_200m.shp&lt;/td&gt;</span></span>
<span id="cb4-918"><a href="#cb4-918" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-919"><a href="#cb4-919" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-920"><a href="#cb4-920" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;Effectif des entreprises&lt;/td&gt;</span></span>
<span id="cb4-921"><a href="#cb4-921" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;2021&lt;/td&gt;</span></span>
<span id="cb4-922"><a href="#cb4-922" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Nationale&lt;/td&gt;</span></span>
<span id="cb4-923"><a href="#cb4-923" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Shape&lt;/td&gt;</span></span>
<span id="cb4-924"><a href="#cb4-924" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Point&lt;/td&gt;</span></span>
<span id="cb4-925"><a href="#cb4-925" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;INSEE&lt;/td&gt;</span></span>
<span id="cb4-926"><a href="#cb4-926" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;geo_siret.shp&lt;/td&gt;</span></span>
<span id="cb4-927"><a href="#cb4-927" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-928"><a href="#cb4-928" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb4-929"><a href="#cb4-929" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;Communes&lt;/td&gt;</span></span>
<span id="cb4-930"><a href="#cb4-930" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;2020&lt;/td&gt;</span></span>
<span id="cb4-931"><a href="#cb4-931" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Nationale&lt;/td&gt;</span></span>
<span id="cb4-932"><a href="#cb4-932" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Shape&lt;/td&gt;</span></span>
<span id="cb4-933"><a href="#cb4-933" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Polygone&lt;/td&gt;</span></span>
<span id="cb4-934"><a href="#cb4-934" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;Cerema&lt;/td&gt;</span></span>
<span id="cb4-935"><a href="#cb4-935" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;Commune.shp&lt;/td&gt;</span></span>
<span id="cb4-936"><a href="#cb4-936" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb4-937"><a href="#cb4-937" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/table&gt;</span></span>
<span id="cb4-938"><a href="#cb4-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-939"><a href="#cb4-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-940"><a href="#cb4-940" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="expression">

</div>
</div>
</div>
        
        <p></p>
      </div>
      <div id="tab3" class="tab"> 
        <p>
</p><p><i class="bi bi-box"></i> <strong>Incliner et faire tourner la carte</strong><br>
Maintenez enfonc√© le bouton droit de la souris sur ce symbole <img src="Images/bouton_inclinaison.jpg" style="margin-bottom:auto; width:2%;"> et d√©placez le pour incliner le point de vue ou faire tourner la carte.</p>
<p><i class="bi bi-mouse2"></i> <strong>Zoomer sur la carte</strong><br>
Zoomer sur la carte (molette de la souris) pour visualiser les b√¢timents.</p>
<p><i class="bi bi-info-circle"></i> <strong>Une illustration pour bien comprendre la carte interactive</strong></p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="Images/batiments_3d.jpg" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption>B√¢timents 3D</figcaption>
</figure>
</div>
<p></p>
      </div>
      <div id="tab4" class="tab"> 
        <p>
</p><div class="cell" data-padding="5px" data-expandable="false">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="974" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 973;"><span id="cb5-974"><a href="#cb5-974" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`</span></span>
<span id="cb5-975"><a href="#cb5-975" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;div id="donnees" style="font-family: Arial, sans-serif; font-size: 16px; line-height: 1.5; margin-top:1%;"&gt;</span></span>
<span id="cb5-976"><a href="#cb5-976" aria-hidden="true" tabindex="-1"></a><span class="vs">    Cliquez sur une commune pour voir les informations ici.&lt;br&gt;</span></span>
<span id="cb5-977"><a href="#cb5-977" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;</span></span>
<span id="cb5-978"><a href="#cb5-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-979"><a href="#cb5-979" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="expression">

</div>
</div>
</div>
        <p></p>
      </div>
      <div id="tab5" class="tab">
        <p>
</p><div class="cell" data-expandable="false">
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-2710a58a4c4a970c8155" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2710a58a4c4a970c8155">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Code INSEE":["86095","86014","86088","86253","86062","86239","86114","86032","86298","86163","86124","86020","86261","86046","86091","86028","86213","86070","86233","86202","86058","86135","86226","86031","86024","86133","86194","86027","86158","86066","86041","86174","86139","86019","86115","86214","86116","86222","86244","86045","86256","86198","86157","86268","86080","86263","86297","86100","86083"],"Commune":["Dissay","Availles-en-Ch√¢tellerault","Croutelle","Sanxay","Chasseneuil-du-Poitou","Sainte-Rad√©gonde","Jardres","Bonneuil-Matours","Vouneuil-sur-Vienne","Montamis√©","Lavoux","Bellefonds","S√®vres-Anxaumont","Cenon-sur-Vienne","Curzay-sur-Vonne","Bignoux","Rouill√©","Chauvigny","Valdivienne","La Puye","La Chapelle-Mouli√®re","Liniers","Saint-Julien-l'Ars","Bonnes","B√©ruges","Ligug√©","Poitiers","Biard","Mign√©-Auxances","Ch√¢tellerault","Buxerolles","Naintr√©","Lusignan","Beaumont Saint-Cyr","Jaunay-Marigny","Saint-Beno√Æt","Jazeneuil","Saint-Georges-l√®s-Baillargeaux","Saint-Sauvant","Celle-L√©vescault","Savigny-L√©vescault","Pouill√©","Mignaloux-Beauvoir","Terc√©","Clou√©","Smarves","Vouneuil-sous-Biard","Fontaine-le-Comte","Coulombiers"],"Population":[" 3 233"," 1 757","   851","   548"," 4 704","   169"," 1 273"," 2 104"," 2 198"," 3 630"," 1 180","   254"," 2 181"," 1 778","   410"," 1 054"," 2 468"," 7 049"," 2 747","   606","   705","   561"," 2 660"," 1 729"," 1 469"," 3 349","88 291"," 1 751"," 6 071","31 840","10 023"," 5 911"," 2 649"," 3 035"," 7 530"," 7 233","   804"," 4 168"," 1 258"," 1 356"," 1 168","   657"," 4 577"," 1 116","   496"," 2 810"," 5 896"," 3 853"," 1 164"],"Population en zone fortement inondable":["  1","  6","  0","  5","  4","  0","  0"," 55"," 34","  0","  0","  0","  0","  1","  0","  0","  0"," 47"," 28","  0","  3","  0","  0"," 28","  0"," 85","226","  0"," 10"," 59","  5","  5","  5","  0","  0"," 95","  0","  1","  0","  0","  0","  0","  0","  0","  0"," 12","  0","  0","  0"]},"columns":[{"id":"Code INSEE","name":"Code INSEE","type":"character"},{"id":"Commune","name":"Commune","type":"character"},{"id":"Population","name":"Population","type":"character"},{"id":"Population en zone fortement inondable","name":"Population en zone fortement inondable","type":"character"}],"resizable":true,"filterable":true,"defaultPageSize":10,"highlight":true,"striped":true,"theme":{"borderColor":"#E0E0E0","stripedColor":"#f5f5f5","highlightColor":"#7591e5","cellPadding":"8px 12px","style":{"fontSize":"14px","fontFamily":"sans-serif"}},"dataKey":"9b926186ddc492c1a36d5e3db69e5a55"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
        <p></p>
      </div>
      <div id="tab6" class="tab">
        <p>
</p><div class="cell" data-padding="5px" data-expandable="false">
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="1064" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1063;"><span id="cb6-1064"><a href="#cb6-1064" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Plot } <span class="im">from</span> <span class="st">"@observablehq/plot"</span><span class="op">;</span></span>
<span id="cb6-1065"><a href="#cb6-1065" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Inputs } <span class="im">from</span> <span class="st">"@observablehq/inputs"</span><span class="op">;</span></span>
<span id="cb6-1066"><a href="#cb6-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1067"><a href="#cb6-1067" aria-hidden="true" tabindex="-1"></a><span class="co">// Charger les donn√©es depuis le fichier g√©n√©r√© par R</span></span>
<span id="cb6-1068"><a href="#cb6-1068" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/data_s12a.json"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb6-1069"><a href="#cb6-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1070"><a href="#cb6-1070" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;label for="slider-s12a" style="display: block;</span></span>
<span id="cb6-1071"><a href="#cb6-1071" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin-top: 1em;</span></span>
<span id="cb6-1072"><a href="#cb6-1072" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: bold;</span></span>
<span id="cb6-1073"><a href="#cb6-1073" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin-bottom: 1em;</span></span>
<span id="cb6-1074"><a href="#cb6-1074" aria-hidden="true" tabindex="-1"></a><span class="vs">  border: 1px solid rgba(0, 0, 0, 0.6);</span></span>
<span id="cb6-1075"><a href="#cb6-1075" aria-hidden="true" tabindex="-1"></a><span class="vs">  box-shadow: 0px 0px 8px 0px rgba(0, 0, 0, 0.8);</span></span>
<span id="cb6-1076"><a href="#cb6-1076" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 8px;</span></span>
<span id="cb6-1077"><a href="#cb6-1077" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 5px;</span></span>
<span id="cb6-1078"><a href="#cb6-1078" aria-hidden="true" tabindex="-1"></a><span class="vs">  text-align: center;</span></span>
<span id="cb6-1079"><a href="#cb6-1079" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin-right: 20%;</span></span>
<span id="cb6-1080"><a href="#cb6-1080" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin-left: 20%;"&gt;</span></span>
<span id="cb6-1081"><a href="#cb6-1081" aria-hidden="true" tabindex="-1"></a><span class="vs">  Population en zone inondable</span></span>
<span id="cb6-1082"><a href="#cb6-1082" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/label&gt;`</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-4" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="1085" data-source-offset="-569"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1084;"><span id="cb7-1085"><a href="#cb7-1085" aria-hidden="true" tabindex="-1"></a>viewof slider <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb7-1086"><a href="#cb7-1086" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">0</span><span class="op">,</span> <span class="dv">230</span>]<span class="op">,</span> </span>
<span id="cb7-1087"><a href="#cb7-1087" aria-hidden="true" tabindex="-1"></a>  { <span class="dt">value</span><span class="op">:</span> <span class="dv">230</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> </span>
<span id="cb7-1088"><a href="#cb7-1088" aria-hidden="true" tabindex="-1"></a>  <span class="dt">id</span><span class="op">:</span> <span class="st">"slider-s12a"</span></span>
<span id="cb7-1089"><a href="#cb7-1089" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-1090"><a href="#cb7-1090" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-1091"><a href="#cb7-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1092"><a href="#cb7-1092" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div style="margin-top: 30px;"&gt;&lt;/div&gt;`</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-6" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="1095" data-source-offset="-740"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1094;"><span id="cb8-1095"><a href="#cb8-1095" aria-hidden="true" tabindex="-1"></a>sorted <span class="op">=</span> data</span>
<span id="cb8-1096"><a href="#cb8-1096" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">s12a</span> <span class="op">&lt;=</span> slider)</span>
<span id="cb8-1097"><a href="#cb8-1097" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a<span class="op">.</span><span class="at">s12a</span> <span class="op">-</span> b<span class="op">.</span><span class="at">s12a</span>)<span class="op">;</span></span>
<span id="cb8-1098"><a href="#cb8-1098" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-1099"><a href="#cb8-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-1100"><a href="#cb8-1100" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb8-1101"><a href="#cb8-1101" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb8-1102"><a href="#cb8-1102" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">barY</span>(sorted<span class="op">,</span> { <span class="dt">x</span><span class="op">:</span> <span class="st">"nom"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"s12a"</span><span class="op">,</span> </span>
<span id="cb8-1103"><a href="#cb8-1103" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fill</span><span class="op">:</span> d <span class="kw">=&gt;</span> {</span>
<span id="cb8-1104"><a href="#cb8-1104" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> val <span class="op">=</span> d<span class="op">.</span><span class="at">s12a</span><span class="op">;</span></span>
<span id="cb8-1105"><a href="#cb8-1105" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (val <span class="op">===</span> <span class="dv">0</span>) <span class="cf">return</span> <span class="st">"#d9d9d9"</span><span class="op">;</span>        <span class="co">// null ou 0</span></span>
<span id="cb8-1106"><a href="#cb8-1106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (val <span class="op">&lt;</span> <span class="dv">10</span>) <span class="cf">return</span> <span class="st">"#f9e9e9"</span><span class="op">;</span></span>
<span id="cb8-1107"><a href="#cb8-1107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (val <span class="op">&lt;</span> <span class="dv">50</span>) <span class="cf">return</span> <span class="st">"#ffaaaa"</span><span class="op">;</span></span>
<span id="cb8-1108"><a href="#cb8-1108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (val <span class="op">&lt;</span> <span class="dv">100</span>) <span class="cf">return</span> <span class="st">"#ff5555"</span><span class="op">;</span></span>
<span id="cb8-1109"><a href="#cb8-1109" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (val <span class="op">&gt;=</span> <span class="dv">100</span>) <span class="cf">return</span> <span class="st">"#ff0000"</span><span class="op">;</span></span>
<span id="cb8-1110"><a href="#cb8-1110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"#b30000"</span><span class="op">;</span></span>
<span id="cb8-1111"><a href="#cb8-1111" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb8-1112"><a href="#cb8-1112" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb8-1113"><a href="#cb8-1113" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">text</span>(sorted<span class="op">,</span> { <span class="dt">x</span><span class="op">:</span> <span class="st">"nom"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"s12a"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="at">s12a</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">10</span> })</span>
<span id="cb8-1114"><a href="#cb8-1114" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb8-1115"><a href="#cb8-1115" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> { <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Population en zone fortement inondable"</span> }<span class="op">,</span></span>
<span id="cb8-1116"><a href="#cb8-1116" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Commune"</span><span class="op">,</span></span>
<span id="cb8-1117"><a href="#cb8-1117" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tickRotate</span><span class="op">:</span> <span class="op">-</span><span class="dv">45</span><span class="op">,</span></span>
<span id="cb8-1118"><a href="#cb8-1118" aria-hidden="true" tabindex="-1"></a>        <span class="dt">labelAnchor</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span></span>
<span id="cb8-1119"><a href="#cb8-1119" aria-hidden="true" tabindex="-1"></a>        <span class="dt">labelOffset</span><span class="op">:</span> <span class="dv">30</span>}<span class="op">,</span></span>
<span id="cb8-1120"><a href="#cb8-1120" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="bu">window</span><span class="op">.</span><span class="at">innerWidth</span> <span class="op">*</span> <span class="fl">0.95</span><span class="op">,</span></span>
<span id="cb8-1121"><a href="#cb8-1121" aria-hidden="true" tabindex="-1"></a>   <span class="dt">height</span><span class="op">:</span> <span class="bu">window</span><span class="op">.</span><span class="at">innerHeight</span> <span class="op">*</span> <span class="fl">0.85</span><span class="op">,</span></span>
<span id="cb8-1122"><a href="#cb8-1122" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">600</span><span class="op">,</span></span>
<span id="cb8-1123"><a href="#cb8-1123" aria-hidden="true" tabindex="-1"></a>  <span class="dt">style</span><span class="op">:</span> {</span>
<span id="cb8-1124"><a href="#cb8-1124" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fontSize</span><span class="op">:</span> <span class="st">"10px"</span><span class="op">,</span></span>
<span id="cb8-1125"><a href="#cb8-1125" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fill</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb8-1126"><a href="#cb8-1126" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span></span>
<span id="cb8-1127"><a href="#cb8-1127" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb8-1128"><a href="#cb8-1128" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">130</span></span>
<span id="cb8-1129"><a href="#cb8-1129" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-8" data-nodetype="expression">

</div>
</div>
</div>
</div>
        <p></p>
      </div> 
    </div>
</div> 

<style>
/* Conteneur global */
.tabset {
  margin-top: 20px;
}

/* Boutons */
.tab-buttons {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  margin-bottom: 15px;
  margin-left: 10vw;
}

.tab-btn {
  padding: 10px 18px;
  background: #e6e6e6;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
}

.tab-btn.active {
  background: #dc7633;
  color: white;
}

/* Contenu */
.tab-content .tab {
  display: none;
  padding: 10px 0;
}

.tab-content .tab.active {
  display: block;
}
</style>


<script>
document.querySelectorAll(".tab-btn").forEach(btn => {
  btn.addEventListener("click", () => {

    // d√©sactiver tous les boutons
    document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));

    // masquer tous les onglets
    document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));

    // activer le bouton cliqu√©
    btn.classList.add("active");

    // activer l‚Äôonglet correspondant
    document.getElementById(btn.dataset.tab).classList.add("active");
  });
});
</script>





<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImJib3hfc3J1ID0gRmlsZUF0dGFjaG1lbnQoXCJsYXllcnMvYmIuanNvblwiKS5qc29uKClcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuYmFzc2luX3ZpZW5uZSA9IEZpbGVBdHRhY2htZW50KFwibGF5ZXJzL2Jhc3Npbl92aWVubmUuZ2VvanNvblwiKS5qc29uKCk7XG5kZXBhcnRlbWVudCA9IEZpbGVBdHRhY2htZW50KFwibGF5ZXJzL2RlcGFydGVtZW50Lmdlb2pzb25cIikuanNvbigpO1xucmVnaW9uID0gRmlsZUF0dGFjaG1lbnQoXCJsYXllcnMvcmVnaW9uLmdlb2pzb25cIikuanNvbigpO1xuZXBjaSA9IEZpbGVBdHRhY2htZW50KFwibGF5ZXJzL2VwY2kuZ2VvanNvblwiKS5qc29uKCk7XG5wZXJpbWV0cmUgPSBGaWxlQXR0YWNobWVudChcImxheWVycy9wZXJpbWV0cmUuanNvblwiKS5qc29uKCk7XG5zbGdyaSA9IEZpbGVBdHRhY2htZW50KFwibGF5ZXJzL3NsZ3JpLmpzb25cIikuanNvbigpO1xudHJpID0gRmlsZUF0dGFjaG1lbnQoXCJsYXllcnMvdHJpLmpzb25cIikuanNvbigpO1xuem9uZV9pbm9uZGFibGUgPSBGaWxlQXR0YWNobWVudChcImxheWVycy96b25lX2lub25kYWJsZS5nZW9qc29uXCIpLmpzb24oKTtcbi8vaW5kaWNhdGV1cnMgPSBGaWxlQXR0YWNobWVudChcImxheWVycy9pbmRpY2F0ZXVycy5qc29uXCIpLmpzb24oKTtcbmNvdXJzX2RfZWF1ID0gRmlsZUF0dGFjaG1lbnQoXCJsYXllcnMvY291cnNfZF9lYXUuZ2VvanNvblwiKS5qc29uKCk7XG5pbmRpY2F0ZXVyc0dlb2pzb24gPSBGaWxlQXR0YWNobWVudChcImxheWVycy9pbmRpY2F0ZXVycy5nZW9qc29uXCIpLmpzb24oKTtcbmJhdGltZW50cyA9IEZpbGVBdHRhY2htZW50KFwibGF5ZXJzL2JhdGltZW50c19oYXV0ZXVyLmdlb2pzb25cIikuanNvbigpO1xuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcblxubWFwID0ge1xuICBjb25zdCBjb250YWluZXIgPSBodG1sYDxkaXYgY2xhc3M9XCJtYXAtY29udGFpbmVyXCIgaWQ9XCJtYXBcIiBzdHlsZT1cImhlaWdodDogNjAwcHg7IHdpZHRoOiA5MCU7IG1hcmdpbi1sZWZ0OiA1dnc7XCI+PC9kaXY+YDtcbiAgeWllbGQgY29udGFpbmVyO1xuXG4gIDwhLS0gY29uc3Qgc291cmNlUGxhbklHTiA9IHsgLS0+XG4gIDwhLS0gICBzdHlsZTogJ25vcm1hbCcsIC0tPlxuICA8IS0tICAgZm9ybWF0OiAnaW1hZ2UvcG5nJywgLS0+XG4gIDwhLS0gICBsYXllcjogJ0dFT0dSQVBISUNBTEdSSURTWVNURU1TLlBMQU5JR05WMicgLS0+XG4gIDwhLS0gfTsgLS0+XG5cbiAgY29uc3Qgc291cmNlT3J0aG8gPSB7XG4gICAgc3R5bGU6ICdub3JtYWwnLFxuICAgIGZvcm1hdDogJ2ltYWdlL2pwZWcnLFxuICAgIGxheWVyOiAnSFIuT1JUSE9JTUFHRVJZLk9SVEhPUEhPVE9TJ1xuICB9O1xuXG4gIGNvbnN0IG1hcCA9IG5ldyBtYXBsaWJyZWdsLk1hcCh7XG4gICAgY29udGFpbmVyOiBjb250YWluZXIsXG4gICAgc3R5bGU6ICdodHRwczovL2Jhc2VtYXBzLmNhcnRvY2RuLmNvbS9nbC92b3lhZ2VyLWdsLXN0eWxlL3N0eWxlLmpzb24nLFxuICAgIDwhLS0gY2VudGVyOiBbLTAuMDQsIDQ2LjMwNTFdLCAgLS0+XG4gICAgem9vbTogMTFcbiAgfSk7XG5cbiAgbWFwLmFkZENvbnRyb2wobmV3IG1hcGxpYnJlZ2wuRnVsbHNjcmVlbkNvbnRyb2woKSwgJ3RvcC1yaWdodCcpO1xuICBtYXAuYWRkQ29udHJvbChuZXcgbWFwbGlicmVnbC5OYXZpZ2F0aW9uQ29udHJvbCh7IHZpc3VhbGl6ZVBpdGNoOiB0cnVlIH0pLCAndG9wLWxlZnQnKTtcbiAgbWFwLmFkZENvbnRyb2wobmV3IG1hcGxpYnJlZ2wuU2NhbGVDb250cm9sKHsgbWF4V2lkdGg6IDgwLCB1bml0OiAnbWV0cmljJyB9KSk7XG4gIFxuXG4gIGNvbnN0IHRvZ2dsZVN0eWxlID0gKHVzZU9ydGhvKSA9PiB7XG4gICAgaWYgKHVzZU9ydGhvKSB7XG4gICAgICBtYXAuc2V0TGF5b3V0UHJvcGVydHkoJ29ydGhvSUdOJywgJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpO1xuICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KCdPU00nLCAndmlzaWJpbGl0eScsICdub25lJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1hcC5zZXRMYXlvdXRQcm9wZXJ0eSgnb3J0aG9JR04nLCAndmlzaWJpbGl0eScsICdub25lJyk7XG4gICAgICBtYXAuc2V0TGF5b3V0UHJvcGVydHkoJ09TTScsICd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTtcbiAgICB9XG4gIH07XG5cbiAgbWFwLm9uKCdsb2FkJywgKCkgPT4ge1xuICAgIG1hcC5maXRCb3VuZHMoXG4gICAgW1xuICAgICAgWy0wLjA0LCA0Ni4zMDUxXSwgICAvLyBTdWQtT3Vlc3RcbiAgICAgIFswLjc3NDEsIDQ2Ljg1NjVdICAgLy8gTm9yZC1Fc3RcbiAgICBdLFxuICAgIHtcbiAgICAgIHBhZGRpbmc6IDIwLFxuICAgICAgbGluZWFyOiB0cnVlLFxuICAgICAgZHVyYXRpb246IDBcbiAgICB9XG4gICk7XG4gICAgLy8gQWpvdXQgZGVzIGZvbmRzIHJhc3RlciBJR05cbiAgICA8IS0tIG1hcC5hZGRTb3VyY2UoJ3Jhc3Rlci1wbGFuaWduJywgeyAtLT5cbiAgICA8IS0tICAgdHlwZTogJ3Jhc3RlcicsIC0tPlxuICAgIDwhLS0gICB0aWxlczogWyAtLT5cbiAgICA8IS0tICAgICBgaHR0cHM6Ly9kYXRhLmdlb3BmLmZyL3dtdHM/U0VSVklDRT1XTVRTJnN0eWxlPSR7c291cmNlUGxhbklHTi5zdHlsZX0mVkVSU0lPTj0xLjAuMCZSRVFVRVNUPUdldFRpbGUmZm9ybWF0PSR7c291cmNlUGxhbklHTi5mb3JtYXR9JmxheWVyPSR7c291cmNlUGxhbklHTi5sYXllcn0mdGlsZW1hdHJpeHNldD1QTSZUaWxlTWF0cml4PXt6fSZUaWxlQ29sPXt4fSZUaWxlUm93PXt5fWAgLS0+XG4gICAgPCEtLSAgIF0sIC0tPlxuICAgIDwhLS0gICB0aWxlU2l6ZTogMjU2LCAtLT5cbiAgICA8IS0tICAgYXR0cmlidXRpb246ICfCqSA8YSBocmVmPVwiaHR0cHM6Ly93d3cuaWduLmZyL1wiPklHTjwvYT4nLCAtLT5cbiAgICA8IS0tICAgbWluem9vbTogMCwgLS0+XG4gICAgPCEtLSAgIG1heHpvb206IDIyIC0tPlxuICAgIDwhLS0gfSk7IC0tPlxuXG4gICAgbWFwLmFkZFNvdXJjZSgncmFzdGVyLW9ydGhvJywge1xuICAgICAgdHlwZTogJ3Jhc3RlcicsXG4gICAgICB0aWxlczogW1xuICAgICAgICBgaHR0cHM6Ly9kYXRhLmdlb3BmLmZyL3dtdHM/U0VSVklDRT1XTVRTJnN0eWxlPSR7c291cmNlT3J0aG8uc3R5bGV9JlZFUlNJT049MS4wLjAmUkVRVUVTVD1HZXRUaWxlJmZvcm1hdD0ke3NvdXJjZU9ydGhvLmZvcm1hdH0mbGF5ZXI9JHtzb3VyY2VPcnRoby5sYXllcn0mdGlsZW1hdHJpeHNldD1QTSZUaWxlTWF0cml4PXt6fSZUaWxlQ29sPXt4fSZUaWxlUm93PXt5fWBcbiAgICAgIF0sXG4gICAgICB0aWxlU2l6ZTogMjU2LFxuICAgICAgYXR0cmlidXRpb246ICfCqSA8YSBocmVmPVwiaHR0cHM6Ly93d3cuaWduLmZyL1wiPklHTjwvYT4nLFxuICAgICAgbWluem9vbTogMCxcbiAgICAgIG1heHpvb206IDIyXG4gICAgfSk7XG4gICAgXG4gICAgbWFwLmFkZFNvdXJjZSgncmFzdGVyLW9zbScsIHtcbiAgdHlwZTogJ3Jhc3RlcicsXG4gIHRpbGVzOiBbXG4gICAgJ2h0dHBzOi8vdGlsZS5vcGVuc3RyZWV0bWFwLm9yZy97en0ve3h9L3t5fS5wbmcnXG4gIF0sXG4gIHRpbGVTaXplOiAyNTYsXG4gIGF0dHJpYnV0aW9uOlxuICAgICfCqSA8YSBocmVmPVwiaHR0cHM6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvY29weXJpZ2h0XCI+T3BlblN0cmVldE1hcDwvYT4gY29udHJpYnV0b3JzJyxcbiAgbWluem9vbTogMCxcbiAgbWF4em9vbTogMTlcbiAgICB9KTtcblxuICAgIDwhLS0gbWFwLmFkZExheWVyKHsgLS0+XG4gICAgPCEtLSAgIGlkOiAncGxhbklHTicsIC0tPlxuICAgIDwhLS0gICB0eXBlOiAncmFzdGVyJywgLS0+XG4gICAgPCEtLSAgIHNvdXJjZTogJ3Jhc3Rlci1wbGFuaWduJywgLS0+XG4gICAgPCEtLSAgIGxheW91dDogeyB2aXNpYmlsaXR5OiAndmlzaWJsZScgfSAtLT5cbiAgICA8IS0tIH0pOyAtLT5cblxuICAgIG1hcC5hZGRMYXllcih7XG4gICAgICBpZDogJ29ydGhvSUdOJyxcbiAgICAgIHR5cGU6ICdyYXN0ZXInLFxuICAgICAgc291cmNlOiAncmFzdGVyLW9ydGhvJyxcbiAgICAgIGxheW91dDogeyB2aXNpYmlsaXR5OiAnbm9uZScgfVxuICAgIH0pO1xuICAgIFxuICAgICBtYXAuYWRkTGF5ZXIoe1xuICAgICAgaWQ6ICdPU00nLFxuICAgICAgdHlwZTogJ3Jhc3RlcicsXG4gICAgICBzb3VyY2U6ICdyYXN0ZXItb3NtJyxcbiAgICAgIGxheW91dDogeyB2aXNpYmlsaXR5OiAndmlzaWJsZScgfSAvLyB0dSBwZXV4IGxlIGxhaXNzZXIgY2FjaMOpIGF1IGTDqXBhcnQgc2kgdHUgdmV1eCBsZSBiYXNjdWxlciBlbnN1aXRlXG4gICAgfSk7XG4gICAgXG4gICAgLy9mZXRjaCgnbGF5ZXJzL2luZGljYXRldXJzLmdlb2pzb24nKVxuICAgICAvLy50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcbiAgICAgLy8udGhlbihpbmRpY2F0ZXVyc0dlb2pzb24gPT4geyBcbiAgICAgICAgICAgICAgXG4gICAgXG4gICAgY29uc3QgbGF5ZXJzRGF0YSA9IFtcbiAgICAgIHsgZGF0YTogYmFzc2luX3ZpZW5uZSwgdHlwZTogJ2xpbmUnLCBpZDogJ2Jhc3NpbnZpZW5uZUxheWVyJywgY29sb3I6ICdncmVlbicsIGxheW91dDoge3Zpc2liaWxpdHk6J25vbmUnfX0sXG4gICAgICB7IGRhdGE6IHJlZ2lvbiwgdHlwZTogJ2xpbmUnLCBpZDogJ3JlZ2lvbkxheWVyJywgY29sb3I6ICdyZWQnLCBsYXlvdXQ6IHt2aXNpYmlsaXR5Oidub25lJ30gfSxcbiAgICAgIHsgZGF0YTogZGVwYXJ0ZW1lbnQsIHR5cGU6ICdsaW5lJywgaWQ6ICdkZXBhcnRlbWVudExheWVyJywgY29sb3I6ICcjYTc3MmI5Jywgd2lkdGg6IDIsICBsYXlvdXQ6e3Zpc2liaWxpdHk6J25vbmUnfX0sXG4gICAgICB7IGRhdGE6IGVwY2ksIHR5cGU6ICdsaW5lJywgaWQ6ICdlcGNpTGF5ZXInLCBjb2xvcjogJyM1NjdhZTMnLCBsYXlvdXQ6IHt2aXNpYmlsaXR5Oidub25lJ30gfSxcbiAgICAgIHsgZGF0YTogaW5kaWNhdGV1cnNHZW9qc29uLCAvLyBHZW9KU09OIGNvbnRlbmFudCB1bmUgcHJvcHJpw6l0w6kgJ3MxMmEnIC0tPlxuICAgICAgICB0eXBlOiAnZmlsbCcsXG4gICAgICAgIGlkOiAnaW5kaWNhdGV1cnMxMmFMYXllcicsXG4gICAgICAgIG9wYWNpdHk6IDAuNSxcbiAgICAgICAgd2lkdGg6IDEsXG4gICAgICAgIGR5bmFtaWNDb2xvcjogeyBcbiAgICAgICAgcHJvcGVydHk6ICdzMTJhJyxcbiAgICAgICAgbWFwcGluZzogeyBcbiAgICAgICAgICAgLy8nLTEnOiAnI2YxZWVlZCcsXG4gICAgICAgICAgIC8vJzAnOiAnI2ZmZmZmZicsIFxuICAgICAgICAgICAnMTAnOiAnI2ZmZmZmZicsXG4gICAgICAgICAgICc1MCc6ICcjZmZhYWFhJywgXG4gICAgICAgICAgICcxMDAnOiAnI2ZmNTU1NSdcbiAgICAgICAgICB9LCBcbiAgICAgICAgIGRlZmF1bHQ6ICcjZDlkOWQ5J1xuICAgICAgICB9XG4gICAgICAgICwgbGF5b3V0OiB7dmlzaWJpbGl0eTondmlzaWJsZSd9XG4gICAgICAgICB9LFxuICAgICAgeyBkYXRhOiB6b25lX2lub25kYWJsZSwgdHlwZTogJ2ZpbGwnLCBpZDogJ3pvbmVpbm9uZGFibGVMYXllcicsIGNvbG9yOiAnI2I0YzNlZicgLCB3aWR0aDogMiwgb3BhY2l0eTogMSwgXG4gICAgICBsYXlvdXQ6IHt2aXNpYmlsaXR5Oid2aXNpYmxlJ30gfSxcbiAgICAgIHsgZGF0YTogY291cnNfZF9lYXUsIHR5cGU6ICdsaW5lJywgaWQ6ICdjb3Vyc2RlYXVMYXllcicsIGNvbG9yOiAnI2I0YzNlZicgLCB3aWR0aDogMiwgb3BhY2l0eTogMSwgXG4gICAgICBsYXlvdXQ6IHt2aXNpYmlsaXR5Oid2aXNpYmxlJ30gfSxcbiAgICAgIHsgZGF0YTogYmF0aW1lbnRzLCB0eXBlOiAnZmlsbC1leHRydXNpb24nLCBpZDogJ2JhdGltZW50c0xheWVyJywgd2lkdGg6Miwgb3BhY2l0eTogMSwgY29sb3JCeVR5cGU6ICdmZl9kdGVsb2N0eHQnLCBoZWlnaHRQcm9wZXJ0eTogJ2hhdXRldXInLGxheW91dDoge3Zpc2liaWxpdHk6J25vbmUnfX1cbiAgICAgIFxuICAgIF07XG4gICAgXG4gICAgLy8gQ3LDqWVyIGxlIGNvbnRlbmV1clxuICAgICAgICBjb25zdCBsZWdlbmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgbGVnZW5kLmlkID0gJ2xlZ2VuZCc7XG4gICAgICAgIGxlZ2VuZC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgIGxlZ2VuZC5zdHlsZS50b3AgPSAnODIlJztcbiAgICAgICAgbGVnZW5kLnN0eWxlLnJpZ2h0ID0gJzEwcHgnO1xuICAgICAgICBsZWdlbmQuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVkoLTUwJSknO1xuICAgICAgICBsZWdlbmQuc3R5bGUuYmFja2dyb3VuZCA9ICd3aGl0ZSc7XG4gICAgICAgIGxlZ2VuZC5zdHlsZS5wYWRkaW5nID0gJzEwcHgnO1xuICAgICAgICBsZWdlbmQuc3R5bGUuZm9udFNpemUgPSAnMTJweCc7XG4gICAgICAgIGxlZ2VuZC5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnNHB4JztcbiAgICAgICAgbGVnZW5kLnN0eWxlLmJveFNoYWRvdyA9ICcwIDFweCA0cHggcmdiYSgwLDAsMCwwLjMpJztcbiAgICAgICAgbGVnZW5kLnN0eWxlLnpJbmRleCA9ICcxJzsgLy8gcG91ciBwYXNzZXIgYXUtZGVzc3VzIGRlIGxhIGNhcnRlXG4gICAgICAgIFxuICAgICAgICAvLyBDb250ZW51IGRlIGxhIGzDqWdlbmRlXG4gICAgICAgIGxlZ2VuZC5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgPHN0cm9uZz5Qb3B1bGF0aW9uIGVuIHpvbmUgPGJyPmZvcnRlbWVudCBpbm9uZGFibGU8L3N0cm9uZz48YnI+XG4gICAgICAgICAgPGRpdj48c3BhbiBzdHlsZT1cImJhY2tncm91bmQ6I2Q5ZDlkOTt3aWR0aDoxMnB4O2hlaWdodDoxMnB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO21hcmdpbi1yaWdodDo1cHg7XCI+PC9zcGFuPiAwPC9kaXY+XG4gICAgICAgICAgPGRpdj48c3BhbiBzdHlsZT1cImJhY2tncm91bmQ6I2ZmZmZmZjt3aWR0aDoxMnB4O2hlaWdodDoxMnB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO21hcmdpbi1yaWdodDo1cHg7Ym9yZGVyOjFweCBzb2xpZCAjY2NjO1wiPjwvc3Bhbj4gPCAxMCA8L2Rpdj5cbiAgICAgICAgICA8ZGl2PjxzcGFuIHN0eWxlPVwiYmFja2dyb3VuZDojZmZhYWFhO3dpZHRoOjEycHg7aGVpZ2h0OjEycHg7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luLXJpZ2h0OjVweDtcIj48L3NwYW4+IDEwLTUwIDwvZGl2PlxuICAgICAgICAgIDxkaXY+PHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kOiNmZjU1NTU7d2lkdGg6MTJweDtoZWlnaHQ6MTJweDtkaXNwbGF5OmlubGluZS1ibG9jazttYXJnaW4tcmlnaHQ6NXB4O1wiPjwvc3Bhbj4gNTAtMTAwIDwvZGl2PlxuICAgICAgICAgIDxkaXY+PHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kOiNmZjAwMDA7d2lkdGg6MTJweDtoZWlnaHQ6MTJweDtkaXNwbGF5OmlubGluZS1ibG9jazttYXJnaW4tcmlnaHQ6NXB4O1wiPjwvc3Bhbj4gPiAxMDAgPC9kaXY+XG4gICAgICAgIGA7XG4gICAgICAgIFxuICAgICAgICAvLyBM4oCZYWpvdXRlciDDoCBsYSBjYXJ0ZSAobGUgY29udGFpbmVyIE1hcExpYnJlKVxuICAgICAgICBtYXAuZ2V0Q29udGFpbmVyKCkuYXBwZW5kQ2hpbGQobGVnZW5kKTtcbiAgICAgICAgXG4gICAgICAgIC8vYWZpbiBkZSBsaWVyIGxhIGzDqWdlbmRlIMOgIGwnaW5kaWNhdGV1clxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVMZWdlbmRWaXNpYmlsaXR5KCkge1xuICAgICAgICBjb25zdCB2aXNpYmlsaXR5ID0gbWFwLmdldExheW91dFByb3BlcnR5KCdpbmRpY2F0ZXVyczEyYUxheWVyJywgJ3Zpc2liaWxpdHknKTtcbiAgICAgICAgaWYgKHZpc2liaWxpdHkgPT09ICdub25lJykge1xuICAgICAgICAgIGxlZ2VuZC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxlZ2VuZC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAgIG1hcC5vbignaWRsZScsIHVwZGF0ZUxlZ2VuZFZpc2liaWxpdHkpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ3LDqWVyIGxlIGNvbnRlbmV1ciBkZSBsw6lnZW5kZSBkZXMgYsOidGltZW50c1xuICAgICAgICBjb25zdCBiYXRpbWVudExlZ2VuZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBiYXRpbWVudExlZ2VuZC5pZCA9ICdiYXRpbWVudC1sZWdlbmQnO1xuICAgICAgICBiYXRpbWVudExlZ2VuZC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgIGJhdGltZW50TGVnZW5kLnN0eWxlLnRvcCA9ICc4MSUnO1xuICAgICAgICBiYXRpbWVudExlZ2VuZC5zdHlsZS5sZWZ0ID0gJzEwcHgnO1xuICAgICAgICBiYXRpbWVudExlZ2VuZC5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWSgtNTAlKSc7XG4gICAgICAgIGJhdGltZW50TGVnZW5kLnN0eWxlLmJhY2tncm91bmQgPSAnd2hpdGUnO1xuICAgICAgICBiYXRpbWVudExlZ2VuZC5zdHlsZS5wYWRkaW5nID0gJzEwcHgnO1xuICAgICAgICBiYXRpbWVudExlZ2VuZC5zdHlsZS5mb250U2l6ZSA9ICcxMnB4JztcbiAgICAgICAgYmF0aW1lbnRMZWdlbmQuc3R5bGUuYm9yZGVyUmFkaXVzID0gJzRweCc7XG4gICAgICAgIGJhdGltZW50TGVnZW5kLnN0eWxlLmJveFNoYWRvdyA9ICcwIDFweCA0cHggcmdiYSgwLDAsMCwwLjMpJztcbiAgICAgICAgYmF0aW1lbnRMZWdlbmQuc3R5bGUuekluZGV4ID0gJzEnO1xuICAgICAgICBcbiAgICAgICAgLy8gQ29udGVudSBkZSBsYSBsw6lnZW5kZVxuICAgICAgICBiYXRpbWVudExlZ2VuZC5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgPHN0cm9uZz5UeXBlIGRlIGLDonRpbWVudDwvc3Ryb25nPjxicj5cbiAgICAgICAgICA8ZGl2PjxzcGFuIHN0eWxlPVwiYmFja2dyb3VuZDojMWY3N2I0O3dpZHRoOjEycHg7aGVpZ2h0OjEycHg7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luLXJpZ2h0OjVweDtcIj48L3NwYW4+IEFjdGl2aXTDqTwvZGl2PlxuICAgICAgICAgIDxkaXY+PHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kOiMyY2EwMmM7d2lkdGg6MTJweDtoZWlnaHQ6MTJweDtkaXNwbGF5OmlubGluZS1ibG9jazttYXJnaW4tcmlnaHQ6NXB4O1wiPjwvc3Bhbj4gQXBwYXJ0ZW1lbnQ8L2Rpdj5cbiAgICAgICAgICA8ZGl2PjxzcGFuIHN0eWxlPVwiYmFja2dyb3VuZDojZDlkOWQ5O3dpZHRoOjEycHg7aGVpZ2h0OjEycHg7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luLXJpZ2h0OjVweDtcIj48L3NwYW4+IEF1Y3VuIGxvY2FsPC9kaXY+XG4gICAgICAgICAgPGRpdj48c3BhbiBzdHlsZT1cImJhY2tncm91bmQ6Izk0NjdiZDt3aWR0aDoxMnB4O2hlaWdodDoxMnB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO21hcmdpbi1yaWdodDo1cHg7XCI+PC9zcGFuPiBEw6lwZW5kYW5jZTwvZGl2PlxuICAgICAgICAgIDxkaXY+PHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kOiNmZjdmMGU7d2lkdGg6MTJweDtoZWlnaHQ6MTJweDtkaXNwbGF5OmlubGluZS1ibG9jazttYXJnaW4tcmlnaHQ6NXB4O1wiPjwvc3Bhbj4gTWFpc29uPC9kaXY+XG4gICAgICAgICAgPGRpdj48c3BhbiBzdHlsZT1cImJhY2tncm91bmQ6I2UzNzdjMjt3aWR0aDoxMnB4O2hlaWdodDoxMnB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO21hcmdpbi1yaWdodDo1cHg7XCI+PC9zcGFuPiBNaXh0ZTwvZGl2PlxuICAgICAgICBgO1xuICAgICAgICBcbiAgICAgICAgLy8gTOKAmWFqb3V0ZXIgw6AgbGEgY2FydGVcbiAgICAgICAgbWFwLmdldENvbnRhaW5lcigpLmFwcGVuZENoaWxkKGJhdGltZW50TGVnZW5kKTtcbiAgICAgICAgYmF0aW1lbnRMZWdlbmQuc3R5bGUuZGlzcGxheSA9ICdub25lJzsgLy8gUGVybWV0IGRlIHN1cHByaW1lciBsJ2FmZmljaGFnZSBkZSBsYSBsw6lnZW5kZSBhdSBjaGFyZ2VtZW50IGRlIGxhIHBhZ2VcbiAgICAgICAgXG4gICAgICAgIC8vIExpZXIgbGEgdmlzaWJpbGl0w6kgw6AgbGEgY291Y2hlIGLDonRpbWVudFxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVCYXRpbWVudExlZ2VuZFZpc2liaWxpdHkoKSB7XG4gICAgICAgICAgY29uc3QgdmlzaWJpbGl0eSA9IG1hcC5nZXRMYXlvdXRQcm9wZXJ0eSgnYmF0aW1lbnRzTGF5ZXInLCAndmlzaWJpbGl0eScpO1xuICAgICAgICAgIC8vYmF0aW1lbnRMZWdlbmQuc3R5bGUuZGlzcGxheSA9ICh2aXNpYmlsaXR5ID09PSAnbm9uZScpID8gJ25vbmUnIDogJ2Jsb2NrJztcbiAgICAgICAgICBpZiAodmlzaWJpbGl0eSA9PT0gJ25vbmUnKSB7XG4gICAgICAgICAgYmF0aW1lbnRMZWdlbmQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBiYXRpbWVudExlZ2VuZC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBtYXAub24oJ2lkbGUnLCB1cGRhdGVCYXRpbWVudExlZ2VuZFZpc2liaWxpdHkpO1xuICAgICBcbiAgICAvLyBBam91dCBkZXMgY291Y2hlcyB2ZWN0b3JpZWxsZXNcbiAgICAgIGxheWVyc0RhdGEuZm9yRWFjaChsYXllciA9PiB7XG4gICAgICAgIG1hcC5hZGRTb3VyY2UobGF5ZXIuaWQsIHtcbiAgICAgICAgICB0eXBlOiAnZ2VvanNvbicsXG4gICAgICAgICAgZGF0YTogbGF5ZXIuZGF0YVxuICAgICAgICB9KTtcbiAgICAgIFxuICAgICAgICBjb25zdCBsYXllckNvbmZpZyA9IHtcbiAgICAgICAgICBpZDogbGF5ZXIuaWQsXG4gICAgICAgICAgdHlwZTogbGF5ZXIudHlwZSxcbiAgICAgICAgICBzb3VyY2U6IGxheWVyLmlkLFxuICAgICAgICAgIHBhaW50OiB7fSxcbiAgICAgICAgICBsYXlvdXQ6IGxheWVyLmxheW91dFxuICAgICAgICB9O1xuICAgICAgXG4gICAgICAgIGlmIChsYXllci50eXBlID09PSAnZmlsbCcpIHtcbiAgICAgICAgICBpZiAobGF5ZXIuZHluYW1pY0NvbG9yKSB7XG4gICAgICAgICAgICBjb25zdCBwcm9wID0gWydnZXQnLCBsYXllci5keW5hbWljQ29sb3IucHJvcGVydHldO1xuICAgICAgICAgICAgbGF5ZXJDb25maWcucGFpbnRbJ2ZpbGwtY29sb3InXSA9IFtcbiAgICAgICAgICAgICAgJ2Nhc2UnLFxuICAgICAgICAgICAgICBbJyEnLCBbJ2hhcycsIGxheWVyLmR5bmFtaWNDb2xvci5wcm9wZXJ0eV1dLCAnI2Q5ZDlkOScsICAgICAgICAgICAgICAgICAgICAgICAvLyBQcm9wcmnDqXTDqSBhYnNlbnRlXG4gICAgICAgICAgICAgIFsnYW55JywgWyc9PScsIFsnZ2V0JywgbGF5ZXIuZHluYW1pY0NvbG9yLnByb3BlcnR5XSwgbnVsbF0sIFsnPT0nLCBbJ2dldCcsIGxheWVyLmR5bmFtaWNDb2xvci5wcm9wZXJ0eV0sIDBdXSwgJyNkOWQ5ZDknLCAvLyBudWxsIG91IDBcbiAgICAgICAgICAgICAgWyc8JywgWydnZXQnLCBsYXllci5keW5hbWljQ29sb3IucHJvcGVydHldLCAxMF0sICcjZmZmZmZmJyxcbiAgICAgICAgICAgICAgWyc8JywgWydnZXQnLCBsYXllci5keW5hbWljQ29sb3IucHJvcGVydHldLCA1MF0sICcjZmZhYWFhJyxcbiAgICAgICAgICAgICAgWyc8JywgWydnZXQnLCBsYXllci5keW5hbWljQ29sb3IucHJvcGVydHldLCAxMDBdLCAnI2ZmNTU1NScsXG4gICAgICAgICAgICAgIFsnPj0nLCBbJ2dldCcsIGxheWVyLmR5bmFtaWNDb2xvci5wcm9wZXJ0eV0sIDEwMF0sICcjZmYwMDAwJyxcbiAgICAgICAgICAgICAgJyNkOWQ5ZDknIC8vIGZhbGxiYWNrXG4gICAgICAgICAgICBdO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsYXllckNvbmZpZy5wYWludFsnZmlsbC1jb2xvciddID0gbGF5ZXIuY29sb3IgfHwgJyMwMDAwMDAnO1xuICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICAgbGF5ZXJDb25maWcucGFpbnRbJ2ZpbGwtb3BhY2l0eSddID0gbGF5ZXIub3BhY2l0eSB8fCAwLjQ7XG4gICAgICAgICAgbGF5ZXJDb25maWcucGFpbnRbJ2ZpbGwtb3V0bGluZS1jb2xvciddID0gJyMwMDAwMDAnO1xuICAgICAgICBcbiAgICAgICAgfSBlbHNlIGlmIChsYXllci50eXBlID09PSAnbGluZScpIHtcbiAgICAgICAgICBsYXllckNvbmZpZy5wYWludFsnbGluZS1jb2xvciddID0gbGF5ZXIuY29sb3IgfHwgJyMwMDAwMDAnO1xuICAgICAgICAgIGxheWVyQ29uZmlnLnBhaW50WydsaW5lLXdpZHRoJ10gPSBsYXllci53aWR0aCB8fCAxO1xuICAgICAgICB9IGVsc2UgaWYgKGxheWVyLnR5cGUgPT09ICdmaWxsLWV4dHJ1c2lvbicpIHtcbiAgICAgICAgICBpZiAobGF5ZXIuY29sb3JCeVR5cGUgPT09ICdmZl9kdGVsb2N0eHQnKSB7XG4gICAgICAgICAgICBsYXllckNvbmZpZy5wYWludFsnZmlsbC1leHRydXNpb24tY29sb3InXSA9IFtcbiAgICAgICAgICAgICAgJ21hdGNoJyxcbiAgICAgICAgICAgICAgWydnZXQnLCAnZmZfZHRlbG9jdHh0J10sXG4gICAgICAgICAgICAgICdBQ1RJVklURScsICcjMWY3N2I0JyxcbiAgICAgICAgICAgICAgJ0FQUEFSVEVNRU5UJywgJyMyY2EwMmMnLFxuICAgICAgICAgICAgICAnQVVDVU4gTE9DQUwnLCAnI2Q5ZDlkOScsXG4gICAgICAgICAgICAgICdERVBFTkRBTkNFJywgJyM5NDY3YmQnLFxuICAgICAgICAgICAgICAnTUFJU09OJywgJyNmZjdmMGUnLFxuICAgICAgICAgICAgICAnTUlYVEUnLCAnI2UzNzdjMicsXG4gICAgICAgICAgICAgICcjMDAwMDAwJyAvLyBmYWxsYmFja1xuICAgICAgICAgICAgXTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGF5ZXJDb25maWcucGFpbnRbJ2ZpbGwtZXh0cnVzaW9uLWNvbG9yJ10gPSBsYXllci5jb2xvciB8fCAnIzAwMDAwMCc7XG4gICAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgICBsYXllckNvbmZpZy5wYWludFsnZmlsbC1leHRydXNpb24taGVpZ2h0J10gPSBbJ2dldCcsIGxheWVyLmhlaWdodFByb3BlcnR5IHx8ICdoYXV0ZXVyJ107XG4gICAgICAgICAgbGF5ZXJDb25maWcucGFpbnRbJ2ZpbGwtZXh0cnVzaW9uLWJhc2UnXSA9IDA7XG4gICAgICAgICAgbGF5ZXJDb25maWcucGFpbnRbJ2ZpbGwtZXh0cnVzaW9uLW9wYWNpdHknXSA9IGxheWVyLm9wYWNpdHkgfHwgMC45O1xuICAgICAgICB9XG4gICAgICBcbiAgICAgICAgbWFwLmFkZExheWVyKGxheWVyQ29uZmlnKTtcbiAgICAgICAgXG4gICAgICAgIG1hcC5hZGRMYXllcih7XG4gICAgICAgICAgICAgICAgICBpZDogJ2luZGljYXRldXJzMTJhTGFiZWxzJyxcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdzeW1ib2wnLFxuICAgICAgICAgICAgICAgICAgc291cmNlOiAnaW5kaWNhdGV1cnMxMmFMYXllcicsIC8vIGxlIG3Dqm1lIGlkIHF1ZSB0YSBzb3VyY2UgR2VvSlNPTlxuICAgICAgICAgICAgICAgICAgbGF5b3V0OiB7XG4gICAgICAgICAgICAgICAgICAgICd0ZXh0LWZpZWxkJzogWydnZXQnLCAnbm9tJ10sXG4gICAgICAgICAgICAgICAgICAgICd0ZXh0LXNpemUnOiAxMSxcbiAgICAgICAgICAgICAgICAgICAgJ3RleHQtZm9udCc6IFsnT3BlbiBTYW5zIEJvbGQnLCAnQXJpYWwgVW5pY29kZSBNUyBCb2xkJ10sXG4gICAgICAgICAgICAgICAgICAgICd0ZXh0LW9mZnNldCc6IFswLCAwLjZdLFxuICAgICAgICAgICAgICAgICAgICAndGV4dC1hbmNob3InOiAndG9wJ1xuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHBhaW50OiB7XG4gICAgICAgICAgICAgICAgICAgICd0ZXh0LWNvbG9yJzogJyMwMDAwMDAnLFxuICAgICAgICAgICAgICAgICAgICAndGV4dC1oYWxvLWNvbG9yJzogJyNmZmZmZmYnLFxuICAgICAgICAgICAgICAgICAgICAndGV4dC1oYWxvLXdpZHRoJzogMVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIG1hcC5hZGRMYXllcih7XG4gICAgICAgICAgICAgICAgICBpZDogJ2luZGljYXRldXJzMTJhTGFiZWxzJyxcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdzeW1ib2wnLFxuICAgICAgICAgICAgICAgICAgc291cmNlOiAnaW5kaWNhdGV1cnMxMmFMYXllcicsIC8vIGxlIG3Dqm1lIGlkIHF1ZSB0YSBzb3VyY2UgR2VvSlNPTlxuICAgICAgICAgICAgICAgICAgbGF5b3V0OiB7XG4gICAgICAgICAgICAgICAgICAgICd0ZXh0LWZpZWxkJzogWydnZXQnLCAnbm9tJ10sXG4gICAgICAgICAgICAgICAgICAgICd0ZXh0LXNpemUnOiAxMSxcbiAgICAgICAgICAgICAgICAgICAgJ3RleHQtZm9udCc6IFsnT3BlbiBTYW5zIEJvbGQnLCAnQXJpYWwgVW5pY29kZSBNUyBCb2xkJ10sXG4gICAgICAgICAgICAgICAgICAgICd0ZXh0LW9mZnNldCc6IFswLCAwLjZdLFxuICAgICAgICAgICAgICAgICAgICAndGV4dC1hbmNob3InOiAndG9wJ1xuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHBhaW50OiB7XG4gICAgICAgICAgICAgICAgICAgICd0ZXh0LWNvbG9yJzogJyMwMDAwMDAnLFxuICAgICAgICAgICAgICAgICAgICAndGV4dC1oYWxvLWNvbG9yJzogJyNmZmZmZmYnLFxuICAgICAgICAgICAgICAgICAgICAndGV4dC1oYWxvLXdpZHRoJzogMVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICBtYXAuYWRkTGF5ZXIoe1xuICAgICAgICAgICAgICAgICBpZDogJ2luZGljYXRldXJzMTJhLWhvdmVyJyxcbiAgICAgICAgICAgICAgICAgdHlwZTogJ2xpbmUnLFxuICAgICAgICAgICAgICAgICBzb3VyY2U6ICdpbmRpY2F0ZXVyczEyYUxheWVyJywgLy8gbcOqbWUgc291cmNlXG4gICAgICAgICAgICAgICAgIHBhaW50OiB7XG4gICAgICAgICAgICAgICAgICAgJ2xpbmUtY29sb3InOiAnIzAwMCcsXG4gICAgICAgICAgICAgICAgICAgJ2xpbmUtd2lkdGgnOiAyXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICBmaWx0ZXI6IFsnPT0nLCAnbm9tJywgJyddIC8vIHZpZGUgYXUgZMOpYnV0XG4gICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgXG4gICAgICBtYXAub24oJ2NsaWNrJywgJ2luZGljYXRldXJzMTJhTGF5ZXInLCAoZSkgPT4ge1xuICAgICAgICBjb25zdCBmZWF0dXJlID0gZS5mZWF0dXJlc1swXTtcbiAgICAgICAgY29uc3QgaW1hZ2U9IGZlYXR1cmUucHJvcGVydGllcy5pbWFnZTtcbiAgICAgICAgY29uc3Qgbm9tID0gZmVhdHVyZS5wcm9wZXJ0aWVzLm5vbSB8fCAnTm9uIGRpc3BvbmlibGUnO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgcG9wdWxhdGlvbiA9IGZlYXR1cmUucHJvcGVydGllcy5wb3B1bGF0aW9uXG4gICAgICAgID8gZmVhdHVyZS5wcm9wZXJ0aWVzLnBvcHVsYXRpb24udG9Mb2NhbGVTdHJpbmcoJ2ZyLUZSJykgKyAnIGhhYml0YW50cydcbiAgICAgICAgOiAnTm9uIGRpc3BvbmlibGUnO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgczEyYVZhbHVlID0gZmVhdHVyZS5wcm9wZXJ0aWVzLnMxMmEgfHwgJzAnO1xuICAgICAgICBjb25zdCBkb21tYWdlcyA9IChOdW1iZXIoczEyYVZhbHVlKSB8fCAwKS50b0xvY2FsZVN0cmluZygnZnItRlInKTtcbiAgICAgICAgY29uc3QgYmF0aW1lbnRzVmFsdWUgPSBmZWF0dXJlLnByb3BlcnRpZXMubmJfYmF0aW1lbnRzO1xuICAgICAgICBjb25zdCBiYXRpbWVudHMgPSAhaXNOYU4ocGFyc2VGbG9hdChiYXRpbWVudHNWYWx1ZSkpXG4gICAgICAgICAgPyBwYXJzZUludChiYXRpbWVudHNWYWx1ZSkudG9Mb2NhbGVTdHJpbmcoJ2ZyLUZSJylcbiAgICAgICAgICA6ICdOb24gZGlzcG9uaWJsZSc7XG4gICAgICAgIGNvbnN0IGJhdGluZGlmID0gZmVhdHVyZS5wcm9wZXJ0aWVzLm5iX2JhdF9pbmRpZj8udG9Mb2NhbGVTdHJpbmcoJ2ZyLUZSJyk7XG4gICAgICAgIGNvbnN0IGJhdHNwb3J0aWZWYWx1ZSA9IHBhcnNlRmxvYXQoZmVhdHVyZS5wcm9wZXJ0aWVzLm5iX2JhdF9zcG9ydGlmKTtcbiAgICAgICAgY29uc3QgYmF0c3BvcnRpZiA9ICghaXNOYU4oYmF0c3BvcnRpZlZhbHVlKSA/IGJhdHNwb3J0aWZWYWx1ZSA6IDApLnRvTG9jYWxlU3RyaW5nKCdmci1GUicpO1xuICAgICAgICBjb25zdCBiYXRhZ3JpY29sZWZWYWx1ZSA9IHBhcnNlRmxvYXQoZmVhdHVyZS5wcm9wZXJ0aWVzLm5iX2JhdF9hZ3JpY29sZSk7XG4gICAgICAgIGNvbnN0IGJhdGFncmljb2xlID0gKCFpc05hTihiYXRhZ3JpY29sZWZWYWx1ZSkgPyBiYXRhZ3JpY29sZWZWYWx1ZSA6IDApLnRvTG9jYWxlU3RyaW5nKCdmci1GUicpO1xuICAgICAgICBjb25zdCBiYXRyZXNpZGVudGllbFZhbHVlID0gcGFyc2VGbG9hdChmZWF0dXJlLnByb3BlcnRpZXMubmJfYmF0X3Jlc2lkZW50aWVsKTtcbiAgICAgICAgY29uc3QgYmF0cmVzaWRlbnRpZWwgPSAoIWlzTmFOKGJhdHJlc2lkZW50aWVsVmFsdWUpID8gYmF0cmVzaWRlbnRpZWxWYWx1ZSA6IDApLnRvTG9jYWxlU3RyaW5nKCdmci1GUicpO1xuICAgICAgICBjb25zdCBiYXRhbm5leGVWYWx1ZSA9IHBhcnNlRmxvYXQoZmVhdHVyZS5wcm9wZXJ0aWVzLm5iX2JhdF9hbm5leGUpO1xuICAgICAgICBjb25zdCBiYXRhbm5leGUgPSAoIWlzTmFOKGJhdGFubmV4ZVZhbHVlKSA/IGJhdGFubmV4ZVZhbHVlIDogMCkudG9Mb2NhbGVTdHJpbmcoJ2ZyLUZSJyk7XG4gICAgICAgIGNvbnN0IGJhdHJlbGlnaWV1eFZhbHVlID0gcGFyc2VGbG9hdChmZWF0dXJlLnByb3BlcnRpZXMubmJfYmF0X3JlbGlnaWV1eCk7XG4gICAgICAgIGNvbnN0IGJhdHJlbGlnaWV1eCA9ICghaXNOYU4oYmF0cmVsaWdpZXV4VmFsdWUpID8gYmF0cmVsaWdpZXV4VmFsdWUgOiAwKS50b0xvY2FsZVN0cmluZygnZnItRlInKTtcbiAgICAgICAgY29uc3QgYmF0aW5kdXN0cmllbFZhbHVlID0gcGFyc2VGbG9hdChmZWF0dXJlLnByb3BlcnRpZXMubmJfYmF0X2luZHVzdHJpZWwpO1xuICAgICAgICBjb25zdCBiYXRpbmR1c3RyaWVsID0gKCFpc05hTihiYXRpbmR1c3RyaWVsVmFsdWUpID8gYmF0aW5kdXN0cmllbFZhbHVlIDogMCkudG9Mb2NhbGVTdHJpbmcoJ2ZyLUZSJyk7XG4gICAgICAgIGNvbnN0IGJhdGNvbW1lcmNpYWxWYWx1ZSA9IHBhcnNlRmxvYXQoZmVhdHVyZS5wcm9wZXJ0aWVzLm5iX2JhdF9jb21tZXJjaWFsKTtcbiAgICAgICAgY29uc3QgYmF0Y29tbWVyY2lhbCA9ICghaXNOYU4oYmF0Y29tbWVyY2lhbFZhbHVlKSA/IGJhdGNvbW1lcmNpYWxWYWx1ZSA6IDApLnRvTG9jYWxlU3RyaW5nKCdmci1GUicpO1xuICAgICAgXG4gICAgICAgIGNvbnN0IHBvcHVwQ29udGVudCA9IGBcbiAgICAgICAgPHN0eWxlPlxuICAgICAgICAgIC5tYXBsaWJyZWdsLXBvcHVwLWNvbnRlbnQge1xuICAgICAgICAgICAgcGFkZGluZzogNHB4ICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZDtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDtcbiAgICAgICAgICAgIHdpZHRoOiAyNzBweDtcbiAgICAgICAgICAgIGJveC1zaGFkb3c6IHJnYmEoMTAxLCAxNDcsIDIyMCwgMC4yKSAwcHggNHB4IDhweCAwcHg7XG4gICAgICAgICAgICBib3JkZXItY29sb3I6IHJnYmEoMTAxLCAxNDcsIDIyMCwgMC41KTtcbiAgICAgICAgICB9XG4gICAgICAgIDwvc3R5bGU+XG4gICAgICAgICAgIDxkaXYgc3R5bGU9XCJmb250LWZhbWlseTogc2Fucy1zZXJpZjsgZm9udC1zaXplOiAxM3B4OyBtYXJnaW46MTBweDtcIj5cbiAgICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogI2QxZWU5YzsgYm9yZGVyOiAxcHggc29saWQ7IGJvcmRlci1yYWRpdXM6OHB4OyBtYXJnaW4tYm90dG9tOjE2cHg7IHBhZGRpbmc6MTBweDtcIj48c3Ryb25nPlxuICAgICAgICAgIDxjZW50ZXI+JHtub219PC9jZW50ZXI+XG4gICAgICAgICAgPC9zdHJvbmc+PC9kaXY+XG4gICAgICAgICAgPHAgc3R5bGU9XCJ0ZXh0LWFsaWduOmNlbnRlciAhaW1wb3J0YW50XCI+PHN0cm9uZz4tIFBvcHVsYXRpb24gOjwvc3Ryb25nPiAke3BvcHVsYXRpb259PC9wPlxuICAgICAgICAgIDxwIHN0eWxlPVwidGV4dC1hbGlnbjpjZW50ZXIgIWltcG9ydGFudFwiPjxzdHJvbmc+LSBOb21icmUgZGUgcGVyc29ubmVzIGVuIHpvbmUgZm9ydGVtZW50IGlub25kYWJsZSA6PC9zdHJvbmc+ICR7ZG9tbWFnZXN9PC9wPlxuICAgICAgICBgO1xuICAgICAgXG4gICAgICAgIG5ldyBtYXBsaWJyZWdsLlBvcHVwKHtjbG9zZUJ1dHRvbjogZmFsc2V9KVxuICAgICAgICAgIC5zZXRMbmdMYXQoZS5sbmdMYXQpXG4gICAgICAgICAgLnNldEhUTUwocG9wdXBDb250ZW50KVxuICAgICAgICAgIC5hZGRUbyhtYXApO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIE1ldHRyZSDDoCBqb3VyIGxlIGNvbnRlbmV1ciBIVE1MIGF2ZWMgbGVzIGluZm9ybWF0aW9ucyBzcMOpY2lmaXF1ZXMgZHUgbWFycXVldXIgXG4gICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZG9ubmVlcycpLmlubmVySFRNTCA9IGBcbiAgICAgICAgICA8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjpjZW50ZXI7IGZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7IGZvbnQtc2l6ZToxNnB4O1wiPlxuICAgICAgICAgICAgPGltZyBzcmM9XCIke2ltYWdlfVwiIHN0eWxlPVwid2lkdGg6MzAwcHg7IG1hcmdpbi1ib3R0b206MTBweDtcIj48YnI+XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIDxzdHJvbmcgc3R5bGU9XCJmb250LXNpemU6MS4xZW07XCI+PGkgY2xhc3M9XCJiaSBiaS1nZW8tYWx0LWZpbGxcIj48L2k+IENvbW11bmUgOjwvc3Ryb25nPiAke25vbX08YnI+XG4gICAgICAgICAgICA8c3Ryb25nIHN0eWxlPVwiZm9udC1zaXplOjEuMWVtO1wiPjxpIGNsYXNzPVwiYmkgYmktcGVvcGxlLWZpbGxcIj48L2k+IE5vbWJyZSBkJ2hhYml0YW50cyA6PC9zdHJvbmc+ICR7cG9wdWxhdGlvbn08YnI+XG4gICAgICAgICAgICA8c3Ryb25nIHN0eWxlPVwiZm9udC1zaXplOjEuMWVtO1wiPjxpIGNsYXNzPVwiYmkgYmktaG91c2UtZmlsbFwiPjwvaT4gTm9tYnJlIGRlIGLDonRpbWVudHMgOjwvc3Ryb25nPiAke2JhdGltZW50c308YnI+XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJtYXJnaW4tdG9wOjEwcHg7XCI+PHN0cm9uZz5Eb250IDo8L3N0cm9uZz48L2Rpdj5cbiAgICAgICAgICAgIDx1bCBzdHlsZT1cImxpc3Qtc3R5bGU6bm9uZTsgcGFkZGluZzowO1wiPlxuICAgICAgICAgICAgICA8bGk+PGg1IHN0eWxlPVwiZm9udC1zaXplOjFlbTtcIj4ke2JhdGluZGlmfSA8c3Ryb25nPmLDonRpbWVudHMgaW5kaWZmw6lyZW5jacOpczwvc3Ryb25nPjwvaDU+PC9saT5cbiAgICAgICAgICAgICAgPGxpPjxoNSBzdHlsZT1cImZvbnQtc2l6ZToxZW07XCI+JHtiYXRzcG9ydGlmfSA8c3Ryb25nPmLDonRpbWVudHMgc3BvcnRpZnM8L3N0cm9uZz48L2g1PjwvbGk+XG4gICAgICAgICAgICAgIDxsaT48aDUgc3R5bGU9XCJmb250LXNpemU6MWVtO1wiPiR7YmF0YWdyaWNvbGV9IDxzdHJvbmc+YsOidGltZW50cyBhZ3JpY29sZXM8L3N0cm9uZz48L2g1PjwvbGk+XG4gICAgICAgICAgICAgIDxsaT48aDUgc3R5bGU9XCJmb250LXNpemU6MWVtO1wiPiR7YmF0cmVzaWRlbnRpZWx9IDxzdHJvbmc+YsOidGltZW50cyByw6lzaWRlbnRpZWxzPC9zdHJvbmc+PC9oNT48L2xpPlxuICAgICAgICAgICAgICA8bGk+PGg1IHN0eWxlPVwiZm9udC1zaXplOjFlbTtcIj4ke2JhdGFubmV4ZX0gPHN0cm9uZz5iw6J0aW1lbnRzIGFubmV4ZXM8L3N0cm9uZz48L2g1PjwvbGk+XG4gICAgICAgICAgICAgIDxsaT48aDUgc3R5bGU9XCJmb250LXNpemU6MWVtO1wiPiR7YmF0cmVsaWdpZXV4fSA8c3Ryb25nPmLDonRpbWVudHMgcmVsaWdpZXV4PC9zdHJvbmc+PC9oNT48L2xpPlxuICAgICAgICAgICAgICA8bGk+PGg1IHN0eWxlPVwiZm9udC1zaXplOjFlbTtcIj4ke2JhdGluZHVzdHJpZWx9IDxzdHJvbmc+YsOidGltZW50cyBpbmR1c3RyaWVsczwvc3Ryb25nPjwvaDU+PC9saT5cbiAgICAgICAgICAgICAgPGxpPjxoNSBzdHlsZT1cImZvbnQtc2l6ZToxZW07XCI+JHtiYXRjb21tZXJjaWFsfSA8c3Ryb25nPmLDonRpbWVudHMgY29tbWVyY2lhdXg8L3N0cm9uZz48L2g1PjwvbGk+XG4gICAgICAgICAgICA8L3VsPlxuICAgICAgICBcbiAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJtYXJnaW4tdG9wOjEwcHg7XCI+XG4gICAgICAgICAgICAgIDxzdHJvbmcgc3R5bGU9XCJmb250LXNpemU6MS4xZW07XCI+PGkgY2xhc3M9XCJiaSBiaS1kcm9wbGV0LWhhbGZcIj48L2k+IE5vbWJyZSBkZSBwZXJzb25uZXMgZW4gem9uZSBmb3J0ZW1lbnQgaW5vbmRhYmxlIDo8L3N0cm9uZz4gJHtkb21tYWdlc31cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgYDtcbiAgICAgIH0pO1xuXG4gICAgICBtYXAub24oJ21vdXNlbW92ZScsICdpbmRpY2F0ZXVyczEyYUxheWVyJywgKGUpID0+IHtcbiAgICAgICAgaWYgKGUuZmVhdHVyZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IG5vbUNvbW11bmUgPSBlLmZlYXR1cmVzWzBdLnByb3BlcnRpZXMubm9tO1xuICAgICAgXG4gICAgICAgICAgbWFwLnNldEZpbHRlcignaW5kaWNhdGV1cnMxMmEtaG92ZXInLCBbJz09JywgJ25vbScsIG5vbUNvbW11bmVdKTtcbiAgICAgIFxuICAgICAgICAgIG1hcC5nZXRDYW52YXMoKS5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAgIG1hcC5vbignbW91c2VsZWF2ZScsICdpbmRpY2F0ZXVyczEyYUxheWVyJywgKCkgPT4ge1xuICAgICAgICAgIG1hcC5zZXRGaWx0ZXIoJ2luZGljYXRldXJzMTJhLWhvdmVyJywgWyc9PScsICdub20nLCAnJ10pO1xuICAgICAgICAgIG1hcC5nZXRDYW52YXMoKS5zdHlsZS5jdXJzb3IgPSAnJztcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICBcblxuICAgIC8vIEludGVyZmFjZSBkZSBjb250csO0bGUgZGVzIGNvdWNoZXNcbiAgICBjb25zdCBtYXBMYXllcnNEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBtYXBMYXllcnNEaXYuY2xhc3NMaXN0LmFkZCgnbWFwTGF5ZXJzJyk7XG4gICAgbWFwTGF5ZXJzRGl2LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICBtYXBMYXllcnNEaXYuc3R5bGUuekluZGV4ID0gJzEwMDAnO1xuICAgIG1hcExheWVyc0Rpdi5pbm5lckhUTUwgPSBgXG4gICAgICA8YnV0dG9uIGlkPVwidG9nZ2xlTWFwTWVudUJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1saWdodCBhcmlhLWxhYmVsPVwiQWZmaWNoZXIgbGVzIGNvdWNoZXNcIiB0aXRsZT1cIkFmZmljaGVyIGxlcyBjb3VjaGVzXCI+XG4gICAgICAgIDxpbWcgc3JjPVwiSW1hZ2VzL2ljb25zL2xheWVycy1oYWxmLnN2Z1wiIGFsdD1cIkljw7RuZSBTVkdcIiB3aWR0aD1cIjI1XCIgaGVpZ2h0PVwiMjVcIj5cbiAgICAgIDwvYnV0dG9uPlxuICAgICAgPGRpdiBpZD1cImxheWVyc0xpc3RcIiBzdHlsZT1cImRpc3BsYXk6IG5vbmU7IGJhY2tncm91bmQ6IHdoaXRlOyBwYWRkaW5nOiAxMHB4OyBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1wiPjwvZGl2PlxuICAgIGA7XG4gICAgbWFwLmdldENvbnRhaW5lcigpLmFwcGVuZENoaWxkKG1hcExheWVyc0Rpdik7XG5cbiAgICBjb25zdCB0b2dnbGVhYmxlTGF5ZXJJZHMgPSBsYXllcnNEYXRhLm1hcChsYXllciA9PiBsYXllci5pZCk7XG4gICAgY29uc3QgYWxpYXNMYXllcklkcyA9IHtcbiAgICAgIGJhc3NpbnZpZW5uZUxheWVyOiAnQmFzc2luIGRlIGxhIFZpZW5uZScsXG4gICAgICByZWdpb25MYXllcjogJ1LDqWdpb24nLFxuICAgICAgZGVwYXJ0ZW1lbnRMYXllcjogJ0TDqXBhcnRlbWVudCcsXG4gICAgICBlcGNpTGF5ZXI6ICdFUENJJyxcbiAgICAgIHpvbmVpbm9uZGFibGVMYXllcjogJ1pvbmFnZSBJbm9uZGFibGUnLFxuICAgICAgY291cnNkZWF1TGF5ZXI6IFwiQ291cnMgZCdlYXVcIixcbiAgICAgIGluZGljYXRldXJzMTJhTGF5ZXI6ICdCw6J0aW1lbnRzIGRlIHBsYWluLXBpZWQnLFxuICAgICAgYmF0aW1lbnRzTGF5ZXI6IFwiQsOidGltZW50c1wiXG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHRvZ2dsZUxheWVyVmlzaWJpbGl0eShpZCwgdmlzaWJsZSkge1xuICAgICAgY29uc3QgdmlzaWJpbGl0eSA9IHZpc2libGUgPyAndmlzaWJsZScgOiAnbm9uZSc7XG4gICAgICBpZiAobWFwLmdldExheWVyKGlkKSkge1xuICAgICAgICBtYXAuc2V0TGF5b3V0UHJvcGVydHkoaWQsICd2aXNpYmlsaXR5JywgdmlzaWJpbGl0eSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgbGF5ZXJzTGlzdERpdiA9IG1hcExheWVyc0Rpdi5xdWVyeVNlbGVjdG9yKCcjbGF5ZXJzTGlzdCcpO1xuICAgIFxuICAgIHRvZ2dsZWFibGVMYXllcklkcy5mb3JFYWNoKGlkID0+IHtcbiAgICAgIGNvbnN0IG5hbWUgPSBhbGlhc0xheWVySWRzW2lkXSB8fCBpZDtcblxuICAgICAgY29uc3QgY2hlY2tib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgY2hlY2tib3gudHlwZSA9ICdjaGVja2JveCc7XG4gICAgICBjaGVja2JveC5pZCA9IGlkO1xuICAgICAgY2hlY2tib3guY2xhc3NOYW1lID0gJ2Zvcm0tY2hlY2staW5wdXQnO1xuICAgICAgXG4gICAgICAvLyDinIUgTGlyZSBsYSB2aXNpYmlsaXTDqSBhY3R1ZWxsZSBkaXJlY3RlbWVudCBkYW5zIGxhIGNhcnRlXG4gICAgICBtYXAub25jZSgnaWRsZScsICgpID0+IHtcbiAgICAgICAgY29uc3QgdmlzaWJpbGl0eSA9IG1hcC5nZXRMYXlvdXRQcm9wZXJ0eShpZCwgJ3Zpc2liaWxpdHknKTtcbiAgICAgICAgY2hlY2tib3guY2hlY2tlZCA9IHZpc2liaWxpdHkgPT09ICd2aXNpYmxlJztcbiAgICAgIH0pO1xuICBcbiAgICAgIGNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHRvZ2dsZUxheWVyVmlzaWJpbGl0eShpZCwgY2hlY2tib3guY2hlY2tlZCkpO1xuXG4gICAgICBjb25zdCBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XG4gICAgICBsYWJlbC5odG1sRm9yID0gaWQ7XG4gICAgICBsYWJlbC5jbGFzc05hbWUgPSAnZm9ybS1jaGVjay1sYWJlbCc7XG4gICAgICBsYWJlbC5pbm5lclRleHQgPSBuYW1lO1xuXG4gICAgICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICB3cmFwcGVyLmNsYXNzTmFtZSA9ICdmb3JtLWNoZWNrJztcbiAgICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoY2hlY2tib3gpO1xuICAgICAgd3JhcHBlci5hcHBlbmRDaGlsZChsYWJlbCk7XG5cbiAgICAgIGxheWVyc0xpc3REaXYuYXBwZW5kQ2hpbGQod3JhcHBlcik7XG4gICAgfSk7XG5cbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9nZ2xlTWFwTWVudUJ1dHRvbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgbGF5ZXJzTGlzdERpdi5zdHlsZS5kaXNwbGF5ID0gbGF5ZXJzTGlzdERpdi5zdHlsZS5kaXNwbGF5ID09PSAnbm9uZScgPyAnYmxvY2snIDogJ25vbmUnO1xuICAgIH0pO1xuICAgICBcblxuICAgIC8vIE1lbnUgYmFzY3VsZSBmb25kIGRlIHBsYW5cbiAgICBjb25zdCBtYXBNZW51RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgbWFwTWVudURpdi5jbGFzc0xpc3QuYWRkKCdtYXBGb25kRGVQbGFuJyk7XG4gICAgbWFwTWVudURpdi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgbWFwTWVudURpdi5zdHlsZS56SW5kZXggPSAnMTAwMCc7XG4gICAgbWFwTWVudURpdi5pbm5lckhUTUwgPSBgXG4gICAgICA8c3Ryb25nPkZvbmQgZGUgcGxhbiA6PC9zdHJvbmc+XG4gICAgICA8ZGl2IGNsYXNzPVwiZm9ybS1jaGVjayBmb3JtLXN3aXRjaFwiPlxuICAgICAgICA8aW5wdXQgY2xhc3M9XCJmb3JtLWNoZWNrLWlucHV0XCIgdHlwZT1cImNoZWNrYm94XCIgcm9sZT1cInN3aXRjaFwiIGlkPVwib3J0aG9DaGVja2JveFwiPlxuICAgICAgICA8bGFiZWwgY2xhc3M9XCJmb3JtLWNoZWNrLWxhYmVsXCIgZm9yPVwib3J0aG9DaGVja2JveFwiPlBob3RvcyBhw6lyaWVubmVzPC9sYWJlbD5cbiAgICAgIDwvZGl2PlxuICAgIGA7XG4gICAgbWFwLmdldENvbnRhaW5lcigpLmFwcGVuZENoaWxkKG1hcE1lbnVEaXYpO1xuXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29ydGhvQ2hlY2tib3gnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIHRvZ2dsZVN0eWxlKHRoaXMuY2hlY2tlZCk7XG4gICAgfSk7XG4gIH0pO1xufTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYFxuXG48dGFibGUgc3R5bGU9XCJ3aWR0aDo5MCU7IGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7IGJvcmRlcjoxcHggc29saWQ7IHRleHQtYWxpZ246Y2VudGVyOyBtYXJnaW46YXV0bztcIj5cbiAgPGNvbGdyb3VwPlxuICAgIDxjb2wgc3R5bGU9XCJ3aWR0aDoyMCU7XCI+XG4gICAgPGNvbCBzdHlsZT1cIndpZHRoOjIwJTtcIj5cbiAgICA8Y29sIHN0eWxlPVwid2lkdGg6MjAlO1wiPlxuICAgIDxjb2wgc3R5bGU9XCJ3aWR0aDoyMCU7XCI+XG4gICAgPGNvbCBzdHlsZT1cIndpZHRoOjIwJTtcIj5cbiAgPC9jb2xncm91cD5cbiAgPHRyPlxuICAgIDx0aCBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6YmlzcXVlOyBib3JkZXI6MXB4IHNvbGlkO1wiIGNvbHNwYW49XCIyXCI+TnVtw6lybyBkJ2luZGljYXRldXI8L3RoPlxuICAgIDx0aCBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+SW5kMS8yYTwvdGg+XG4gICAgPHRoIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjpiaXNxdWU7IGJvcmRlcjoxcHggc29saWQ7XCI+RGF0ZSBkZSBtaXNlIMOgIGpvdXI8L3RoPlxuICAgIDx0aCBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+MzEvMDUvMjAyNTwvdGg+XG4gIDwvdHI+XG4gIDx0cj5cbiAgICA8dGQgY29sc3Bhbj1cIjJcIiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6YmlzcXVlOyBib3JkZXI6MXB4IHNvbGlkOyBmb250LXdlaWdodDogYm9sZDtcIj5JbnRpdHVsw6k8L3RkPlxuICAgIDx0ZCBjb2xzcGFuPVwiM1wiIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5Ob21icmUgZGUgcGVyc29ubmVzIG9jY3VwYW50IGRlcyBiw6J0aW1lbnRzIChsb2dlbWVudHMgZXQgYWN0aXZpdMOpcykgZGUgcGxhaW4tcGllZFxuICAgICAgICBmb3J0ZW1lbnQgaW5vbmRhYmxlcyAocGx1cyBkZSAxLDUgbSBk4oCZZWF1KTwvdGQ+XG4gIDwvdHI+XG4gIDx0cj5cbiAgICA8dGQgY29sc3Bhbj1cIjJcIiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6YmlzcXVlOyBib3JkZXI6MXB4IHNvbGlkOyBmb250LXdlaWdodDogYm9sZDtcIj5PYmplY3RpZiBkZSBsYSBTTkdSSTwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIzXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPk9iamVjdGlmIG7CsDEgOiBBdWdtZW50ZXIgbGEgc8OpY3VyaXTDqSBkZXMgcG9wdWxhdGlvbnMgZXhwb3PDqWVzPC90ZD5cbiAgPC90cj5cbiAgPHRyPlxuICAgIDx0ZCBjb2xzcGFuPVwiMlwiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjpiaXNxdWU7IGJvcmRlcjoxcHggc29saWQ7IGZvbnQtd2VpZ2h0OiBib2xkO1wiPkF4ZSBkZSB2dWxuw6lyYWJpbGl0w6k8L3RkPlxuICAgIDx0ZCBjb2xzcGFuPVwiM1wiIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5BeGUgMS8xIExhIG1pc2UgZW4gZGFuZ2VyIGRlcyBwZXJzb25uZXMgYXUgc2VpbiBkZXMgYsOidGltZW50czwvdGQ+XG4gIDwvdHI+XG4gIDx0cj5cbiAgICA8dGQgY29sc3Bhbj1cIjJcIiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6YmlzcXVlOyBib3JkZXI6MXB4IHNvbGlkOyBmb250LXdlaWdodDogYm9sZDtcIj5Tb3VyY2UgZGUgdnVsbsOpcmFiaWxpdMOpPC90ZD5cbiAgICA8dGQgY29sc3Bhbj1cIjNcIiBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+UzEvMiBJbm9uZGF0aW9uIGRlIGLDonRpbWVudHMgZXQgcmlzcXVlIGRlIHJ1cHR1cmUgZGVzIG91dnJhbnRzIGRhbnMgbGVzIHpvbmVzIHBvdXZhbnRcbiAgICAgICAgY29tcG9ydGVyIHVuZSBoYXV0ZXVyIGTigJllYXUgaW1wb3J0YW50ZTwvdGQ+XG4gIDwvdHI+XG48L3RhYmxlPlxuXG48YnI+XG5cbjx0YWJsZSBzdHlsZT1cIndpZHRoOjkwJTsgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsgYm9yZGVyOjFweCBzb2xpZDsgdGV4dC1hbGlnbjpjZW50ZXI7IG1hcmdpbjphdXRvO1wiPlxuICA8Y29sZ3JvdXA+XG4gICAgPGNvbCBzdHlsZT1cIndpZHRoOjIwJTtcIj5cbiAgICA8Y29sIHN0eWxlPVwid2lkdGg6MjAlO1wiPlxuICAgIDxjb2wgc3R5bGU9XCJ3aWR0aDoyMCU7XCI+XG4gICAgPGNvbCBzdHlsZT1cIndpZHRoOjIwJTtcIj5cbiAgICA8Y29sIHN0eWxlPVwid2lkdGg6MjAlO1wiPlxuICA8L2NvbGdyb3VwPlxuICA8dHI+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOmJpc3F1ZTsgYm9yZGVyOjFweCBzb2xpZDsgZm9udC13ZWlnaHQ6IGJvbGQ7XCI+TW9kYWxpdMOpcyBkdSBjYWxjdWw8L3RkPlxuICAgIDx0ZCBjb2xzcGFuPVwiM1wiIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5PbiBzw6lsZWN0aW9ubmUgbGVzIGLDonRpbWVudHMgKGhhYml0YXRpb24gb3UgYWN0aXZpdMOpKSBkZSBwbGFpbi1waWVkIHF1aSBpbnRlcnNlY3RlbnQgbGEgXG4gICAgICAgIHpvbmUgZOKAmWFsw6lhIHN1cMOpcmlldXJlIMOgIDEsNSBtIGV0IG9uIGNvbXB0YWJpbGlzZSBsZSBub21icmUgZGUgcGVyc29ubmVzIChoYWJpdGFudHMgb3UgZW1wbG95w6lzKS4gTGUgcsOpc3VsdGF0IGVzdCBlbnN1aXRlIFxuICAgICAgICBhZ3LDqWfDqSDDoCBsYSBjb21tdW5lLjwvdGQ+XG4gIDwvdHI+XG4gIDx0cj5cbiAgICA8dGQgY29sc3Bhbj1cIjJcIiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6YmlzcXVlOyBib3JkZXI6MXB4IHNvbGlkOyBmb250LXdlaWdodDogYm9sZDtcIj7DiWNoZWxsZSBkZSByZXByw6lzZW50YXRpb248L3RkPlxuICAgIDx0ZCBjb2xzcGFuPVwiM1wiIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5Db21tdW5hbGU8L3RkPlxuICA8L3RyPlxuICA8dHI+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOmJpc3F1ZTsgYm9yZGVyOjFweCBzb2xpZDsgZm9udC13ZWlnaHQ6IGJvbGQ7XCI+UG9pbnRzIGRlIHZpZ2lsYW5jZTwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIzXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPlBvdXIgbGVzIGVmZmVjdGlmcyBkZXMgZW1wbG95w6lzLCBsZXMgdmFsZXVycyByZW5zZWlnbsOpZXMgZGFucyBTSVJFTiBzb250IGRlcyBmb3VyY2hldHRlcyAgICAgICAgIGRlIHZhbGV1cnMgaGF1dGVzIGV0IGJhc3Nlcy4gSWNpLCBsZSBjaG9peCBkZSBwcmVuZHJlIGxhIHZhbGV1ciBoYXV0ZSBhIMOpdMOpIHJldGVudSBwb3VyIMOpdml0ZXIgZGUgbWluaW1pc2VyIGxlIHRvdGFsLlxuICAgICAgICBMb3JzIGRlIGzigJlhZmZlY3RhdGlvbiBkZXMgcGVyc29ubmVzIGF1IGLDonRpbWVudCwgcG91ciBkZXMgY2FycmVhdXggw6AgZmFpYmxlIGRlbnNpdMOpIGRlIHBlcnNvbm5lcywgZGVzIHZhbGV1cnMgZMOpY2ltYWxlcyBvbnQgcHUgICAgICAgICDDqnRyZSBhdHRyaWJ1w6llcyBhdXggYsOidGltZW50cy48L3RkPlxuICA8L3RyPlxuICA8dHI+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOmJpc3F1ZTsgYm9yZGVyOjFweCBzb2xpZDsgZm9udC13ZWlnaHQ6IGJvbGQ7XCI+VGFibGUgY2libGU8L3RkPlxuICAgIDx0ZCBjb2xzcGFuPVwiM1wiIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5wX29iajFfc2VjdXJpdGVfcGVyc29ubmVzLiBzMTJhX3BvcF9wbGFpbnBpZWRfemlfZm9ydDwvdGQ+XG4gIDwvdHI+XG4gIDx0cj5cbiAgPHRyPlxuICAgIDx0ZCBjb2xzcGFuPVwiMlwiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjpiaXNxdWU7IGJvcmRlcjoxcHggc29saWQ7IGZvbnQtd2VpZ2h0OiBib2xkO1wiPlZhcmlhYmxlcyBtb2JpbGlzw6llczwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIzXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPlpkIDogaGF1dGV1ciBk4oCZZWF1ID4gMS41bSxcbiAgICAgICAgUG9wMSA6IGhhYml0YW50cyxcbiAgICAgICAgUG9wMiA6IGVtcGxvecOpczwvdGQ+XG4gIDwvdHI+XG4gIDx0cj5cbiAgPHRyPlxuICAgIDx0ZCBjb2xzcGFuPVwiMlwiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjpiaXNxdWU7IGJvcmRlcjoxcHggc29saWQ7IGZvbnQtd2VpZ2h0OiBib2xkO1wiPkluZGljYXRldXIgY29tbXVuIFNMR1JJIFZpZW5uZS9DbGFpbjwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIzXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPm5vbjwvdGQ+XG4gIDwvdHI+XG4gIDx0cj5cbjwvdGFibGU+XG5cbjxicj5cblxuPHRhYmxlIHN0eWxlPVwid2lkdGg6OTAlOyBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOyBib3JkZXI6MXB4IHNvbGlkOyB0ZXh0LWFsaWduOmNlbnRlcjsgbWFyZ2luOmF1dG87XCI+XG4gIDxjb2xncm91cD5cbiAgICA8Y29sIHN0eWxlPVwid2lkdGg6MTAlO1wiPlxuICAgIDxjb2wgc3R5bGU9XCJ3aWR0aDoxMCU7XCI+XG4gICAgPGNvbCBzdHlsZT1cIndpZHRoOjEwJTtcIj5cbiAgICA8Y29sIHN0eWxlPVwid2lkdGg6MTAlO1wiPlxuICAgIDxjb2wgc3R5bGU9XCJ3aWR0aDoxMCU7XCI+XG4gICAgPGNvbCBzdHlsZT1cIndpZHRoOjEwJTtcIj5cbiAgICA8Y29sIHN0eWxlPVwid2lkdGg6MTAlO1wiPlxuICAgIDxjb2wgc3R5bGU9XCJ3aWR0aDoxMCU7XCI+XG4gICAgPGNvbCBzdHlsZT1cIndpZHRoOjEwJTtcIj5cbiAgICA8Y29sIHN0eWxlPVwid2lkdGg6MTAlO1wiPlxuICA8L2NvbGdyb3VwPlxuXG4gIDx0cj5cbiAgICA8dGQgY29sc3Bhbj1cIjEwXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOmJpc3F1ZTsgYm9yZGVyOjFweCBzb2xpZDsgZm9udC13ZWlnaHQ6IGJvbGQ7XCI+RG9ubsOpZXMgc291cmNlczwvdGQ+XG4gIDwvdHI+XG4gIDx0cj5cbiAgICA8dGggc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOmJpc3F1ZTsgYm9yZGVyOjFweCBzb2xpZDtcIiBjb2xzcGFuPVwiMlwiPkTDqXNpZ25hdGlvbjwvdGg+XG4gICAgPHRoIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjpiaXNxdWU7IGJvcmRlcjoxcHggc29saWQ7XCI+TWlsbMOpc2ltZTwvdGg+XG4gICAgPHRoIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjpiaXNxdWU7IGJvcmRlcjoxcHggc29saWQ7XCI+TmF0aW9uYWxlL2xvY2FsZTwvdGg+XG4gICAgPHRoIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjpiaXNxdWU7IGJvcmRlcjoxcHggc29saWQ7XCI+Rm9ybWF0PC90aD5cbiAgICA8dGggc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOmJpc3F1ZTsgYm9yZGVyOjFweCBzb2xpZDtcIj5UeXBlPC90aD5cbiAgICA8dGggc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOmJpc3F1ZTsgYm9yZGVyOjFweCBzb2xpZDtcIiBjb2xzcGFuPVwiMlwiPlByb2R1Y3RldXI8L3RoPlxuICAgIDx0aCBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6YmlzcXVlOyBib3JkZXI6MXB4IHNvbGlkO1wiIGNvbHNwYW49XCIyXCI+Tm9tIGZpY2hpZXI8L3RoPlxuICA8L3RyPlxuICA8dHI+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPkhhdXRldXIgZOKAmWVhdSA+MS41bTwvdGQ+XG4gICAgPHRkIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj4yMDE5PC90ZD5cbiAgICA8dGQgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPkxvY2FsZTwvdGQ+XG4gICAgPHRkIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5TaGFwZTwvdGQ+XG4gICAgPHRkIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5Qb2x5Z29uZTwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPkNlcmVtYTwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPnpkX3N1cF8xbTUwLnNocDwvdGQ+XG4gIDwvdHI+XG4gIDx0cj5cbiAgICA8dGQgY29sc3Bhbj1cIjJcIiBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+QsOidGltZW50IEJEVE9QTzwvdGQ+XG4gICAgPHRkIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj4yMDIwPC90ZD5cbiAgICA8dGQgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPk5hdGlvbmFsZTwvdGQ+XG4gICAgPHRkIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5TaGFwZTwvdGQ+XG4gICAgPHRkIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5Qb2x5Z29uZTwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPklHTjwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPkJhdGltZW50LnNocDwvdGQ+XG4gIDwvdHI+XG4gIDx0cj5cbiAgICA8dGQgY29sc3Bhbj1cIjJcIiBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+UG9wdWxhdGlvbiBjYXJyZWF1IDIwMG0gSU5TRUU8L3RkPlxuICAgIDx0ZCBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+MjAxNTwvdGQ+XG4gICAgPHRkIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5OYXRpb25hbGU8L3RkPlxuICAgIDx0ZCBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+U2hhcGU8L3RkPlxuICAgIDx0ZCBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+UG9seWdvbmU8L3RkPlxuICAgIDx0ZCBjb2xzcGFuPVwiMlwiIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5JTlNFRTwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPmZpbG9zb2ZpMjAxNV9jYXJyZWF1eF8yMDBtLnNocDwvdGQ+XG4gIDwvdHI+XG4gIDx0cj5cbiAgICA8dGQgY29sc3Bhbj1cIjJcIiBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+RWZmZWN0aWYgZGVzIGVudHJlcHJpc2VzPC90ZD5cbiAgICA8dGQgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPjIwMjE8L3RkPlxuICAgIDx0ZCBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+TmF0aW9uYWxlPC90ZD5cbiAgICA8dGQgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPlNoYXBlPC90ZD5cbiAgICA8dGQgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPlBvaW50PC90ZD5cbiAgICA8dGQgY29sc3Bhbj1cIjJcIiBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+SU5TRUU8L3RkPlxuICAgIDx0ZCBjb2xzcGFuPVwiMlwiIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5nZW9fc2lyZXQuc2hwPC90ZD5cbiAgPC90cj5cbiAgPHRyPlxuICAgIDx0ZCBjb2xzcGFuPVwiMlwiIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5Db21tdW5lczwvdGQ+XG4gICAgPHRkIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj4yMDIwPC90ZD5cbiAgICA8dGQgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPk5hdGlvbmFsZTwvdGQ+XG4gICAgPHRkIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5TaGFwZTwvdGQ+XG4gICAgPHRkIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5Qb2x5Z29uZTwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPkNlcmVtYTwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPkNvbW11bmUuc2hwPC90ZD5cbiAgPC90cj5cbjwvdGFibGU+XG5cblxuYFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgXG48ZGl2IGlkPVwiZG9ubmVlc1wiIHN0eWxlPVwiZm9udC1mYW1pbHk6IEFyaWFsLCBzYW5zLXNlcmlmOyBmb250LXNpemU6IDE2cHg7IGxpbmUtaGVpZ2h0OiAxLjU7IG1hcmdpbi10b3A6MSU7XCI+XG4gICAgQ2xpcXVleiBzdXIgdW5lIGNvbW11bmUgcG91ciB2b2lyIGxlcyBpbmZvcm1hdGlvbnMgaWNpLjxicj5cbjwvZGl2PlxuXG5gXG5cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImltcG9ydCB7IFBsb3QgfSBmcm9tIFwiQG9ic2VydmFibGVocS9wbG90XCI7XG5pbXBvcnQgeyBJbnB1dHMgfSBmcm9tIFwiQG9ic2VydmFibGVocS9pbnB1dHNcIjtcblxuLy8gQ2hhcmdlciBsZXMgZG9ubsOpZXMgZGVwdWlzIGxlIGZpY2hpZXIgZ8OpbsOpcsOpIHBhciBSXG5kYXRhID0gRmlsZUF0dGFjaG1lbnQoXCJsYXllcnMvZGF0YV9zMTJhLmpzb25cIikuanNvbigpXG5cbmh0bWxgPGxhYmVsIGZvcj1cInNsaWRlci1zMTJhXCIgc3R5bGU9XCJkaXNwbGF5OiBibG9jaztcbiAgbWFyZ2luLXRvcDogMWVtO1xuICBmb250LXdlaWdodDogYm9sZDtcbiAgbWFyZ2luLWJvdHRvbTogMWVtO1xuICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuNik7XG4gIGJveC1zaGFkb3c6IDBweCAwcHggOHB4IDBweCByZ2JhKDAsIDAsIDAsIDAuOCk7XG4gIGJvcmRlci1yYWRpdXM6IDhweDtcbiAgcGFkZGluZzogNXB4O1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gIG1hcmdpbi1yaWdodDogMjAlO1xuICBtYXJnaW4tbGVmdDogMjAlO1wiPlxuICBQb3B1bGF0aW9uIGVuIHpvbmUgaW5vbmRhYmxlXG48L2xhYmVsPmBcblxuLy8gQ3LDqWVyIGxlIHNsaWRlclxudmlld29mIHNsaWRlciA9IElucHV0cy5yYW5nZShcbiAgWzAsIDIzMF0sIFxuICB7IHZhbHVlOiAyMzAsIHN0ZXA6IDEwLCBcbiAgaWQ6IFwic2xpZGVyLXMxMmFcIlxuICB9XG4pXG5cbmh0bWxgPGRpdiBzdHlsZT1cIm1hcmdpbi10b3A6IDMwcHg7XCI+PC9kaXY+YFxuXG4vLyBGb25jdGlvbiBkZSB0cmkgY3JvaXNzYW50XG5zb3J0ZWQgPSBkYXRhXG4gIC5maWx0ZXIoZCA9PiBkLnMxMmEgPD0gc2xpZGVyKVxuICAuc29ydCgoYSwgYikgPT4gYS5zMTJhIC0gYi5zMTJhKTtcbiAgXG5cblBsb3QucGxvdCh7XG4gIG1hcmtzOiBbXG4gICAgUGxvdC5iYXJZKHNvcnRlZCwgeyB4OiBcIm5vbVwiLCB5OiBcInMxMmFcIiwgXG4gICAgZmlsbDogZCA9PiB7XG4gICAgICAgIGNvbnN0IHZhbCA9IGQuczEyYTtcbiAgICAgICAgaWYgKHZhbCA9PT0gMCkgcmV0dXJuIFwiI2Q5ZDlkOVwiOyAgICAgICAgLy8gbnVsbCBvdSAwXG4gICAgICAgIGlmICh2YWwgPCAxMCkgcmV0dXJuIFwiI2Y5ZTllOVwiO1xuICAgICAgICBpZiAodmFsIDwgNTApIHJldHVybiBcIiNmZmFhYWFcIjtcbiAgICAgICAgaWYgKHZhbCA8IDEwMCkgcmV0dXJuIFwiI2ZmNTU1NVwiO1xuICAgICAgICBpZiAodmFsID49IDEwMCkgcmV0dXJuIFwiI2ZmMDAwMFwiO1xuICAgICAgICByZXR1cm4gXCIjYjMwMDAwXCI7XG4gICAgICB9XG4gICAgICB9KSxcbiAgICBQbG90LnRleHQoc29ydGVkLCB7IHg6IFwibm9tXCIsIHk6IFwiczEyYVwiLCB0ZXh0OiBkID0+IGAke2QuczEyYX1gLCBkeTogLTEwIH0pXG4gIF0sXG4gIHk6IHsgZ3JpZDogdHJ1ZSwgbGFiZWw6IFwiUG9wdWxhdGlvbiBlbiB6b25lIGZvcnRlbWVudCBpbm9uZGFibGVcIiB9LFxuICB4OiB7IGxhYmVsOiBcIkNvbW11bmVcIixcbiAgICAgICAgdGlja1JvdGF0ZTogLTQ1LFxuICAgICAgICBsYWJlbEFuY2hvcjogXCJyaWdodFwiLFxuICAgICAgICBsYWJlbE9mZnNldDogMzB9LFxuICB3aWR0aDogd2luZG93LmlubmVyV2lkdGggKiAwLjk1LFxuICAgaGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjg1LFxuICBoZWlnaHQ6IDYwMCxcbiAgc3R5bGU6IHtcbiAgICBmb250U2l6ZTogXCIxMHB4XCIsXG4gICAgZmlsbDogXCJibGFja1wiLFxuICAgIGZvbnRXZWlnaHQ6IFwiYm9sZFwiXG4gIH0sXG4gIG1hcmdpbkJvdHRvbTogMTMwXG59KVxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NsaWRlcicpIn1dfQ==
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copi√©");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copi√©");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Site cr√©√© avec <a href="https://quarto.org/">Quarto</a></p>
</div>   
    <div class="nav-footer-center">
<p>¬©CEREMA</p>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://fr.linkedin.com/company/cerema">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/ceremacom">
      <i class="bi bi-twitter-x" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/@cerema3139">
      <i class="bi bi-youtube" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>